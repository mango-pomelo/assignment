{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { Cell, CellType } from '@syncfusion/ej2-grids';\nimport { VirtualContentRenderer } from '@syncfusion/ej2-grids';\nimport { InterSectionObserver } from '@syncfusion/ej2-grids';\nimport { TreeVirtualRowModelGenerator } from '../renderer/virtual-row-model-generator';\nimport * as events from '../base/constant';\nimport { isNullOrUndefined, EventHandler, getValue, setValue, Browser } from '@syncfusion/ej2-base';\nimport { DataManager } from '@syncfusion/ej2-data';\nimport { isCountRequired } from '../utils';\n\nvar VirtualTreeContentRenderer =\n/** @class */\nfunction (_super) {\n  __extends(VirtualTreeContentRenderer, _super);\n\n  function VirtualTreeContentRenderer(parent, locator) {\n    var _this = _super.call(this, parent, locator) || this;\n\n    _this.isExpandCollapse = false;\n    _this.translateY = 0;\n    _this.maxiPage = 0;\n    _this.recordAdded = false;\n    /** @hidden */\n\n    _this.startIndex = -1;\n    _this.endIndex = -1;\n    _this.preTranslate = 0;\n    _this.isRemoteExpand = false;\n    /** @hidden */\n\n    _this.isDataSourceChanged = false;\n\n    _this.addEventListener();\n\n    return _this;\n  }\n\n  VirtualTreeContentRenderer.prototype.getModelGenerator = function () {\n    return new TreeVirtualRowModelGenerator(this.parent);\n  };\n\n  VirtualTreeContentRenderer.prototype.getRowByIndex = function (index) {\n    return this.parent.getDataRows().filter(function (e) {\n      return parseInt(e.getAttribute('aria-rowindex'), 10) === index;\n    })[0];\n  };\n\n  VirtualTreeContentRenderer.prototype.addEventListener = function () {\n    this.parent.on(events.virtualActionArgs, this.virtualOtherAction, this);\n    this.parent.on(events.indexModifier, this.indexModifier, this);\n  };\n\n  VirtualTreeContentRenderer.prototype.virtualOtherAction = function (args) {\n    if (args.setTop) {\n      this.translateY = 0;\n      this.startIndex = 0;\n      this.endIndex = this.parent.pageSettings.pageSize - 1;\n    } else if (args.isExpandCollapse) {\n      this.isExpandCollapse = true;\n    }\n  };\n\n  VirtualTreeContentRenderer.prototype.indexModifier = function (args) {\n    var content = this.parent.getContent().querySelector('.e-content');\n\n    if (this.recordAdded && this.startIndex > -1 && this.endIndex > -1) {\n      if (this.endIndex > args.count - this.parent.pageSettings.pageSize) {\n        var nextSetResIndex = ~~(content.scrollTop / this.parent.getRowHeight());\n        var lastIndex = nextSetResIndex + this.parent.getRows().length;\n\n        if (lastIndex > args.count) {\n          lastIndex = nextSetResIndex + (args.count - nextSetResIndex);\n        }\n\n        this.startIndex = lastIndex - this.parent.getRows().length;\n        this.endIndex = lastIndex;\n      } else {\n        this.startIndex += 1;\n        this.endIndex += 1;\n      }\n\n      this.recordAdded = false;\n    }\n\n    if (this.isDataSourceChanged) {\n      this.startIndex = 0;\n      this.endIndex = this.parent.pageSettings.pageSize - 1;\n    }\n\n    args.startIndex = this.startIndex;\n    args.endIndex = this.endIndex;\n  };\n\n  VirtualTreeContentRenderer.prototype.eventListener = function (action) {\n    var _this = this;\n\n    if (!(this.parent.dataSource instanceof DataManager && this.parent.dataSource.dataSource.url !== undefined && this.parent.dataSource.dataSource.offline && this.parent.dataSource.dataSource.url !== '') || !isCountRequired(this.parent)) {\n      this.parent[action]('data-ready', this.onDataReady, this); //this.parent[action]('refresh-virtual-block', this.refreshContentRows, this);\n\n      this.fn = function () {\n        _this.observers.observes(function (scrollArgs) {\n          return _this.scrollListeners(scrollArgs);\n        });\n\n        _this.parent.off('content-ready', _this.fn);\n      };\n\n      this.parent.addEventListener('dataBound', this.dataBoundEvent.bind(this));\n      this.parent.addEventListener('rowSelected', this.rowSelectedEvent.bind(this));\n      this.parent[action]('select-virtual-Row', this.toSelectVirtualRow, this);\n      this.parent.on('content-ready', this.fn, this);\n      this.parent.addEventListener(events.actionComplete, this.onActionComplete.bind(this));\n      this.parent[action]('virtual-scroll-edit-action-begin', this.beginEdit, this);\n      this.parent[action]('virtual-scroll-add-action-begin', this.beginAdd, this);\n      this.parent[action]('virtual-scroll-edit-success', this.virtualEditSuccess, this);\n      this.parent[action]('edit-reset', this.resetIseditValue, this);\n      this.parent[action]('get-virtual-data', this.getData, this);\n      this.parent[action]('virtual-scroll-edit-cancel', this.cancelEdit, this);\n      this.parent[action]('select-row-on-context-open', this.toSelectRowOnContextOpen, this);\n      this.parent[action]('refresh-virtual-editform-cells', this.refreshCell, this);\n    } else {\n      _super.prototype.eventListener.call(this, 'on');\n    }\n  };\n\n  VirtualTreeContentRenderer.prototype.onDataReady = function (e) {\n    _super.prototype.onDataReady.call(this, e);\n\n    if (!(this.parent.dataSource instanceof DataManager && this.parent.dataSource.dataSource.url !== undefined && this.parent.dataSource.dataSource.offline && this.parent.dataSource.dataSource.url !== '') || !isCountRequired(this.parent)) {\n      if (!isNullOrUndefined(e.count)) {\n        this.totalRecords = e.count;\n        getValue('virtualEle', this).setVirtualHeight(this.parent.getRowHeight() * e.count, '100%');\n      }\n\n      if (!isNullOrUndefined(e.requestType) && e.requestType.toString() === 'collapseAll' || this.isDataSourceChanged) {\n        this.contents.scrollTop = 0;\n        this.isDataSourceChanged = false;\n      }\n    }\n  };\n\n  VirtualTreeContentRenderer.prototype.renderTable = function () {\n    _super.prototype.renderTable.call(this);\n\n    if (!(this.parent.dataSource instanceof DataManager && this.parent.dataSource.dataSource.url !== undefined && this.parent.dataSource.dataSource.offline && this.parent.dataSource.dataSource.url !== '') || !isCountRequired(this.parent)) {\n      getValue('observer', this).options.debounceEvent = false;\n      this.observers = new TreeInterSectionObserver(getValue('observer', this).element, getValue('observer', this).options);\n      this.contents = this.getPanel().firstChild;\n    }\n  };\n\n  VirtualTreeContentRenderer.prototype.getTranslateY = function (sTop, cHeight, info, isOnenter) {\n    if (this.parent.dataSource instanceof DataManager && this.parent.dataSource.dataSource.url !== undefined && !this.parent.dataSource.dataSource.offline && this.parent.dataSource.dataSource.url !== '' || isCountRequired(this.parent)) {\n      if (this.isRemoteExpand) {\n        this.isRemoteExpand = false;\n        return this.preTranslate;\n      } else {\n        this.preTranslate = _super.prototype.getTranslateY.call(this, sTop, cHeight, info, isOnenter);\n        return _super.prototype.getTranslateY.call(this, sTop, cHeight, info, isOnenter);\n      }\n    } else {\n      return _super.prototype.getTranslateY.call(this, sTop, cHeight, info, isOnenter);\n    }\n  };\n\n  VirtualTreeContentRenderer.prototype.dataBoundEvent = function () {\n    var dataBoundEve = 'dataBound';\n    var initialRowTop = 'initialRowTop';\n\n    if (this.parent.getRows().length && !this[initialRowTop]) {\n      var gridTop = this.parent.element.getBoundingClientRect().top;\n      this[initialRowTop] = this.parent.getRowByIndex(0).getBoundingClientRect().top - gridTop;\n    }\n\n    _super.prototype[dataBoundEve].call(this);\n  };\n\n  VirtualTreeContentRenderer.prototype.rowSelectedEvent = function (args) {\n    var rowSelected = 'rowSelected';\n\n    _super.prototype[rowSelected].call(this, args);\n  };\n\n  VirtualTreeContentRenderer.prototype.toSelectVirtualRow = function (args) {\n    if (this.parent.isEdit) {\n      return;\n    }\n\n    var selectVirtualRow = 'selectVirtualRow';\n\n    _super.prototype[selectVirtualRow].call(this, args);\n  };\n\n  VirtualTreeContentRenderer.prototype.refreshCell = function (rowObj) {\n    rowObj.cells = this.generateCells();\n  };\n\n  VirtualTreeContentRenderer.prototype.generateCells = function () {\n    var cells = [];\n\n    for (var i = 0; i < this.parent.columns.length; i++) {\n      cells.push(this.generateCell(this.parent.columns[i]));\n    }\n\n    return cells;\n  };\n\n  VirtualTreeContentRenderer.prototype.generateCell = function (column, rowId, cellType, colSpan, oIndex, foreignKeyData) {\n    var opt = {\n      'visible': column.visible,\n      'isDataCell': !isNullOrUndefined(column.field || column.template),\n      'isTemplate': !isNullOrUndefined(column.template),\n      'rowID': rowId,\n      'column': column,\n      'cellType': !isNullOrUndefined(cellType) ? cellType : CellType.Data,\n      'colSpan': colSpan,\n      'commands': column.commands,\n      'isForeignKey': column.isForeignColumn && column.isForeignColumn(),\n      'foreignKeyData': column.isForeignColumn && column.isForeignColumn() && getValue(column.field, foreignKeyData)\n    };\n\n    if (opt.isDataCell || opt.column.type === 'checkbox' || opt.commands) {\n      opt.index = oIndex;\n    }\n\n    return new Cell(opt);\n  };\n\n  VirtualTreeContentRenderer.prototype.beginEdit = function (e) {\n    var selector = '.e-row[aria-rowindex=\"' + e.index + '\"]';\n    var index = this.parent.getContent().querySelector(selector).rowIndex;\n    var rowData = this.parent.getCurrentViewRecords()[index];\n    e.data = rowData;\n  };\n\n  VirtualTreeContentRenderer.prototype.beginAdd = function (args) {\n    var addAction = 'addActionBegin';\n    var isAdd = 'isAdd';\n    var addArgs = {\n      newRowPosition: this.rowPosition,\n      addRowIndex: this.addRowIndex,\n      ariaRowIndex: this.ariaRowIndex\n    };\n    this.parent.notify('get-row-position', addArgs);\n    this.rowPosition = addArgs.newRowPosition;\n    this.addRowIndex = addArgs.addRowIndex;\n    this.ariaRowIndex = addArgs.ariaRowIndex;\n    var rows = this.parent.getRows();\n    var firstAriaIndex = rows.length ? +rows[0].getAttribute('aria-rowindex') : 0;\n    var lastAriaIndex = rows.length ? +rows[rows.length - 1].getAttribute('aria-rowindex') : 0;\n    var withInRange = this.parent.selectedRowIndex >= firstAriaIndex && this.parent.selectedRowIndex <= lastAriaIndex;\n\n    if (!(this.rowPosition === 'Top' || this.rowPosition === 'Bottom')) {\n      this[isAdd] = true;\n    }\n\n    if (this.rowPosition === 'Top' || this.rowPosition === 'Bottom' || (!this.addRowIndex || this.addRowIndex === -1) && (this.parent.selectedRowIndex === -1 || !withInRange)) {\n      _super.prototype[addAction].call(this, args);\n    }\n  };\n\n  VirtualTreeContentRenderer.prototype.restoreEditState = function () {\n    var restoreEdit = 'restoreEdit';\n\n    _super.prototype[restoreEdit].call(this);\n  };\n\n  VirtualTreeContentRenderer.prototype.resetIseditValue = function () {\n    var resetIsEdit = 'resetIsedit';\n    var isAdd = 'isAdd';\n    this.parent.notify('reset-edit-props', {});\n\n    if ((this.rowPosition === 'Top' || this.rowPosition === 'Bottom') && this[isAdd]) {\n      _super.prototype[resetIsEdit].call(this);\n    }\n  };\n\n  VirtualTreeContentRenderer.prototype.virtualEditSuccess = function () {\n    var isAdd = 'isAdd';\n    var content = this.parent.getContent().querySelector('.e-content');\n\n    if (this[isAdd] && content.querySelector('.e-addedrow')) {\n      this.recordAdded = true;\n    }\n  };\n\n  VirtualTreeContentRenderer.prototype.cancelEdit = function (args) {\n    var editCancel = 'editCancel';\n\n    _super.prototype[editCancel].call(this, args);\n  };\n\n  VirtualTreeContentRenderer.prototype.toSelectRowOnContextOpen = function (args) {\n    var selectRowOnContextOpen = 'selectRowOnContextOpen';\n\n    _super.prototype[selectRowOnContextOpen].call(this, args);\n  };\n\n  VirtualTreeContentRenderer.prototype.restoreNewRow = function () {\n    var isAdd = 'isAdd';\n    var content = this.parent.getContent().querySelector('.e-content');\n\n    if (this[isAdd] && !content.querySelector('.e-addedrow')) {\n      this.parent.isEdit = false;\n      this.parent.addRecord();\n    }\n  };\n\n  VirtualTreeContentRenderer.prototype.getData = function (data) {\n    var getVirtualData = 'getVirtualData';\n\n    _super.prototype[getVirtualData].call(this, data);\n  };\n\n  VirtualTreeContentRenderer.prototype.onActionComplete = function (args) {\n    if (args.requestType === 'add') {\n      var addArgs = {\n        newRowPosition: this.rowPosition,\n        addRowIndex: this.addRowIndex,\n        ariaRowIndex: this.ariaRowIndex\n      };\n      this.parent.notify('get-row-position', addArgs);\n      this.rowPosition = addArgs.newRowPosition;\n      this.addRowIndex = addArgs.addRowIndex;\n      this.ariaRowIndex = addArgs.ariaRowIndex;\n    }\n\n    var actionComplete = 'actionComplete';\n\n    _super.prototype[actionComplete].call(this, args);\n  };\n\n  VirtualTreeContentRenderer.prototype.scrollListeners = function (scrollArgs) {\n    var info = scrollArgs.sentinel;\n    var outBuffer = 10; //this.parent.pageSettings.pageSize - Math.ceil(this.parent.pageSettings.pageSize / 1.5);\n\n    var content = this.parent.getContent().querySelector('.e-content');\n    var scrollHeight = outBuffer * this.parent.getRowHeight();\n    var upScroll = scrollArgs.offset.top - this.translateY < 0;\n    var downScroll = scrollArgs.offset.top - this.translateY > scrollHeight;\n    var selectedRowIndex = 'selectedRowIndex';\n\n    if (upScroll) {\n      var vHeight = +(this.parent.height.toString().indexOf('%') < 0 ? this.parent.height : this.parent.element.getBoundingClientRect().height);\n      var index = ~~(content.scrollTop / this.parent.getRowHeight()) + Math.ceil(vHeight / this.parent.getRowHeight()) - this.parent.getRows().length;\n      index = index > 0 ? index : 0;\n\n      if (!isNullOrUndefined(this[selectedRowIndex]) && this[selectedRowIndex] != -1 && index != this[selectedRowIndex]) {\n        index = this[selectedRowIndex];\n      }\n\n      this.startIndex = index;\n      this.endIndex = index + this.parent.getRows().length;\n\n      if (this.endIndex > this.totalRecords) {\n        var lastInx = this.totalRecords - 1;\n        var remains = this.endIndex % lastInx;\n        this.endIndex = lastInx;\n        this.startIndex = this.startIndex - remains;\n      } //var firsttdinx = parseInt(this.parent.getContent().querySelector('.e-content td').getAttribute('index'), 0);\n\n\n      var rowPt = Math.ceil(scrollArgs.offset.top / this.parent.getRowHeight());\n      rowPt = rowPt % this.parent.pageSettings.pageSize;\n      var firsttdinx = 0;\n\n      if (!isNullOrUndefined(this.parent.getRows()[rowPt])) {\n        var attr = this.parent.getContent().querySelectorAll('.e-content tr')[rowPt].querySelector('td').getAttribute('index');\n        firsttdinx = +attr; // this.parent.getContent().querySelector('.e-content tr').getAttribute('aria-rowindex');\n      }\n\n      if (firsttdinx === 0) {\n        this.translateY = scrollArgs.offset.top;\n      } else {\n        var height = this.parent.getRowHeight();\n        this.translateY = scrollArgs.offset.top - outBuffer * height > 0 ? scrollArgs.offset.top - outBuffer * height + 10 : 0;\n      }\n    } else if (downScroll) {\n      var nextSetResIndex = ~~(content.scrollTop / this.parent.getRowHeight());\n      var isLastBlock = this[selectedRowIndex] + this.parent.pageSettings.pageSize < this.totalRecords ? false : true;\n\n      if (!isNullOrUndefined(this[selectedRowIndex]) && this[selectedRowIndex] != -1 && nextSetResIndex != this[selectedRowIndex] && !isLastBlock) {\n        nextSetResIndex = this[selectedRowIndex];\n      }\n\n      var lastIndex = nextSetResIndex + this.parent.getRows().length;\n\n      if (lastIndex > this.totalRecords) {\n        lastIndex = nextSetResIndex + (this.totalRecords - nextSetResIndex);\n      }\n\n      this.startIndex = !isLastBlock ? lastIndex - this.parent.getRows().length : nextSetResIndex;\n      this.endIndex = lastIndex;\n\n      if (scrollArgs.offset.top > this.parent.getRowHeight() * this.totalRecords) {\n        this.translateY = this.getTranslateY(scrollArgs.offset.top, content.getBoundingClientRect().height);\n      } else {\n        this.translateY = scrollArgs.offset.top;\n      }\n    }\n\n    if (downScroll && scrollArgs.offset.top < this.parent.getRowHeight() * this.totalRecords || upScroll) {\n      var viewInfo = getValue('getInfoFromView', this).apply(this, [scrollArgs.direction, info, scrollArgs.offset]);\n      this.previousInfo = viewInfo;\n      var page = viewInfo.loadNext && !viewInfo.loadSelf ? viewInfo.nextInfo.page : viewInfo.page;\n      this.parent.setProperties({\n        pageSettings: {\n          currentPage: page\n        }\n      }, true);\n      viewInfo.event = viewInfo.event === 'refresh-virtual-block' ? 'model-changed' : viewInfo.event;\n      this.parent.notify(viewInfo.event, {\n        requestType: 'virtualscroll',\n        focusElement: scrollArgs.focusElement\n      });\n    }\n  };\n\n  VirtualTreeContentRenderer.prototype.appendContent = function (target, newChild, e) {\n    if (this.parent.dataSource instanceof DataManager && this.parent.dataSource.dataSource.url !== undefined && !this.parent.dataSource.dataSource.offline && this.parent.dataSource.dataSource.url !== '' || isCountRequired(this.parent)) {\n      if (getValue('isExpandCollapse', e)) {\n        this.isRemoteExpand = true;\n      }\n\n      _super.prototype.appendContent.call(this, target, newChild, e);\n    } else {\n      var info = e.virtualInfo.sentinelInfo && e.virtualInfo.sentinelInfo.axis === 'Y' && getValue('currentInfo', this).page && getValue('currentInfo', this).page !== e.virtualInfo.page ? getValue('currentInfo', this) : e.virtualInfo;\n      var cBlock = info.columnIndexes[0] - 1;\n      var cOffset = this.getColumnOffset(cBlock);\n      this.virtualEle.setWrapperWidth(null, Browser.isIE || Browser.info.name === 'edge');\n      target = this.parent.createElement('tbody');\n      target.appendChild(newChild);\n      var replace = 'replaceWith';\n      this.getTable().querySelector('tbody')[replace](target);\n\n      if (!this.isExpandCollapse || this.translateY === 0) {\n        getValue('virtualEle', this).adjustTable(cOffset, this.translateY);\n      } else {\n        this.isExpandCollapse = false;\n      }\n\n      setValue('prevInfo', this.previousInfo ? this.previousInfo : info, this);\n      var focusCell = 'focusCell';\n      var restoreAdd = 'restoreAdd';\n\n      _super.prototype[focusCell].call(this, e);\n\n      var isAdd = 'isAdd';\n\n      if (this[isAdd] && !this.parent.getContent().querySelector('.e-content').querySelector('.e-addedrow')) {\n        if (!(this.rowPosition === 'Top' || this.rowPosition === 'Bottom')) {\n          if (this.ariaRowIndex >= this.startIndex) {\n            this.restoreNewRow();\n          } else if (this.addRowIndex && this.addRowIndex > -1) {\n            this[isAdd] = false;\n            this.parent.isEdit = false;\n          }\n        }\n      }\n\n      this.restoreEditState();\n\n      _super.prototype[restoreAdd].call(this);\n    }\n  };\n\n  VirtualTreeContentRenderer.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off('data-ready', this.onDataReady);\n    this.parent.off('content-ready', this.fn);\n    this.parent.off('select-virtual-Row', this.toSelectVirtualRow);\n    this.parent.off('dataBound', this.dataBoundEvent);\n    this.parent.off('rowSelected', this.rowSelectedEvent);\n    this.parent.off(events.virtualActionArgs, this.virtualOtherAction);\n    this.parent.off(events.indexModifier, this.indexModifier);\n    this.parent.off('virtual-scroll-edit-action-begin', this.beginEdit);\n    this.parent.off('virtual-scroll-add-action-begin', this.beginAdd);\n    this.parent.off('virtual-scroll-edit-success', this.virtualEditSuccess);\n    this.parent.off('edit-reset', this.resetIseditValue);\n    this.parent.off('get-virtual-data', this.getData);\n    this.parent.off('virtual-scroll-edit-cancel', this.cancelEdit);\n    this.parent.off('select-row-on-context-open', this.toSelectRowOnContextOpen);\n    this.parent.off('refresh-virtual-editform-cells', this.refreshCell);\n  };\n\n  return VirtualTreeContentRenderer;\n}(VirtualContentRenderer);\n\nexport { VirtualTreeContentRenderer };\n\nvar TreeInterSectionObserver =\n/** @class */\nfunction (_super) {\n  __extends(TreeInterSectionObserver, _super);\n\n  function TreeInterSectionObserver() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.isWheeling = false;\n    _this.newPos = 0;\n    _this.lastPos = 0;\n    _this.timer = 0;\n    return _this;\n  }\n\n  TreeInterSectionObserver.prototype.observes = function (callback) {\n    var containerRect = 'containerRect';\n    _super.prototype[containerRect] = getValue('options', this).container.getBoundingClientRect();\n    EventHandler.add(getValue('options', this).container, 'scroll', this.virtualScrollHandlers(callback), this);\n  };\n\n  TreeInterSectionObserver.prototype.clear = function () {\n    this.lastPos = null;\n  };\n\n  TreeInterSectionObserver.prototype.virtualScrollHandlers = function (callback) {\n    var _this = this;\n\n    var prevTop = 0;\n    var prevLeft = 0;\n    return function (e) {\n      var scrollTop = e.target.scrollTop;\n      var scrollLeft = e.target.scrollLeft;\n      var direction = prevTop < scrollTop ? 'down' : 'up';\n      direction = prevLeft === scrollLeft ? direction : prevLeft < scrollLeft ? 'right' : 'left';\n      prevTop = scrollTop;\n      prevLeft = scrollLeft;\n      var current = getValue('sentinelInfo', _this)[direction];\n      var delta = 0;\n      _this.newPos = scrollTop;\n\n      if (_this.lastPos != null) {\n        // && newPos < maxScroll\n        delta = _this.newPos - _this.lastPos;\n      }\n\n      _this.lastPos = _this.newPos;\n\n      if (_this.timer) {\n        clearTimeout(_this.timer);\n      }\n\n      _this.timer = setTimeout(_this.clear, 0);\n      /*if (this.options.axes.indexOf(current.axis) === -1) {\n      return;\n      }*/\n\n      /*if(delta > 45 || delta < -45){\n      this.isWheeling = true;\n      }*/\n\n      if ((delta > 100 || delta < -100) && e && e.preventDefault) {\n        e.returnValue = false;\n        e.preventDefault();\n      }\n\n      callback({\n        direction: direction,\n        isWheel: _this.isWheeling,\n        sentinel: current,\n        offset: {\n          top: scrollTop,\n          left: scrollLeft\n        },\n        focusElement: document.activeElement\n      });\n    };\n  };\n\n  return TreeInterSectionObserver;\n}(InterSectionObserver);\n\nexport { TreeInterSectionObserver };","map":{"version":3,"sources":["/Users/zhouzhou/Desktop/lightfront/node_modules/@syncfusion/ej2-treegrid/src/treegrid/renderer/virtual-tree-content-render.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","Cell","CellType","VirtualContentRenderer","InterSectionObserver","TreeVirtualRowModelGenerator","events","isNullOrUndefined","EventHandler","getValue","setValue","Browser","DataManager","isCountRequired","VirtualTreeContentRenderer","_super","parent","locator","_this","call","isExpandCollapse","translateY","maxiPage","recordAdded","startIndex","endIndex","preTranslate","isRemoteExpand","isDataSourceChanged","addEventListener","getModelGenerator","getRowByIndex","index","getDataRows","filter","e","parseInt","getAttribute","on","virtualActionArgs","virtualOtherAction","indexModifier","args","setTop","pageSettings","pageSize","content","getContent","querySelector","count","nextSetResIndex","scrollTop","getRowHeight","lastIndex","getRows","length","eventListener","action","dataSource","url","undefined","offline","onDataReady","fn","observers","observes","scrollArgs","scrollListeners","off","dataBoundEvent","bind","rowSelectedEvent","toSelectVirtualRow","actionComplete","onActionComplete","beginEdit","beginAdd","virtualEditSuccess","resetIseditValue","getData","cancelEdit","toSelectRowOnContextOpen","refreshCell","totalRecords","setVirtualHeight","requestType","toString","contents","renderTable","options","debounceEvent","TreeInterSectionObserver","element","getPanel","firstChild","getTranslateY","sTop","cHeight","info","isOnenter","dataBoundEve","initialRowTop","gridTop","getBoundingClientRect","top","rowSelected","isEdit","selectVirtualRow","rowObj","cells","generateCells","i","columns","push","generateCell","column","rowId","cellType","colSpan","oIndex","foreignKeyData","opt","visible","field","template","Data","commands","isForeignColumn","isDataCell","type","selector","rowIndex","rowData","getCurrentViewRecords","data","addAction","isAdd","addArgs","newRowPosition","rowPosition","addRowIndex","ariaRowIndex","notify","rows","firstAriaIndex","lastAriaIndex","withInRange","selectedRowIndex","restoreEditState","restoreEdit","resetIsEdit","editCancel","selectRowOnContextOpen","restoreNewRow","addRecord","getVirtualData","sentinel","outBuffer","scrollHeight","upScroll","offset","downScroll","vHeight","height","indexOf","Math","ceil","lastInx","remains","rowPt","firsttdinx","attr","querySelectorAll","isLastBlock","viewInfo","apply","direction","previousInfo","page","loadNext","loadSelf","nextInfo","setProperties","currentPage","event","focusElement","appendContent","target","newChild","virtualInfo","sentinelInfo","axis","cBlock","columnIndexes","cOffset","getColumnOffset","virtualEle","setWrapperWidth","isIE","name","createElement","appendChild","replace","getTable","adjustTable","focusCell","restoreAdd","removeEventListener","isDestroyed","arguments","isWheeling","newPos","lastPos","timer","callback","containerRect","container","add","virtualScrollHandlers","clear","prevTop","prevLeft","scrollLeft","current","delta","clearTimeout","setTimeout","preventDefault","returnValue","isWheel","left","document","activeElement"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Cell, CellType } from '@syncfusion/ej2-grids';\nimport { VirtualContentRenderer } from '@syncfusion/ej2-grids';\nimport { InterSectionObserver } from '@syncfusion/ej2-grids';\nimport { TreeVirtualRowModelGenerator } from '../renderer/virtual-row-model-generator';\nimport * as events from '../base/constant';\nimport { isNullOrUndefined, EventHandler, getValue, setValue, Browser } from '@syncfusion/ej2-base';\nimport { DataManager } from '@syncfusion/ej2-data';\nimport { isCountRequired } from '../utils';\nvar VirtualTreeContentRenderer = /** @class */ (function (_super) {\n    __extends(VirtualTreeContentRenderer, _super);\n    function VirtualTreeContentRenderer(parent, locator) {\n        var _this = _super.call(this, parent, locator) || this;\n        _this.isExpandCollapse = false;\n        _this.translateY = 0;\n        _this.maxiPage = 0;\n        _this.recordAdded = false;\n        /** @hidden */\n        _this.startIndex = -1;\n        _this.endIndex = -1;\n        _this.preTranslate = 0;\n        _this.isRemoteExpand = false;\n        /** @hidden */\n        _this.isDataSourceChanged = false;\n        _this.addEventListener();\n        return _this;\n    }\n    VirtualTreeContentRenderer.prototype.getModelGenerator = function () {\n        return new TreeVirtualRowModelGenerator(this.parent);\n    };\n    VirtualTreeContentRenderer.prototype.getRowByIndex = function (index) {\n        return this.parent.getDataRows().filter(function (e) { return parseInt(e.getAttribute('aria-rowindex'), 10) === index; })[0];\n    };\n    VirtualTreeContentRenderer.prototype.addEventListener = function () {\n        this.parent.on(events.virtualActionArgs, this.virtualOtherAction, this);\n        this.parent.on(events.indexModifier, this.indexModifier, this);\n    };\n    VirtualTreeContentRenderer.prototype.virtualOtherAction = function (args) {\n        if (args.setTop) {\n            this.translateY = 0;\n            this.startIndex = 0;\n            this.endIndex = this.parent.pageSettings.pageSize - 1;\n        }\n        else if (args.isExpandCollapse) {\n            this.isExpandCollapse = true;\n        }\n    };\n    VirtualTreeContentRenderer.prototype.indexModifier = function (args) {\n        var content = this.parent.getContent().querySelector('.e-content');\n        if (this.recordAdded && this.startIndex > -1 && this.endIndex > -1) {\n            if (this.endIndex > args.count - this.parent.pageSettings.pageSize) {\n                var nextSetResIndex = ~~(content.scrollTop / this.parent.getRowHeight());\n                var lastIndex = nextSetResIndex + this.parent.getRows().length;\n                if (lastIndex > args.count) {\n                    lastIndex = nextSetResIndex +\n                        (args.count - nextSetResIndex);\n                }\n                this.startIndex = lastIndex - this.parent.getRows().length;\n                this.endIndex = lastIndex;\n            }\n            else {\n                this.startIndex += 1;\n                this.endIndex += 1;\n            }\n            this.recordAdded = false;\n        }\n        if (this.isDataSourceChanged) {\n            this.startIndex = 0;\n            this.endIndex = this.parent.pageSettings.pageSize - 1;\n        }\n        args.startIndex = this.startIndex;\n        args.endIndex = this.endIndex;\n    };\n    VirtualTreeContentRenderer.prototype.eventListener = function (action) {\n        var _this = this;\n        if (!(this.parent.dataSource instanceof DataManager && this.parent.dataSource.dataSource.url !== undefined\n            && this.parent.dataSource.dataSource.offline && this.parent.dataSource.dataSource.url !== '') || !isCountRequired(this.parent)) {\n            this.parent[action]('data-ready', this.onDataReady, this);\n            //this.parent[action]('refresh-virtual-block', this.refreshContentRows, this);\n            this.fn = function () {\n                _this.observers.observes(function (scrollArgs) { return _this.scrollListeners(scrollArgs); });\n                _this.parent.off('content-ready', _this.fn);\n            };\n            this.parent.addEventListener('dataBound', this.dataBoundEvent.bind(this));\n            this.parent.addEventListener('rowSelected', this.rowSelectedEvent.bind(this));\n            this.parent[action]('select-virtual-Row', this.toSelectVirtualRow, this);\n            this.parent.on('content-ready', this.fn, this);\n            this.parent.addEventListener(events.actionComplete, this.onActionComplete.bind(this));\n            this.parent[action]('virtual-scroll-edit-action-begin', this.beginEdit, this);\n            this.parent[action]('virtual-scroll-add-action-begin', this.beginAdd, this);\n            this.parent[action]('virtual-scroll-edit-success', this.virtualEditSuccess, this);\n            this.parent[action]('edit-reset', this.resetIseditValue, this);\n            this.parent[action]('get-virtual-data', this.getData, this);\n            this.parent[action]('virtual-scroll-edit-cancel', this.cancelEdit, this);\n            this.parent[action]('select-row-on-context-open', this.toSelectRowOnContextOpen, this);\n            this.parent[action]('refresh-virtual-editform-cells', this.refreshCell, this);\n        }\n        else {\n            _super.prototype.eventListener.call(this, 'on');\n        }\n    };\n    VirtualTreeContentRenderer.prototype.onDataReady = function (e) {\n        _super.prototype.onDataReady.call(this, e);\n        if (!(this.parent.dataSource instanceof DataManager && this.parent.dataSource.dataSource.url !== undefined\n            && this.parent.dataSource.dataSource.offline && this.parent.dataSource.dataSource.url !== '') || !isCountRequired(this.parent)) {\n            if (!isNullOrUndefined(e.count)) {\n                this.totalRecords = e.count;\n                getValue('virtualEle', this).setVirtualHeight(this.parent.getRowHeight() * e.count, '100%');\n            }\n            if ((!isNullOrUndefined(e.requestType) && e.requestType.toString() === 'collapseAll') || this.isDataSourceChanged) {\n                this.contents.scrollTop = 0;\n                this.isDataSourceChanged = false;\n            }\n        }\n    };\n    VirtualTreeContentRenderer.prototype.renderTable = function () {\n        _super.prototype.renderTable.call(this);\n        if (!(this.parent.dataSource instanceof DataManager && this.parent.dataSource.dataSource.url !== undefined\n            && this.parent.dataSource.dataSource.offline && this.parent.dataSource.dataSource.url !== '') || !isCountRequired(this.parent)) {\n            getValue('observer', this).options.debounceEvent = false;\n            this.observers = new TreeInterSectionObserver(getValue('observer', this).element, getValue('observer', this).options);\n            this.contents = this.getPanel().firstChild;\n        }\n    };\n    VirtualTreeContentRenderer.prototype.getTranslateY = function (sTop, cHeight, info, isOnenter) {\n        if ((this.parent.dataSource instanceof DataManager && this.parent.dataSource.dataSource.url !== undefined\n            && !this.parent.dataSource.dataSource.offline && this.parent.dataSource.dataSource.url !== '') || isCountRequired(this.parent)) {\n            if (this.isRemoteExpand) {\n                this.isRemoteExpand = false;\n                return this.preTranslate;\n            }\n            else {\n                this.preTranslate = _super.prototype.getTranslateY.call(this, sTop, cHeight, info, isOnenter);\n                return _super.prototype.getTranslateY.call(this, sTop, cHeight, info, isOnenter);\n            }\n        }\n        else {\n            return _super.prototype.getTranslateY.call(this, sTop, cHeight, info, isOnenter);\n        }\n    };\n    VirtualTreeContentRenderer.prototype.dataBoundEvent = function () {\n        var dataBoundEve = 'dataBound';\n        var initialRowTop = 'initialRowTop';\n        if (this.parent.getRows().length && !this[initialRowTop]) {\n            var gridTop = this.parent.element.getBoundingClientRect().top;\n            this[initialRowTop] = this.parent.getRowByIndex(0).getBoundingClientRect().top - gridTop;\n        }\n        _super.prototype[dataBoundEve].call(this);\n    };\n    VirtualTreeContentRenderer.prototype.rowSelectedEvent = function (args) {\n        var rowSelected = 'rowSelected';\n        _super.prototype[rowSelected].call(this, args);\n    };\n    VirtualTreeContentRenderer.prototype.toSelectVirtualRow = function (args) {\n        if (this.parent.isEdit) {\n            return;\n        }\n        var selectVirtualRow = 'selectVirtualRow';\n        _super.prototype[selectVirtualRow].call(this, args);\n    };\n    VirtualTreeContentRenderer.prototype.refreshCell = function (rowObj) {\n        rowObj.cells = this.generateCells();\n    };\n    VirtualTreeContentRenderer.prototype.generateCells = function () {\n        var cells = [];\n        for (var i = 0; i < this.parent.columns.length; i++) {\n            cells.push(this.generateCell(this.parent.columns[i]));\n        }\n        return cells;\n    };\n    VirtualTreeContentRenderer.prototype.generateCell = function (column, rowId, cellType, colSpan, oIndex, foreignKeyData) {\n        var opt = {\n            'visible': column.visible,\n            'isDataCell': !isNullOrUndefined(column.field || column.template),\n            'isTemplate': !isNullOrUndefined(column.template),\n            'rowID': rowId,\n            'column': column,\n            'cellType': !isNullOrUndefined(cellType) ? cellType : CellType.Data,\n            'colSpan': colSpan,\n            'commands': column.commands,\n            'isForeignKey': column.isForeignColumn && column.isForeignColumn(),\n            'foreignKeyData': column.isForeignColumn && column.isForeignColumn() && getValue(column.field, foreignKeyData)\n        };\n        if (opt.isDataCell || opt.column.type === 'checkbox' || opt.commands) {\n            opt.index = oIndex;\n        }\n        return new Cell(opt);\n    };\n    VirtualTreeContentRenderer.prototype.beginEdit = function (e) {\n        var selector = '.e-row[aria-rowindex=\"' + e.index + '\"]';\n        var index = this.parent.getContent().querySelector(selector).rowIndex;\n        var rowData = this.parent.getCurrentViewRecords()[index];\n        e.data = rowData;\n    };\n    VirtualTreeContentRenderer.prototype.beginAdd = function (args) {\n        var addAction = 'addActionBegin';\n        var isAdd = 'isAdd';\n        var addArgs = { newRowPosition: this.rowPosition, addRowIndex: this.addRowIndex, ariaRowIndex: this.ariaRowIndex };\n        this.parent.notify('get-row-position', addArgs);\n        this.rowPosition = addArgs.newRowPosition;\n        this.addRowIndex = addArgs.addRowIndex;\n        this.ariaRowIndex = addArgs.ariaRowIndex;\n        var rows = this.parent.getRows();\n        var firstAriaIndex = rows.length ? +rows[0].getAttribute('aria-rowindex') : 0;\n        var lastAriaIndex = rows.length ? +rows[rows.length - 1].getAttribute('aria-rowindex') : 0;\n        var withInRange = this.parent.selectedRowIndex >= firstAriaIndex && this.parent.selectedRowIndex <= lastAriaIndex;\n        if (!(this.rowPosition === 'Top' || this.rowPosition === 'Bottom')) {\n            this[isAdd] = true;\n        }\n        if (this.rowPosition === 'Top' || this.rowPosition === 'Bottom' ||\n            ((!this.addRowIndex || this.addRowIndex === -1) && (this.parent.selectedRowIndex === -1 || !withInRange))) {\n            _super.prototype[addAction].call(this, args);\n        }\n    };\n    VirtualTreeContentRenderer.prototype.restoreEditState = function () {\n        var restoreEdit = 'restoreEdit';\n        _super.prototype[restoreEdit].call(this);\n    };\n    VirtualTreeContentRenderer.prototype.resetIseditValue = function () {\n        var resetIsEdit = 'resetIsedit';\n        var isAdd = 'isAdd';\n        this.parent.notify('reset-edit-props', {});\n        if ((this.rowPosition === 'Top' || this.rowPosition === 'Bottom') && this[isAdd]) {\n            _super.prototype[resetIsEdit].call(this);\n        }\n    };\n    VirtualTreeContentRenderer.prototype.virtualEditSuccess = function () {\n        var isAdd = 'isAdd';\n        var content = this.parent.getContent().querySelector('.e-content');\n        if (this[isAdd] && content.querySelector('.e-addedrow')) {\n            this.recordAdded = true;\n        }\n    };\n    VirtualTreeContentRenderer.prototype.cancelEdit = function (args) {\n        var editCancel = 'editCancel';\n        _super.prototype[editCancel].call(this, args);\n    };\n    VirtualTreeContentRenderer.prototype.toSelectRowOnContextOpen = function (args) {\n        var selectRowOnContextOpen = 'selectRowOnContextOpen';\n        _super.prototype[selectRowOnContextOpen].call(this, args);\n    };\n    VirtualTreeContentRenderer.prototype.restoreNewRow = function () {\n        var isAdd = 'isAdd';\n        var content = this.parent.getContent().querySelector('.e-content');\n        if (this[isAdd] && !content.querySelector('.e-addedrow')) {\n            this.parent.isEdit = false;\n            this.parent.addRecord();\n        }\n    };\n    VirtualTreeContentRenderer.prototype.getData = function (data) {\n        var getVirtualData = 'getVirtualData';\n        _super.prototype[getVirtualData].call(this, data);\n    };\n    VirtualTreeContentRenderer.prototype.onActionComplete = function (args) {\n        if (args.requestType === 'add') {\n            var addArgs = { newRowPosition: this.rowPosition, addRowIndex: this.addRowIndex, ariaRowIndex: this.ariaRowIndex };\n            this.parent.notify('get-row-position', addArgs);\n            this.rowPosition = addArgs.newRowPosition;\n            this.addRowIndex = addArgs.addRowIndex;\n            this.ariaRowIndex = addArgs.ariaRowIndex;\n        }\n        var actionComplete = 'actionComplete';\n        _super.prototype[actionComplete].call(this, args);\n    };\n    VirtualTreeContentRenderer.prototype.scrollListeners = function (scrollArgs) {\n        var info = scrollArgs.sentinel;\n        var outBuffer = 10; //this.parent.pageSettings.pageSize - Math.ceil(this.parent.pageSettings.pageSize / 1.5);\n        var content = this.parent.getContent().querySelector('.e-content');\n        var scrollHeight = outBuffer * this.parent.getRowHeight();\n        var upScroll = (scrollArgs.offset.top - this.translateY) < 0;\n        var downScroll = (scrollArgs.offset.top - this.translateY) > scrollHeight;\n        var selectedRowIndex = 'selectedRowIndex';\n        if (upScroll) {\n            var vHeight = +(this.parent.height.toString().indexOf('%') < 0 ? this.parent.height :\n                this.parent.element.getBoundingClientRect().height);\n            var index = (~~(content.scrollTop / this.parent.getRowHeight())\n                + Math.ceil(vHeight / this.parent.getRowHeight()))\n                - this.parent.getRows().length;\n            index = (index > 0) ? index : 0;\n            if (!isNullOrUndefined(this[selectedRowIndex]) && this[selectedRowIndex] != -1 && index != this[selectedRowIndex]) {\n                index = this[selectedRowIndex];\n            }\n            this.startIndex = index;\n            this.endIndex = index + this.parent.getRows().length;\n            if (this.endIndex > this.totalRecords) {\n                var lastInx = this.totalRecords - 1;\n                var remains = this.endIndex % lastInx;\n                this.endIndex = lastInx;\n                this.startIndex = this.startIndex - remains;\n            }\n            //var firsttdinx = parseInt(this.parent.getContent().querySelector('.e-content td').getAttribute('index'), 0);\n            var rowPt = Math.ceil(scrollArgs.offset.top / this.parent.getRowHeight());\n            rowPt = rowPt % this.parent.pageSettings.pageSize;\n            var firsttdinx = 0;\n            if (!isNullOrUndefined(this.parent.getRows()[rowPt])) {\n                var attr = this.parent.getContent().querySelectorAll('.e-content tr')[rowPt]\n                    .querySelector('td').getAttribute('index');\n                firsttdinx = +attr; // this.parent.getContent().querySelector('.e-content tr').getAttribute('aria-rowindex');\n            }\n            if (firsttdinx === 0) {\n                this.translateY = scrollArgs.offset.top;\n            }\n            else {\n                var height = this.parent.getRowHeight();\n                this.translateY = (scrollArgs.offset.top - (outBuffer * height) > 0) ?\n                    scrollArgs.offset.top - (outBuffer * height) + 10 : 0;\n            }\n        }\n        else if (downScroll) {\n            var nextSetResIndex = ~~(content.scrollTop / this.parent.getRowHeight());\n            var isLastBlock = (this[selectedRowIndex] + this.parent.pageSettings.pageSize) < this.totalRecords ? false : true;\n            if (!isNullOrUndefined(this[selectedRowIndex]) && this[selectedRowIndex] != -1 &&\n                nextSetResIndex != this[selectedRowIndex] && !isLastBlock) {\n                nextSetResIndex = this[selectedRowIndex];\n            }\n            var lastIndex = nextSetResIndex + this.parent.getRows().length;\n            if (lastIndex > this.totalRecords) {\n                lastIndex = nextSetResIndex +\n                    (this.totalRecords - nextSetResIndex);\n            }\n            this.startIndex = !isLastBlock ? lastIndex - this.parent.getRows().length : nextSetResIndex;\n            this.endIndex = lastIndex;\n            if (scrollArgs.offset.top > (this.parent.getRowHeight() * this.totalRecords)) {\n                this.translateY = this.getTranslateY(scrollArgs.offset.top, content.getBoundingClientRect().height);\n            }\n            else {\n                this.translateY = scrollArgs.offset.top;\n            }\n        }\n        if ((downScroll && (scrollArgs.offset.top < (this.parent.getRowHeight() * this.totalRecords)))\n            || (upScroll)) {\n            var viewInfo = getValue('getInfoFromView', this).apply(this, [scrollArgs.direction, info, scrollArgs.offset]);\n            this.previousInfo = viewInfo;\n            var page = viewInfo.loadNext && !viewInfo.loadSelf ? viewInfo.nextInfo.page : viewInfo.page;\n            this.parent.setProperties({ pageSettings: { currentPage: page } }, true);\n            viewInfo.event = viewInfo.event === 'refresh-virtual-block' ? 'model-changed' : viewInfo.event;\n            this.parent.notify(viewInfo.event, { requestType: 'virtualscroll', focusElement: scrollArgs.focusElement });\n        }\n    };\n    VirtualTreeContentRenderer.prototype.appendContent = function (target, newChild, e) {\n        if ((this.parent.dataSource instanceof DataManager && this.parent.dataSource.dataSource.url !== undefined\n            && !this.parent.dataSource.dataSource.offline && this.parent.dataSource.dataSource.url !== '') || isCountRequired(this.parent)) {\n            if (getValue('isExpandCollapse', e)) {\n                this.isRemoteExpand = true;\n            }\n            _super.prototype.appendContent.call(this, target, newChild, e);\n        }\n        else {\n            var info = e.virtualInfo.sentinelInfo && e.virtualInfo.sentinelInfo.axis === 'Y' &&\n                getValue('currentInfo', this).page && getValue('currentInfo', this).page !== e.virtualInfo.page ?\n                getValue('currentInfo', this) : e.virtualInfo;\n            var cBlock = (info.columnIndexes[0]) - 1;\n            var cOffset = this.getColumnOffset(cBlock);\n            this.virtualEle.setWrapperWidth(null, (Browser.isIE || Browser.info.name === 'edge'));\n            target = this.parent.createElement('tbody');\n            target.appendChild(newChild);\n            var replace = 'replaceWith';\n            this.getTable().querySelector('tbody')[replace](target);\n            if (!this.isExpandCollapse || this.translateY === 0) {\n                getValue('virtualEle', this).adjustTable(cOffset, this.translateY);\n            }\n            else {\n                this.isExpandCollapse = false;\n            }\n            setValue('prevInfo', this.previousInfo ? this.previousInfo : info, this);\n            var focusCell = 'focusCell';\n            var restoreAdd = 'restoreAdd';\n            _super.prototype[focusCell].call(this, e);\n            var isAdd = 'isAdd';\n            if (this[isAdd] && !this.parent.getContent().querySelector('.e-content').querySelector('.e-addedrow')) {\n                if (!(this.rowPosition === 'Top' || this.rowPosition === 'Bottom')) {\n                    if (this.ariaRowIndex >= this.startIndex) {\n                        this.restoreNewRow();\n                    }\n                    else if (this.addRowIndex && this.addRowIndex > -1) {\n                        this[isAdd] = false;\n                        this.parent.isEdit = false;\n                    }\n                }\n            }\n            this.restoreEditState();\n            _super.prototype[restoreAdd].call(this);\n        }\n    };\n    VirtualTreeContentRenderer.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off('data-ready', this.onDataReady);\n        this.parent.off('content-ready', this.fn);\n        this.parent.off('select-virtual-Row', this.toSelectVirtualRow);\n        this.parent.off('dataBound', this.dataBoundEvent);\n        this.parent.off('rowSelected', this.rowSelectedEvent);\n        this.parent.off(events.virtualActionArgs, this.virtualOtherAction);\n        this.parent.off(events.indexModifier, this.indexModifier);\n        this.parent.off('virtual-scroll-edit-action-begin', this.beginEdit);\n        this.parent.off('virtual-scroll-add-action-begin', this.beginAdd);\n        this.parent.off('virtual-scroll-edit-success', this.virtualEditSuccess);\n        this.parent.off('edit-reset', this.resetIseditValue);\n        this.parent.off('get-virtual-data', this.getData);\n        this.parent.off('virtual-scroll-edit-cancel', this.cancelEdit);\n        this.parent.off('select-row-on-context-open', this.toSelectRowOnContextOpen);\n        this.parent.off('refresh-virtual-editform-cells', this.refreshCell);\n    };\n    return VirtualTreeContentRenderer;\n}(VirtualContentRenderer));\nexport { VirtualTreeContentRenderer };\nvar TreeInterSectionObserver = /** @class */ (function (_super) {\n    __extends(TreeInterSectionObserver, _super);\n    function TreeInterSectionObserver() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.isWheeling = false;\n        _this.newPos = 0;\n        _this.lastPos = 0;\n        _this.timer = 0;\n        return _this;\n    }\n    TreeInterSectionObserver.prototype.observes = function (callback) {\n        var containerRect = 'containerRect';\n        _super.prototype[containerRect] = getValue('options', this).container.getBoundingClientRect();\n        EventHandler.add(getValue('options', this).container, 'scroll', this.virtualScrollHandlers(callback), this);\n    };\n    TreeInterSectionObserver.prototype.clear = function () {\n        this.lastPos = null;\n    };\n    TreeInterSectionObserver.prototype.virtualScrollHandlers = function (callback) {\n        var _this = this;\n        var prevTop = 0;\n        var prevLeft = 0;\n        return function (e) {\n            var scrollTop = e.target.scrollTop;\n            var scrollLeft = e.target.scrollLeft;\n            var direction = prevTop < scrollTop ? 'down' : 'up';\n            direction = prevLeft === scrollLeft ? direction : prevLeft < scrollLeft ? 'right' : 'left';\n            prevTop = scrollTop;\n            prevLeft = scrollLeft;\n            var current = getValue('sentinelInfo', _this)[direction];\n            var delta = 0;\n            _this.newPos = scrollTop;\n            if (_this.lastPos != null) { // && newPos < maxScroll\n                delta = _this.newPos - _this.lastPos;\n            }\n            _this.lastPos = _this.newPos;\n            if (_this.timer) {\n                clearTimeout(_this.timer);\n            }\n            _this.timer = setTimeout(_this.clear, 0);\n            /*if (this.options.axes.indexOf(current.axis) === -1) {\n            return;\n        }*/\n            /*if(delta > 45 || delta < -45){\n          this.isWheeling = true;\n        }*/\n            if ((delta > 100 || delta < -100) && (e && e.preventDefault)) {\n                e.returnValue = false;\n                e.preventDefault();\n            }\n            callback({ direction: direction, isWheel: _this.isWheeling,\n                sentinel: current, offset: { top: scrollTop, left: scrollLeft },\n                focusElement: document.activeElement });\n        };\n    };\n    return TreeInterSectionObserver;\n}(InterSectionObserver));\nexport { TreeInterSectionObserver };\n"]},"metadata":{},"sourceType":"module"}