{"ast":null,"code":"import { AutoComplete } from '@syncfusion/ej2-dropdowns';\nimport { DataManager, Query } from '@syncfusion/ej2-data';\nimport { Browser, isNullOrUndefined, extend, getValue } from '@syncfusion/ej2-base';\nimport { getZIndexCalcualtion, eventPromise } from '../base/util';\nimport * as events from '../base/constant';\n/**\n * `string filterui` render string column.\n *\n * @hidden\n */\n\nvar StringFilterUI =\n/** @class */\nfunction () {\n  function StringFilterUI(parent, serviceLocator, filterSettings) {\n    this.parent = parent;\n    this.serLocator = serviceLocator;\n    this.filterSettings = filterSettings;\n  }\n\n  StringFilterUI.prototype.create = function (args) {\n    this.instance = this.parent.createElement('input', {\n      className: 'e-flmenu-input',\n      id: 'strui-' + args.column.uid\n    });\n    args.target.appendChild(this.instance);\n    this.dialogObj = args.dialogObj;\n    this.actObj = this.getAutoCompleteOptions(args);\n    this.actObj.appendTo(this.instance);\n  };\n\n  StringFilterUI.prototype.getAutoCompleteOptions = function (args) {\n    var _this = this;\n\n    var isForeignColumn = args.column.isForeignColumn();\n    var foreignColumnQuery;\n\n    if (isForeignColumn) {\n      foreignColumnQuery = new Query();\n      foreignColumnQuery.params = this.parent.query.params;\n    }\n\n    var dataSource = isForeignColumn ? args.column.dataSource : this.parent.dataSource;\n    var fields = {\n      value: isForeignColumn ? args.column.foreignKeyValue : args.column.field\n    };\n    var autoComplete = new AutoComplete(extend({\n      dataSource: dataSource instanceof DataManager ? dataSource : new DataManager(dataSource),\n      fields: fields,\n      locale: this.parent.locale,\n      enableRtl: this.parent.enableRtl,\n      query: isForeignColumn ? foreignColumnQuery : this.parent.query.clone(),\n      sortOrder: 'Ascending',\n      open: this.openPopup.bind(this),\n      cssClass: 'e-popup-flmenu',\n      focus: function () {\n        _this.actObj.filterType = args.getOptrInstance.getFlOperator();\n      },\n      autofill: true,\n      placeholder: args.localizeText.getConstant('EnterValue'),\n      actionComplete: function (e) {\n        e.result = e.result.filter(function (obj, index, arr) {\n          return arr.map(function (mapObj) {\n            return getValue(_this.actObj.fields.value, mapObj);\n          }).indexOf(getValue(_this.actObj.fields.value, obj)) === index;\n        });\n      }\n    }, args.column.filter.params));\n\n    if (dataSource && 'result' in dataSource) {\n      var query = this.parent.getQuery ? this.parent.getQuery().clone() : new Query();\n      var defObj = eventPromise({\n        requestType: 'stringfilterrequest'\n      }, query);\n      this.parent.trigger(events.dataStateChange, defObj.state);\n      var def = defObj.deffered;\n      def.promise.then(function (e) {\n        autoComplete.dataSource = new DataManager(e);\n      });\n    }\n\n    return autoComplete;\n  };\n\n  StringFilterUI.prototype.write = function (args) {\n    if (args.filteredValue !== '' && !isNullOrUndefined(args.filteredValue)) {\n      var struiObj = document.querySelector('#strui-' + args.column.uid).ej2_instances[0];\n      struiObj.value = args.filteredValue;\n    }\n  };\n\n  StringFilterUI.prototype.read = function (element, column, filterOptr, filterObj) {\n    var actuiObj = document.querySelector('#strui-' + column.uid).ej2_instances[0];\n\n    if (Browser.isDevice) {\n      actuiObj.hidePopup();\n      actuiObj.focusOut();\n    }\n\n    var filterValue = actuiObj.value;\n\n    if (isNullOrUndefined(filterValue) || filterValue === '') {\n      filterValue = null;\n    }\n\n    filterObj.filterByColumn(column.field, filterOptr, filterValue, 'and', this.parent.filterSettings.enableCaseSensitivity);\n  };\n\n  StringFilterUI.prototype.openPopup = function (args) {\n    getZIndexCalcualtion(args, this.dialogObj);\n  };\n\n  return StringFilterUI;\n}();\n\nexport { StringFilterUI };","map":{"version":3,"sources":["/Users/zhouzhou/Desktop/lightfront/node_modules/@syncfusion/ej2-grids/src/grid/renderer/string-filter-ui.js"],"names":["AutoComplete","DataManager","Query","Browser","isNullOrUndefined","extend","getValue","getZIndexCalcualtion","eventPromise","events","StringFilterUI","parent","serviceLocator","filterSettings","serLocator","prototype","create","args","instance","createElement","className","id","column","uid","target","appendChild","dialogObj","actObj","getAutoCompleteOptions","appendTo","_this","isForeignColumn","foreignColumnQuery","params","query","dataSource","fields","value","foreignKeyValue","field","autoComplete","locale","enableRtl","clone","sortOrder","open","openPopup","bind","cssClass","focus","filterType","getOptrInstance","getFlOperator","autofill","placeholder","localizeText","getConstant","actionComplete","e","result","filter","obj","index","arr","map","mapObj","indexOf","getQuery","defObj","requestType","trigger","dataStateChange","state","def","deffered","promise","then","write","filteredValue","struiObj","document","querySelector","ej2_instances","read","element","filterOptr","filterObj","actuiObj","isDevice","hidePopup","focusOut","filterValue","filterByColumn","enableCaseSensitivity"],"mappings":"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","sourcesContent":["import { AutoComplete } from '@syncfusion/ej2-dropdowns';\nimport { DataManager, Query } from '@syncfusion/ej2-data';\nimport { Browser, isNullOrUndefined, extend, getValue } from '@syncfusion/ej2-base';\nimport { getZIndexCalcualtion, eventPromise } from '../base/util';\nimport * as events from '../base/constant';\n/**\n * `string filterui` render string column.\n *\n * @hidden\n */\nvar StringFilterUI = /** @class */ (function () {\n    function StringFilterUI(parent, serviceLocator, filterSettings) {\n        this.parent = parent;\n        this.serLocator = serviceLocator;\n        this.filterSettings = filterSettings;\n    }\n    StringFilterUI.prototype.create = function (args) {\n        this.instance = this.parent.createElement('input', { className: 'e-flmenu-input', id: 'strui-' + args.column.uid });\n        args.target.appendChild(this.instance);\n        this.dialogObj = args.dialogObj;\n        this.actObj = this.getAutoCompleteOptions(args);\n        this.actObj.appendTo(this.instance);\n    };\n    StringFilterUI.prototype.getAutoCompleteOptions = function (args) {\n        var _this = this;\n        var isForeignColumn = args.column.isForeignColumn();\n        var foreignColumnQuery;\n        if (isForeignColumn) {\n            foreignColumnQuery = new Query();\n            foreignColumnQuery.params = this.parent.query.params;\n        }\n        var dataSource = isForeignColumn ? args.column.dataSource : this.parent.dataSource;\n        var fields = { value: isForeignColumn ? args.column.foreignKeyValue : args.column.field };\n        var autoComplete = new AutoComplete(extend({\n            dataSource: dataSource instanceof DataManager ? dataSource : new DataManager(dataSource),\n            fields: fields,\n            locale: this.parent.locale,\n            enableRtl: this.parent.enableRtl,\n            query: isForeignColumn ? foreignColumnQuery : this.parent.query.clone(),\n            sortOrder: 'Ascending',\n            open: this.openPopup.bind(this),\n            cssClass: 'e-popup-flmenu',\n            focus: function () {\n                _this.actObj.filterType = args.getOptrInstance.getFlOperator();\n            },\n            autofill: true,\n            placeholder: args.localizeText.getConstant('EnterValue'),\n            actionComplete: function (e) {\n                e.result = e.result.filter(function (obj, index, arr) {\n                    return arr.map(function (mapObj) {\n                        return (getValue(_this.actObj.fields.value, mapObj));\n                    }).indexOf(getValue((_this.actObj.fields.value), obj)) === index;\n                });\n            }\n        }, args.column.filter.params));\n        if (dataSource && 'result' in dataSource) {\n            var query = this.parent.getQuery ? this.parent.getQuery().clone() : new Query();\n            var defObj = eventPromise({ requestType: 'stringfilterrequest' }, query);\n            this.parent.trigger(events.dataStateChange, defObj.state);\n            var def = defObj.deffered;\n            def.promise.then(function (e) {\n                autoComplete.dataSource = new DataManager(e);\n            });\n        }\n        return autoComplete;\n    };\n    StringFilterUI.prototype.write = function (args) {\n        if (args.filteredValue !== '' && !isNullOrUndefined(args.filteredValue)) {\n            var struiObj = document.querySelector('#strui-' + args.column.uid).ej2_instances[0];\n            struiObj.value = args.filteredValue;\n        }\n    };\n    StringFilterUI.prototype.read = function (element, column, filterOptr, filterObj) {\n        var actuiObj = document.querySelector('#strui-' + column.uid).ej2_instances[0];\n        if (Browser.isDevice) {\n            actuiObj.hidePopup();\n            actuiObj.focusOut();\n        }\n        var filterValue = actuiObj.value;\n        if (isNullOrUndefined(filterValue) || filterValue === '') {\n            filterValue = null;\n        }\n        filterObj.filterByColumn(column.field, filterOptr, filterValue, 'and', this.parent.filterSettings.enableCaseSensitivity);\n    };\n    StringFilterUI.prototype.openPopup = function (args) {\n        getZIndexCalcualtion(args, this.dialogObj);\n    };\n    return StringFilterUI;\n}());\nexport { StringFilterUI };\n"]},"metadata":{},"sourceType":"module"}