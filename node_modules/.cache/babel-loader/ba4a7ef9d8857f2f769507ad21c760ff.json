{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { extend, remove, isNullOrUndefined, setStyleAttribute, removeClass, addClass } from '@syncfusion/ej2-base';\nimport { ContentRender } from './content-renderer';\nimport * as events from '../base/constant';\nimport { isRowEnteredInGrid, parentsUntil, setDisplayValue } from '../base/util';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { CheckBoxFilterBase } from '../common/checkbox-filter-base';\nimport { GroupModelGenerator } from '../services/group-model-generator';\nimport { GroupSummaryModelGenerator, CaptionSummaryModelGenerator } from '../services/summary-model-generator';\nimport * as literals from '../base/string-literals';\n/**\n * GroupLazyLoadRenderer is used to perform lazy load grouping\n *\n * @hidden\n */\n\nvar GroupLazyLoadRenderer =\n/** @class */\nfunction (_super) {\n  __extends(GroupLazyLoadRenderer, _super);\n\n  function GroupLazyLoadRenderer(parent, locator) {\n    var _this = _super.call(this, parent, locator) || this;\n\n    _this.childCount = 0;\n    _this.scrollData = [];\n    _this.isFirstChildRow = false;\n    _this.groupCache = {};\n    _this.startIndexes = {};\n    _this.captionCounts = {};\n    _this.rowsByUid = {};\n    _this.objIdxByUid = {};\n    _this.initialGroupCaptions = {};\n    _this.requestType = ['paging', 'columnstate', 'reorder', 'cancel', 'save', 'beginEdit', 'add', 'delete'];\n    /** @hidden */\n\n    _this.cacheMode = false;\n    /** @hidden */\n\n    _this.cacheBlockSize = 5;\n    /** @hidden */\n\n    _this.ignoreAccent = _this.parent.allowFiltering ? _this.parent.filterSettings.ignoreAccent : false;\n    /** @hidden */\n\n    _this.allowCaseSensitive = false;\n    _this.locator = locator;\n    _this.groupGenerator = new GroupModelGenerator(_this.parent);\n    _this.summaryModelGen = new GroupSummaryModelGenerator(_this.parent);\n    _this.captionModelGen = new CaptionSummaryModelGenerator(_this.parent);\n    _this.rowRenderer = new RowRenderer(_this.locator, null, _this.parent);\n\n    _this.eventListener();\n\n    return _this;\n  }\n\n  GroupLazyLoadRenderer.prototype.eventListener = function () {\n    this.parent.addEventListener(events.actionBegin, this.actionBegin.bind(this));\n    this.parent.addEventListener(events.actionComplete, this.actionComplete.bind(this));\n    this.parent.on(events.initialEnd, this.setLazyLoadPageSize, this);\n    this.parent.on(events.setGroupCache, this.setCache, this);\n    this.parent.on(events.lazyLoadScrollHandler, this.scrollHandler, this);\n    this.parent.on(events.columnVisibilityChanged, this.setVisible, this);\n    this.parent.on(events.groupCollapse, this.collapseShortcut, this);\n  };\n  /**\n   * @param {HTMLTableRowElement} tr - specifies the table row element\n   * @returns {void}\n   * @hidden\n   */\n\n\n  GroupLazyLoadRenderer.prototype.captionExpand = function (tr) {\n    var _this = this;\n\n    var page = this.parent.pageSettings.currentPage;\n    var rowsObject = this.groupCache[page];\n    var uid = tr.getAttribute('data-uid');\n    var oriIndex = this.getRowObjectIndexByUid(uid);\n    var isRowExist = rowsObject[oriIndex + 1] ? rowsObject[oriIndex].indent < rowsObject[oriIndex + 1].indent : false;\n    var data = rowsObject[oriIndex];\n    var key = this.getGroupKeysAndFields(oriIndex, rowsObject);\n    var e = {\n      captionRowElement: tr,\n      groupInfo: data,\n      enableCaching: true,\n      cancel: false\n    };\n    this.parent.trigger(events.lazyLoadGroupExpand, e, function (args) {\n      if (args.cancel) {\n        return;\n      }\n\n      args.keys = key.keys;\n      args.fields = key.fields;\n      args.rowIndex = tr.rowIndex;\n      args.makeRequest = !args.enableCaching || !isRowExist;\n\n      if (!args.enableCaching && isRowExist) {\n        _this.clearCache([uid]);\n      }\n\n      args.skip = 0;\n      args.take = _this.pageSize;\n      data.isExpand = _this.rowsByUid[page][data.uid].isExpand = true;\n\n      _this.captionRowExpand(args);\n    });\n  };\n  /**\n   * @param {HTMLTableRowElement} tr - specifies the table row element\n   * @returns {void}\n   * @hidden\n   */\n\n\n  GroupLazyLoadRenderer.prototype.captionCollapse = function (tr) {\n    var _this = this;\n\n    var cache = this.groupCache[this.parent.pageSettings.currentPage];\n    var rowIdx = tr.rowIndex;\n    var uid = tr.getAttribute('data-uid');\n    var captionIndex = this.getRowObjectIndexByUid(uid);\n    var e = {\n      captionRowElement: tr,\n      groupInfo: cache[captionIndex],\n      cancel: false\n    };\n    this.parent.trigger(events.lazyLoadGroupCollapse, e, function (args) {\n      if (args.cancel) {\n        return;\n      }\n\n      args.isExpand = false;\n\n      _this.removeRows(captionIndex, rowIdx);\n    });\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.setLazyLoadPageSize = function () {\n    var scrollEle = this.parent.getContent().firstElementChild;\n    var blockSize = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n    this.pageSize = this.pageSize ? this.pageSize : blockSize * 3;\n    this.blockSize = Math.ceil(this.pageSize / 2);\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.clearLazyGroupCache = function () {\n    this.clearCache();\n  };\n\n  GroupLazyLoadRenderer.prototype.clearCache = function (uids) {\n    uids = uids ? uids : this.getInitialCaptionIndexes();\n    var cache = this.groupCache[this.parent.pageSettings.currentPage];\n\n    if (uids.length) {\n      for (var i = 0; i < uids.length; i++) {\n        var capIdx = this.getRowObjectIndexByUid(uids[i]);\n        var capRow = cache[capIdx];\n\n        if (!capRow) {\n          continue;\n        }\n\n        if (this.captionCounts[this.parent.pageSettings.currentPage][capRow.uid]) {\n          for (var i_1 = capIdx + 1; i_1 < cache.length; i_1++) {\n            if (cache[i_1].indent === capRow.indent || cache[i_1].indent < capRow.indent) {\n              delete this.captionCounts[this.parent.pageSettings.currentPage][capRow.uid];\n              break;\n            }\n\n            if (cache[i_1].isCaptionRow) {\n              delete this.captionCounts[this.parent.pageSettings.currentPage][cache[i_1].uid];\n            }\n          }\n        }\n\n        if (capRow.isExpand) {\n          var tr = this.parent.getRowElementByUID(capRow.uid);\n\n          if (!tr) {\n            return;\n          }\n\n          this.parent.groupModule.expandCollapseRows(tr.querySelector('.e-recordplusexpand'));\n        }\n\n        var child = this.getNextChilds(capIdx);\n\n        if (!child.length) {\n          continue;\n        }\n\n        var subChild = [];\n\n        if (child[child.length - 1].isCaptionRow) {\n          subChild = this.getChildRowsByParentIndex(cache.indexOf(child[child.length - 1]), false, false, null, true, true);\n        }\n\n        var start = cache.indexOf(child[0]);\n        var end = subChild.length ? cache.indexOf(subChild[subChild.length - 1]) : cache.indexOf(child[child.length - 1]);\n        cache.splice(start, end - (start - 1));\n        this.refreshCaches();\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.refreshCaches = function () {\n    var page = this.parent.pageSettings.currentPage;\n    var cache = this.groupCache[page];\n    this.rowsByUid = {};\n    this.objIdxByUid = {};\n\n    for (var i = 0; i < cache.length; i++) {\n      this.maintainRows(cache[i], i);\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.getInitialCaptionIndexes = function () {\n    var page = this.parent.pageSettings.currentPage;\n    var uids = [];\n\n    for (var i = 0; i < this.initialGroupCaptions[page].length; i++) {\n      uids.push(this.initialGroupCaptions[page][i].uid);\n    }\n\n    return uids;\n  };\n  /**\n   * @param {string} uid - specifies the uid\n   * @returns {number} returns the row object uid\n   * @hidden\n   */\n\n\n  GroupLazyLoadRenderer.prototype.getRowObjectIndexByUid = function (uid) {\n    return this.objIdxByUid[this.parent.pageSettings.currentPage][uid];\n  };\n\n  GroupLazyLoadRenderer.prototype.collapseShortcut = function (args) {\n    if (this.parent.groupSettings.columns.length && args.target && parentsUntil(args.target, literals.content) && args.target.parentElement.tagName === 'TR') {\n      if (!args.collapse && parentsUntil(args.target, literals.row)) {\n        return;\n      }\n\n      var row = args.target.parentElement;\n      var uid = row.getAttribute('data-uid');\n\n      if (args.collapse) {\n        var rowObj = this.getRowByUid(uid);\n        var capRow = this.getRowByUid(rowObj.parentUid);\n\n        if (capRow.isCaptionRow && capRow.isExpand) {\n          var capEle = this.getRowElementByUid(rowObj.parentUid);\n          this.parent.groupModule.expandCollapseRows(capEle.cells[rowObj.indent - 1]);\n        }\n      } else {\n        var capRow = this.getRowByUid(uid);\n\n        if (capRow.isCaptionRow && !capRow.isExpand) {\n          var capEle = this.getRowElementByUid(uid);\n          this.parent.groupModule.expandCollapseRows(capEle.cells[capRow.indent]);\n        }\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.getRowByUid = function (uid) {\n    return this.rowsByUid[this.parent.pageSettings.currentPage][uid];\n  };\n\n  GroupLazyLoadRenderer.prototype.actionBegin = function (args) {\n    if (!args.cancel) {\n      if (!this.requestType.some(function (value) {\n        return value === args.requestType;\n      })) {\n        this.groupCache = {};\n        this.resetRowMaintenance();\n      }\n\n      if (args.requestType === 'reorder' && this.parent.groupSettings.columns.length) {\n        var keys = Object.keys(this.groupCache);\n\n        for (var j = 0; j < keys.length; j++) {\n          var cache = this.groupCache[keys[j]];\n\n          for (var i = 0; i < cache.length; i++) {\n            if (cache[i].isCaptionRow && !this.captionModelGen.isEmpty()) {\n              this.changeCaptionRow(cache[i], null, keys[j]);\n            }\n\n            if (cache[i].isDataRow) {\n              var from = args.fromIndex + cache[i].indent;\n              var to = args.toIndex + cache[i].indent;\n              this.moveCells(cache[i].cells, from, to);\n            }\n          }\n        }\n      }\n\n      if (args.requestType === 'delete' || args.action === 'add' && args.requestType === 'save') {\n        this.groupCache = {};\n        this.resetRowMaintenance();\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.actionComplete = function (args) {\n    if (!args.cancel && args.requestType !== 'columnstate' && args.requestType !== 'beginEdit' && args.requestType !== 'delete' && args.requestType !== 'save' && args.requestType !== 'reorder') {\n      this.scrollReset();\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.resetRowMaintenance = function () {\n    this.startIndexes = {};\n    this.captionCounts = {};\n    this.rowsByUid = {};\n    this.objIdxByUid = {};\n    this.initialGroupCaptions = {};\n  };\n\n  GroupLazyLoadRenderer.prototype.moveCells = function (arr, from, to) {\n    if (from >= arr.length) {\n      var k = from - arr.length;\n\n      while (k-- + 1) {\n        arr.push(undefined);\n      }\n    }\n\n    arr.splice(from, 0, arr.splice(to, 1)[0]);\n  };\n\n  GroupLazyLoadRenderer.prototype.removeRows = function (idx, trIdx) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n    var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n    var aggUid;\n\n    if (this.parent.aggregates.length) {\n      var agg = this.getAggregateByCaptionIndex(idx);\n      aggUid = agg.length ? agg[agg.length - 1].uid : undefined;\n    }\n\n    var indent = rows[idx].indent;\n    this.addClass(this.getNextChilds(idx));\n    rows[idx].isExpand = this.rowsByUid[page][rows[idx].uid].isExpand = false;\n    var capUid;\n\n    for (var i = idx + 1; i < rows.length; i++) {\n      if (rows[i].indent === indent || rows[i].indent < indent) {\n        capUid = rows[i].uid;\n        break;\n      }\n\n      if (rows[i].isCaptionRow && rows[i].isExpand) {\n        this.addClass(this.getNextChilds(i));\n      }\n    }\n\n    for (var i = trIdx + 1; i < trs.length; i++) {\n      if (trs[i].getAttribute('data-uid') === capUid) {\n        break;\n      } else if (trs[i].getAttribute('data-uid') === aggUid) {\n        remove(trs[i]);\n        break;\n      } else {\n        remove(trs[i]);\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.addClass = function (rows) {\n    var last = rows[this.blockSize];\n\n    if (last) {\n      last.lazyLoadCssClass = 'e-lazyload-middle-down';\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.getNextChilds = function (index, rowObjects) {\n    var group = this.groupCache[this.parent.pageSettings.currentPage];\n    var rows = rowObjects ? rowObjects : group;\n    var indent = group[index].indent + 1;\n    var childRows = [];\n\n    for (var i = rowObjects ? 0 : index + 1; i < rows.length; i++) {\n      if (rows[i].indent < indent) {\n        break;\n      }\n\n      if (rows[i].indent === indent) {\n        childRows.push(rows[i]);\n      }\n    }\n\n    return childRows;\n  };\n\n  GroupLazyLoadRenderer.prototype.lazyLoadHandler = function (args) {\n    this.setStartIndexes();\n    var tr = this.parent.getContent().querySelectorAll('tr')[args.index];\n    var uid = tr.getAttribute('data-uid');\n    var captionIndex = this.getRowObjectIndexByUid(uid);\n    var captionRow = this.groupCache[this.parent.pageSettings.currentPage][captionIndex];\n    var rows = args.isRowExist ? args.isScroll ? this.scrollData : this.getChildRowsByParentIndex(captionIndex, true, true, null, true) : [];\n    this.scrollData = [];\n\n    if (!args.isRowExist) {\n      this.setRowIndexes(captionIndex, captionRow);\n      this.refreshCaptionRowCount(this.groupCache[this.parent.pageSettings.currentPage][captionIndex], args.count);\n\n      if (Object.keys(args.data).indexOf('GroupGuid') !== -1) {\n        for (var i = 0; i < args.data.length; i++) {\n          var data = this.groupGenerator.generateCaptionRow(args.data[i], args.level, captionRow.parentGid, undefined, 0, captionRow.uid);\n          rows.push(data);\n\n          if (this.parent.aggregates.length) {\n            rows = rows.concat(this.summaryModelGen.generateRows(args.data[i], {\n              level: args.level + 1,\n              parentUid: data.uid\n            }));\n          }\n        }\n      } else {\n        this.groupGenerator.index = this.getStartIndex(captionIndex, args.isScroll);\n        rows = this.groupGenerator.generateDataRows(args.data, args.level, captionRow.parentGid, 0, captionRow.uid);\n      }\n    }\n\n    var trIdx = args.isScroll ? this.rowIndex : args.index;\n    var nxtChild = this.getNextChilds(captionIndex, rows);\n    var lastRow = !args.up ? this.hasLastChildRow(args.isScroll, args.count, nxtChild.length) : true;\n\n    if (!args.isRowExist && !lastRow) {\n      nxtChild[this.blockSize].lazyLoadCssClass = 'e-lazyload-middle-down';\n    }\n\n    if (!lastRow) {\n      nxtChild[nxtChild.length - 1].lazyLoadCssClass = 'e-not-lazyload-end';\n    }\n\n    var aggregates = !args.isScroll && !args.isRowExist ? this.getAggregateByCaptionIndex(captionIndex) : [];\n\n    if (!args.up) {\n      if (!args.isRowExist) {\n        this.refreshRowObjects(rows, args.isScroll ? this.rowObjectIndex : captionIndex);\n      }\n    }\n\n    this.render(trIdx, rows, lastRow, aggregates);\n\n    if (this.isFirstChildRow && !args.up) {\n      this.parent.getContent().firstElementChild.scrollTop = rows.length * this.parent.getRowHeight();\n    }\n\n    this.isFirstChildRow = false;\n    this.rowIndex = undefined;\n    this.rowObjectIndex = undefined;\n    this.childCount = 0;\n  };\n\n  GroupLazyLoadRenderer.prototype.setRowIndexes = function (capIdx, row) {\n    if (!this.captionCounts[this.parent.pageSettings.currentPage]) {\n      this.captionCounts[this.parent.pageSettings.currentPage] = {};\n    }\n\n    if (row.isCaptionRow) {\n      this.captionCounts[this.parent.pageSettings.currentPage][row.uid] = row.data.count;\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.getStartIndex = function (capIdx, isScroll) {\n    var page = this.parent.pageSettings.currentPage;\n    var cache = this.groupCache[page];\n\n    if (isScroll) {\n      return cache[this.rowObjectIndex].index + 1;\n    }\n\n    var count = 0;\n    var idx = 0;\n    var prevCapRow = this.getRowByUid(cache[capIdx].parentUid);\n\n    if (prevCapRow) {\n      idx = this.prevCaptionCount(prevCapRow);\n    }\n\n    if (cache[capIdx].indent > 0) {\n      for (var i = capIdx - 1; i >= 0; i--) {\n        if (cache[i].indent < cache[capIdx].indent) {\n          break;\n        }\n\n        if (cache[i].isCaptionRow && cache[i].indent === cache[capIdx].indent) {\n          count = count + cache[i].data.count;\n        }\n      }\n    }\n\n    var index = count + idx + this.startIndexes[page][cache[capIdx].parentGid];\n    return index;\n  };\n\n  GroupLazyLoadRenderer.prototype.prevCaptionCount = function (prevCapRow) {\n    var page = this.parent.pageSettings.currentPage;\n    var cache = this.groupCache[page];\n    var idx = 0;\n\n    for (var i = cache.indexOf(prevCapRow) - 1; i >= 0; i--) {\n      if (cache[i].indent === 0) {\n        break;\n      }\n\n      if (cache[i].indent < prevCapRow.indent) {\n        break;\n      }\n\n      if (cache[i].isCaptionRow && cache[i].indent === prevCapRow.indent) {\n        var count = this.captionCounts[page][cache[i].uid];\n        idx = idx + (count ? count : cache[i].data.count);\n      }\n    }\n\n    var capRow = this.getRowByUid(prevCapRow.parentUid);\n\n    if (capRow) {\n      idx = idx + this.prevCaptionCount(capRow);\n    }\n\n    return idx;\n  };\n\n  GroupLazyLoadRenderer.prototype.setStartIndexes = function () {\n    var cache = this.groupCache[this.parent.pageSettings.currentPage];\n\n    if (!this.startIndexes[this.parent.pageSettings.currentPage]) {\n      var indexes = [];\n      var idx = void 0;\n\n      for (var i = 0; i < cache.length; i++) {\n        if (cache[i].isCaptionRow) {\n          if (!indexes.length) {\n            indexes.push(0);\n          } else {\n            indexes.push(cache[idx].data.count + indexes[indexes.length - 1]);\n          }\n\n          idx = i;\n        }\n      }\n\n      this.startIndexes[this.parent.pageSettings.currentPage] = indexes;\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.hasLastChildRow = function (isScroll, captionCount, rowCount) {\n    return isScroll ? captionCount === this.childCount + rowCount : captionCount === rowCount;\n  };\n\n  GroupLazyLoadRenderer.prototype.refreshCaptionRowCount = function (row, count) {\n    row.data.count = count;\n  };\n\n  GroupLazyLoadRenderer.prototype.render = function (trIdx, rows, hasLastChildRow, aggregates) {\n    var tr = this.parent.getContent().querySelectorAll('tr')[trIdx];\n\n    if (tr && aggregates.length) {\n      for (var i = aggregates.length - 1; i >= 0; i--) {\n        tr.insertAdjacentElement('afterend', this.rowRenderer.render(aggregates[i], this.parent.getColumns()));\n      }\n    }\n\n    if (tr && rows.length) {\n      for (var i = rows.length - 1; i >= 0; i--) {\n        if (this.confirmRowRendering(rows[i])) {\n          tr.insertAdjacentElement('afterend', this.rowRenderer.render(rows[i], this.parent.getColumns()));\n        }\n      }\n    }\n  };\n  /**\n   * @param {Row<Column>} row - specifies the row\n   * @param {number} index - specifies the index\n   * @returns {void}\n   * @hidden\n   */\n\n\n  GroupLazyLoadRenderer.prototype.maintainRows = function (row, index) {\n    var page = this.parent.pageSettings.currentPage;\n\n    if (!this.rowsByUid[page]) {\n      this.rowsByUid[page] = {};\n      this.objIdxByUid[page] = {};\n    }\n\n    if (row.uid) {\n      this.rowsByUid[page][row.uid] = row;\n    }\n\n    this.objIdxByUid[page][row.uid] = index;\n  };\n\n  GroupLazyLoadRenderer.prototype.confirmRowRendering = function (row) {\n    var check = true;\n\n    if (isNullOrUndefined(row.indent) && !row.isDataRow && !row.isCaptionRow) {\n      var cap = this.getRowByUid(row.parentUid);\n\n      if (cap.isCaptionRow && !cap.isExpand) {\n        check = false;\n      }\n    }\n\n    return check;\n  };\n\n  GroupLazyLoadRenderer.prototype.refreshRowObjects = function (newRows, index) {\n    var page = this.parent.pageSettings.currentPage;\n    var rowsObject = this.groupCache[page];\n    this.rowsByUid[page] = {};\n    this.objIdxByUid[page] = {};\n    var newRowsObject = [];\n    var k = 0;\n\n    for (var i = 0; i < rowsObject.length; i++) {\n      if (i === index) {\n        this.maintainRows(rowsObject[i], k);\n        newRowsObject.push(rowsObject[i]);\n        k++;\n\n        for (var j = 0; j < newRows.length; j++) {\n          this.maintainRows(newRows[j], k);\n          newRowsObject.push(newRows[j]);\n          k++;\n        }\n      } else {\n        this.maintainRows(rowsObject[i], k);\n        newRowsObject.push(rowsObject[i]);\n        k++;\n      }\n    }\n\n    this.groupCache[this.parent.pageSettings.currentPage] = extend([], newRowsObject);\n    this.updateCurrentViewData();\n  };\n\n  GroupLazyLoadRenderer.prototype.getAggregateByCaptionIndex = function (index) {\n    var cache = this.groupCache[this.parent.pageSettings.currentPage];\n    var parent = cache[index];\n    var indent = parent.indent;\n    var uid = parent.uid;\n    var agg = [];\n\n    for (var i = index + 1; i < cache.length; i++) {\n      if (cache[i].indent === indent) {\n        break;\n      }\n\n      if (isNullOrUndefined(cache[i].indent) && cache[i].parentUid === uid) {\n        agg.push(cache[i]);\n      }\n    }\n\n    return agg;\n  };\n\n  GroupLazyLoadRenderer.prototype.getChildRowsByParentIndex = function (index, deep, block, data, includeAgg, includeCollapseAgg) {\n    var cache = data ? data : this.groupCache[this.parent.pageSettings.currentPage];\n    var parentRow = cache[index];\n    var agg = [];\n\n    if (!parentRow.isCaptionRow || parentRow.isCaptionRow && !parentRow.isExpand && !includeCollapseAgg) {\n      return [];\n    }\n\n    if (includeAgg && this.parent.aggregates.length) {\n      agg = this.getAggregateByCaptionIndex(index);\n    }\n\n    var indent = parentRow.indent;\n    var uid = parentRow.uid;\n    var rows = [];\n    var count = 0;\n\n    for (var i = index + 1; i < cache.length; i++) {\n      if (cache[i].parentUid === uid) {\n        if (isNullOrUndefined(cache[i].indent)) {\n          continue;\n        }\n\n        count++;\n        rows.push(cache[i]);\n\n        if (deep && cache[i].isCaptionRow) {\n          rows = rows.concat(this.getChildRowsByParentIndex(i, deep, block, data, includeAgg));\n        }\n\n        if (block && count === this.pageSize) {\n          break;\n        }\n      }\n\n      if (cache[i].indent === indent) {\n        break;\n      }\n    }\n\n    return rows.concat(agg);\n  };\n  /**\n   * @param {boolean} isReorder - specifies the isreorder\n   * @returns {Row<Column>[]} returns the row\n   * @hidden\n   */\n\n\n  GroupLazyLoadRenderer.prototype.initialGroupRows = function (isReorder) {\n    var rows = [];\n    var cache = this.groupCache[this.parent.pageSettings.currentPage];\n\n    if (isReorder) {\n      return this.getRenderedRowsObject();\n    }\n\n    for (var i = 0; i < cache.length; i++) {\n      if (cache[i].indent === 0) {\n        rows.push(cache[i]);\n        rows = rows.concat(this.getChildRowsByParentIndex(i, true, true, cache, true));\n      }\n    }\n\n    return rows;\n  };\n  /**\n   * @returns {Row<Column>[]} retruns the row\n   * @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.getRenderedRowsObject = function () {\n    var rows = [];\n    var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n\n    for (var i = 0; i < trs.length; i++) {\n      rows.push(this.getRowByUid(trs[i].getAttribute('data-uid')));\n    }\n\n    return rows;\n  };\n\n  GroupLazyLoadRenderer.prototype.getCacheRowsOnDownScroll = function (index) {\n    var rows = [];\n    var rowsObject = this.groupCache[this.parent.pageSettings.currentPage];\n    var k = index;\n\n    for (var i = 0; i < this.pageSize; i++) {\n      if (!rowsObject[k] || rowsObject[k].indent < rowsObject[index].indent) {\n        break;\n      }\n\n      if (rowsObject[k].indent === rowsObject[index].indent) {\n        rows.push(rowsObject[k]);\n\n        if (rowsObject[k].isCaptionRow && rowsObject[k].isExpand) {\n          rows = rows.concat(this.getChildRowsByParentIndex(k, true, true, null, true));\n        }\n      }\n\n      if (rowsObject[k].indent > rowsObject[index].indent || isNullOrUndefined(rowsObject[k].indent)) {\n        i--;\n      }\n\n      k++;\n    }\n\n    return rows;\n  };\n\n  GroupLazyLoadRenderer.prototype.getCacheRowsOnUpScroll = function (start, end, index) {\n    var rows = [];\n    var rowsObject = this.groupCache[this.parent.pageSettings.currentPage];\n    var str = false;\n\n    for (var i = 0; i < rowsObject.length; i++) {\n      if (str && (!rowsObject[i] || rowsObject[i].indent < rowsObject[index].indent || rowsObject[i].uid === end)) {\n        break;\n      }\n\n      if (!str && rowsObject[i].uid === start) {\n        str = true;\n      }\n\n      if (str && rowsObject[i].indent === rowsObject[index].indent) {\n        rows.push(rowsObject[i]);\n\n        if (rowsObject[i].isCaptionRow && rowsObject[i].isExpand) {\n          rows = rows.concat(this.getChildRowsByParentIndex(i, true, true, null, true));\n        }\n      }\n    }\n\n    return rows;\n  };\n\n  GroupLazyLoadRenderer.prototype.scrollHandler = function (e) {\n    if (this.parent.isDestroyed || this.childCount) {\n      return;\n    }\n\n    var downTrs = [].slice.call(this.parent.getContent().getElementsByClassName('e-lazyload-middle-down'));\n    var upTrs = [].slice.call(this.parent.getContent().getElementsByClassName('e-lazyload-middle-up'));\n    var endTrs = [].slice.call(this.parent.getContent().getElementsByClassName('e-not-lazyload-end'));\n    var tr;\n    var lazyLoadDown = false;\n    var lazyLoadUp = false;\n    var lazyLoadEnd = false;\n\n    if (e.scrollDown && downTrs.length) {\n      var result = this.findRowElements(downTrs);\n      tr = result.tr;\n      lazyLoadDown = result.entered;\n    }\n\n    if (!e.scrollDown && endTrs) {\n      for (var i = 0; i < endTrs.length; i++) {\n        var top_1 = endTrs[i].getBoundingClientRect().top;\n        var scrollHeight = this.parent.getContent().scrollHeight;\n\n        if (top_1 > 0 && top_1 < scrollHeight) {\n          tr = endTrs[i];\n          lazyLoadEnd = true;\n          this.rowIndex = tr.rowIndex;\n          break;\n        }\n      }\n    }\n\n    if (!e.scrollDown && upTrs.length && !lazyLoadEnd) {\n      var result = this.findRowElements(upTrs);\n      tr = result.tr;\n      lazyLoadUp = result.entered;\n    }\n\n    if (tr) {\n      if (lazyLoadDown && e.scrollDown && lazyLoadDown && tr) {\n        this.scrollDownHandler(tr);\n      }\n\n      if (!e.scrollDown && lazyLoadEnd && tr) {\n        this.scrollUpEndRowHandler(tr);\n      }\n\n      if (this.cacheMode && !e.scrollDown && !lazyLoadEnd && lazyLoadUp && tr) {\n        this.scrollUpHandler(tr);\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.scrollUpEndRowHandler = function (tr) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n    var uid = tr.getAttribute('data-uid');\n    var index = this.rowObjectIndex = this.getRowObjectIndexByUid(uid);\n    var idx = index;\n    var childRow = rows[index];\n    var parentCapRow = this.getRowByUid(childRow.parentUid);\n    var capRowObjIdx = this.getRowObjectIndexByUid(parentCapRow.uid);\n    var captionRowEle = this.parent.getContent().querySelector('tr[data-uid=' + parentCapRow.uid + ']');\n    var capRowEleIndex = captionRowEle.rowIndex;\n    var child = this.getChildRowsByParentIndex(capRowObjIdx);\n    var childIdx = child.indexOf(childRow);\n    var currentPage = Math.ceil(childIdx / this.pageSize);\n\n    if (currentPage === 1) {\n      return;\n    }\n\n    this.childCount = currentPage * this.pageSize;\n    index = this.getCurrentBlockEndIndex(childRow, index);\n\n    if (this.childCount < parentCapRow.data.count) {\n      tr.classList.remove('e-not-lazyload-end');\n      childRow.lazyLoadCssClass = '';\n      var isRowExist = rows[index + 1] ? childRow.indent === rows[index + 1].indent : false;\n      this.scrollData = isRowExist ? this.getCacheRowsOnDownScroll(index + 1) : [];\n      var key = this.getGroupKeysAndFields(capRowObjIdx, rows);\n      var args = {\n        rowIndex: capRowEleIndex,\n        makeRequest: !isRowExist,\n        groupInfo: parentCapRow,\n        fields: key.fields,\n        keys: key.keys,\n        skip: this.childCount,\n        take: this.pageSize,\n        isScroll: true\n      };\n\n      if (this.cacheMode && this.childCount >= this.pageSize * this.cacheBlockSize) {\n        var child_1 = this.getChildRowsByParentIndex(capRowObjIdx);\n        var currenBlock = Math.ceil(child_1.indexOf(rows[idx]) / this.pageSize);\n        var removeBlock = currenBlock - (this.cacheBlockSize - 1);\n        this.removeBlock(uid, isRowExist, removeBlock, child_1);\n        args.cachedRowIndex = removeBlock * this.pageSize;\n      }\n\n      this.captionRowExpand(args);\n    } else {\n      this.childCount = 0;\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.scrollDownHandler = function (tr) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n    var uid = tr.getAttribute('data-uid');\n    var index = this.getRowObjectIndexByUid(uid);\n    var idx = index;\n    var childRow = rows[index];\n    var parentCapRow = this.getRowByUid(childRow.parentUid);\n    var capRowObjIdx = this.getRowObjectIndexByUid(parentCapRow.uid);\n    var captionRowEle = this.getRowElementByUid(parentCapRow.uid);\n    var capRowEleIndex = captionRowEle.rowIndex;\n    var child = this.getChildRowsByParentIndex(capRowObjIdx);\n    var childIdx = child.indexOf(childRow);\n    var currentPage = Math.ceil(childIdx / this.pageSize);\n    this.childCount = currentPage * this.pageSize;\n    index = this.rowObjectIndex = this.getRowObjectIndexByUid(child[this.childCount - 1].uid);\n    var lastchild = rows[index];\n    var lastRow = this.getRowElementByUid(lastchild.uid);\n    this.rowIndex = lastRow.rowIndex;\n    index = this.getCurrentBlockEndIndex(lastchild, index);\n\n    if (this.childCount < parentCapRow.data.count) {\n      var isRowExist = rows[index + 1] ? childRow.indent === rows[index + 1].indent : false;\n\n      if (isRowExist && !isNullOrUndefined(this.getRowElementByUid(rows[index + 1].uid))) {\n        this.childCount = 0;\n        return;\n      }\n\n      if (currentPage > 1 || !this.cacheMode) {\n        tr.classList.remove('e-lazyload-middle-down');\n        lastRow.classList.remove('e-not-lazyload-end');\n        lastchild.lazyLoadCssClass = '';\n      }\n\n      this.scrollData = isRowExist ? this.getCacheRowsOnDownScroll(this.rowObjectIndex + 1) : [];\n      var query = this.getGroupKeysAndFields(capRowObjIdx, rows);\n      var args = {\n        rowIndex: capRowEleIndex,\n        makeRequest: !isRowExist,\n        groupInfo: parentCapRow,\n        fields: query.fields,\n        keys: query.keys,\n        skip: this.childCount,\n        take: this.pageSize,\n        isScroll: true\n      };\n\n      if (this.cacheMode && this.childCount - this.pageSize >= this.pageSize * this.cacheBlockSize) {\n        var child_2 = this.getChildRowsByParentIndex(capRowObjIdx);\n        var currenBlock = Math.ceil(child_2.indexOf(rows[idx]) / this.pageSize) - 1;\n        var removeBlock = currenBlock - (this.cacheBlockSize - 1) + 1;\n        this.removeBlock(uid, isRowExist, removeBlock, child_2, lastchild);\n        args.cachedRowIndex = removeBlock * this.pageSize;\n      }\n\n      this.captionRowExpand(args);\n    } else {\n      this.childCount = 0;\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.getCurrentBlockEndIndex = function (row, index) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n\n    if (row.isCaptionRow) {\n      if (row.isExpand) {\n        var childCount = this.getChildRowsByParentIndex(index, true).length;\n        this.rowIndex = this.rowIndex + childCount;\n      }\n\n      var agg = this.getAggregateByCaptionIndex(index);\n      this.rowObjectIndex = this.rowObjectIndex + agg.length;\n      var idx = index;\n\n      for (var i = idx + 1; i < rows.length; i++) {\n        if (rows[i].indent === rows[index].indent || rows[i].indent < rows[index].indent) {\n          index = idx;\n          break;\n        } else {\n          idx++;\n        }\n      }\n    }\n\n    return index;\n  };\n\n  GroupLazyLoadRenderer.prototype.removeBlock = function (uid, isRowExist, removeBlock, child, lastchild) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n    var uid1 = child[(removeBlock + 1) * this.pageSize - 1 - this.blockSize].uid;\n    var uid2 = child[removeBlock * this.pageSize - this.pageSize].uid;\n    var uid3 = child[removeBlock * this.pageSize].uid;\n    var firstIdx = this.getRowObjectIndexByUid(uid1);\n    rows[firstIdx].lazyLoadCssClass = 'e-lazyload-middle-up';\n    this.getRowElementByUid(uid1).classList.add('e-lazyload-middle-up');\n\n    if (lastchild) {\n      this.getRowElementByUid(uid3).classList.add('e-not-lazyload-first');\n      this.getRowByUid(uid3).lazyLoadCssClass = 'e-not-lazyload-first';\n      this.getRowByUid(uid2).lazyLoadCssClass = '';\n    }\n\n    if (isRowExist) {\n      this.removeTopRows(lastchild ? lastchild.uid : uid, uid2, uid3);\n    } else {\n      this.uid1 = uid2;\n      this.uid2 = uid3;\n      this.uid3 = lastchild ? lastchild.uid : uid;\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.scrollUpHandler = function (tr) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n    var uid = tr.getAttribute('data-uid');\n    var row = this.getRowByUid(uid);\n    var index = this.rowObjectIndex = this.getRowObjectIndexByUid(uid);\n    var parentCapRow = this.getRowByUid(row.parentUid);\n    var capRowObjIdx = this.rowIndex = this.getRowObjectIndexByUid(parentCapRow.uid);\n    var captionRowEle = this.parent.getRowElementByUID(parentCapRow.uid);\n    var capRowEleIndex = captionRowEle.rowIndex;\n    var child = this.getChildRowsByParentIndex(capRowObjIdx);\n    var childIdx = child.indexOf(rows[index]);\n    var currenBlock = Math.floor(childIdx / this.pageSize);\n    var idx = this.blockSize;\n\n    if (this.blockSize * 2 > this.pageSize) {\n      idx = this.blockSize * 2 - this.pageSize;\n      idx = this.blockSize - idx;\n    }\n\n    var start = child[childIdx - (idx - 1) - this.pageSize].uid;\n    var end = child[childIdx - (idx - 1)].uid;\n    this.scrollData = this.getCacheRowsOnUpScroll(start, end, index - (idx - 1));\n    this.isFirstChildRow = currenBlock > 1;\n\n    if (this.isFirstChildRow) {\n      this.scrollData[0].lazyLoadCssClass = 'e-not-lazyload-first';\n    }\n\n    this.getRowByUid(end).lazyLoadCssClass = '';\n    this.getRowElementByUid(end).classList.remove('e-not-lazyload-first');\n    var removeBlock = currenBlock + this.cacheBlockSize;\n\n    if (child.length !== parentCapRow.data.count && removeBlock * this.pageSize > child.length) {\n      this.isFirstChildRow = false;\n      this.scrollData[0].lazyLoadCssClass = '';\n      this.getRowElementByUid(end).classList.add('e-not-lazyload-first');\n      return;\n    }\n\n    var count = removeBlock * this.pageSize > parentCapRow.data.count ? parentCapRow.data.count : removeBlock * this.pageSize;\n    var size = removeBlock * this.pageSize > parentCapRow.data.count ? this.pageSize - (this.pageSize * removeBlock - parentCapRow.data.count) : this.pageSize;\n    var childRows = this.getChildRowsByParentIndex(rows.indexOf(child[count - 1]), true, false, null, true);\n    var uid1 = childRows.length ? childRows[childRows.length - 1].uid : child[count - 1].uid;\n    var uid2 = child[count - size].uid;\n    var uid3 = child[count - size - 1].uid;\n    var lastIdx = this.objIdxByUid[page][uid2] - idx;\n\n    if (rows[lastIdx].lazyLoadCssClass === 'e-lazyload-middle-down') {\n      var trEle = this.getRowElementByUid(rows[lastIdx].uid);\n\n      if (trEle) {\n        trEle.classList.add('e-lazyload-middle-down');\n      }\n    }\n\n    this.getRowByUid(uid1).lazyLoadCssClass = '';\n    this.getRowByUid(uid3).lazyLoadCssClass = 'e-not-lazyload-end';\n    this.getRowElementByUid(uid3).classList.add('e-not-lazyload-end');\n    this.removeBottomRows(uid1, uid2, uid3);\n    this.rowIndex = tr.rowIndex - idx;\n\n    if (tr.classList.length > 1) {\n      tr.classList.remove('e-lazyload-middle-up');\n    } else {\n      tr.removeAttribute('class');\n    }\n\n    if (!isNullOrUndefined(this.getRowElementByUid(start))) {\n      this.childCount = 0;\n      this.scrollData = [];\n      return;\n    }\n\n    var key = this.getGroupKeysAndFields(this.getRowObjectIndexByUid(parentCapRow.uid), rows);\n    var args = {\n      rowIndex: capRowEleIndex,\n      makeRequest: false,\n      groupInfo: parentCapRow,\n      fields: key.fields,\n      keys: key.keys,\n      skip: this.childCount,\n      take: this.pageSize,\n      isScroll: true,\n      scrollUp: true\n    };\n    this.captionRowExpand(args);\n  };\n\n  GroupLazyLoadRenderer.prototype.findRowElements = function (rows) {\n    var entered = false;\n    var tr;\n\n    for (var i = 0; i < rows.length; i++) {\n      var rowIdx = rows[i].rowIndex;\n\n      if (isRowEnteredInGrid(rowIdx, this.parent)) {\n        entered = true;\n        this.rowIndex = rowIdx;\n        tr = rows[i];\n        break;\n      }\n    }\n\n    return {\n      entered: entered,\n      tr: tr\n    };\n  };\n\n  GroupLazyLoadRenderer.prototype.getRowElementByUid = function (uid) {\n    return this.parent.getContent().querySelector('tr[data-uid=' + uid + ']');\n  };\n\n  GroupLazyLoadRenderer.prototype.removeTopRows = function (uid1, uid2, uid3) {\n    var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n    var start = false;\n\n    for (var i = 0; i < trs.length; i++) {\n      if (trs[i].getAttribute('data-uid') === uid3) {\n        var tr = this.parent.getContent().querySelector('tr[data-uid=' + uid1 + ']');\n\n        if (tr) {\n          this.rowIndex = tr.rowIndex;\n        }\n\n        break;\n      }\n\n      if (trs[i].getAttribute('data-uid') === uid2) {\n        start = true;\n      }\n\n      if (start) {\n        remove(trs[i]);\n      }\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  GroupLazyLoadRenderer.prototype.removeBottomRows = function (uid1, uid2, uid3) {\n    var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n    var trigger = false;\n\n    for (var i = 0; i < trs.length; i++) {\n      if (trs[i].getAttribute('data-uid') === uid2) {\n        trigger = true;\n      }\n\n      if (trigger) {\n        remove(trs[i]);\n\n        if (trs[i].getAttribute('data-uid') === uid1) {\n          break;\n        }\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.setCache = function (e) {\n    var page = this.parent.pageSettings.currentPage;\n    this.groupCache[page] = this.initialGroupCaptions[page] = extend([], e.data);\n  };\n\n  GroupLazyLoadRenderer.prototype.getGroupKeysAndFields = function (index, rowsObject) {\n    var fields = [];\n    var keys = [];\n\n    for (var i = index; i >= 0; i--) {\n      if (rowsObject[i].isCaptionRow && fields.indexOf(rowsObject[i].data.field) === -1 && (rowsObject[i].indent < rowsObject[index].indent || i === index)) {\n        fields.push(rowsObject[i].data.field);\n        keys.push(rowsObject[i].data.key);\n\n        if (rowsObject[i].indent === 0) {\n          break;\n        }\n      }\n    }\n\n    return {\n      fields: fields,\n      keys: keys\n    };\n  };\n\n  GroupLazyLoadRenderer.prototype.generateExpandPredicates = function (fields, values) {\n    var filterCols = [];\n\n    for (var i = 0; i < fields.length; i++) {\n      var column = this.parent.getColumnByField(fields[i]);\n      var value = values[i] === 'null' ? null : values[i];\n      var pred = {\n        field: fields[i],\n        predicate: 'or',\n        uid: column.uid,\n        operator: 'equal',\n        type: column.type,\n        matchCase: this.allowCaseSensitive,\n        ignoreAccent: this.ignoreAccent\n      };\n\n      if (value === '' || isNullOrUndefined(value)) {\n        filterCols = filterCols.concat(CheckBoxFilterBase.generateNullValuePredicates(pred));\n      } else {\n        filterCols.push(extend({}, {\n          value: value\n        }, pred));\n      }\n    }\n\n    return CheckBoxFilterBase.getPredicate(filterCols);\n  };\n\n  GroupLazyLoadRenderer.prototype.getPredicates = function (pred) {\n    var predicateList = [];\n\n    for (var _i = 0, _a = Object.keys(pred); _i < _a.length; _i++) {\n      var prop = _a[_i];\n      predicateList.push(pred[prop]);\n    }\n\n    return predicateList;\n  };\n\n  GroupLazyLoadRenderer.prototype.captionRowExpand = function (args) {\n    var _this = this;\n\n    var captionRow = args.groupInfo;\n    var level = this.parent.groupSettings.columns.indexOf(captionRow.data.field) + 1;\n    var pred = this.generateExpandPredicates(args.fields, args.keys);\n    var predicateList = this.getPredicates(pred);\n    var lazyLoad = {\n      level: level,\n      skip: args.skip,\n      take: args.take,\n      where: predicateList\n    };\n\n    if (args.makeRequest) {\n      var query = this.parent.renderModule.data.generateQuery(true);\n\n      if (!query.isCountRequired) {\n        query.isCountRequired = true;\n      }\n\n      query.lazyLoad.push({\n        key: 'onDemandGroupInfo',\n        value: lazyLoad\n      });\n      this.parent.showSpinner();\n      this.parent.renderModule.data.getData({}, query).then(function (e) {\n        _this.parent.hideSpinner();\n\n        if (e.result.length === 0) {\n          return;\n        }\n\n        if (_this.cacheMode && _this.uid1 && _this.uid2) {\n          _this.removeTopRows(_this.uid3, _this.uid1, _this.uid2);\n\n          _this.uid1 = _this.uid2 = _this.uid3 = undefined;\n        }\n\n        _this.lazyLoadHandler({\n          data: e.result,\n          count: e.count,\n          level: level,\n          index: args.rowIndex,\n          isRowExist: false,\n          isScroll: args.isScroll,\n          up: false,\n          rowIndex: args.cachedRowIndex\n        });\n      }).catch(function (e) {\n        return _this.parent.renderModule.dataManagerFailure(e, {\n          requestType: 'grouping'\n        });\n      });\n    } else {\n      this.lazyLoadHandler({\n        data: null,\n        count: args.groupInfo.data.count,\n        level: level,\n        index: args.rowIndex,\n        isRowExist: true,\n        isScroll: args.isScroll,\n        up: args.scrollUp,\n        rowIndex: args.cachedRowIndex\n      });\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.scrollReset = function (top) {\n    this.parent.getContent().firstElementChild.scrollTop = top ? this.parent.getContent().firstElementChild.scrollTop + top : 0;\n  };\n\n  GroupLazyLoadRenderer.prototype.updateCurrentViewData = function () {\n    var records = [];\n    this.getRows().filter(function (row) {\n      if (row.isDataRow) {\n        records[row.index] = row.data;\n      }\n    });\n    this.parent.currentViewData = records.length ? records : this.parent.currentViewData;\n  };\n  /**\n   * @returns {Row<Column>[]} returns the row\n   * @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.getGroupCache = function () {\n    return this.groupCache;\n  };\n  /**\n   * @returns {Row<Column>[]} returns the row\n   * @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.getRows = function () {\n    return this.groupCache[this.parent.pageSettings.currentPage] || [];\n  };\n  /**\n   * @returns {Element} returns the element\n   * @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.getRowElements = function () {\n    return [].slice.call(this.parent.getContent().getElementsByClassName(literals.row));\n  };\n  /**\n   * @param {number} index - specifies the index\n   * @returns {Element} returns the element\n   * @hidden\n   */\n\n\n  GroupLazyLoadRenderer.prototype.getRowByIndex = function (index) {\n    var tr = [].slice.call(this.parent.getContent().getElementsByClassName(literals.row));\n    var row;\n\n    for (var i = 0; !isNullOrUndefined(index) && i < tr.length; i++) {\n      if (tr[i].getAttribute(literals.ariaRowIndex) === index.toString()) {\n        row = tr[i];\n        break;\n      }\n    }\n\n    return row;\n  };\n  /**\n   * Tucntion to set the column visibility\n   *\n   * @param {Column[]} columns - specifies the column\n   * @returns {void}\n   * @hidden\n   */\n\n\n  GroupLazyLoadRenderer.prototype.setVisible = function (columns) {\n    var gObj = this.parent;\n    var rows = this.getRows();\n    var testRow;\n    rows.some(function (r) {\n      if (r.isDataRow) {\n        testRow = r;\n      }\n\n      return r.isDataRow;\n    });\n    var contentrows = this.getRows().filter(function (row) {\n      return !row.isDetailRow;\n    });\n\n    for (var i = 0; i < columns.length; i++) {\n      var column = columns[i];\n      var idx = this.parent.getNormalizedColumnIndex(column.uid);\n      var colIdx = this.parent.getColumnIndexByUid(column.uid);\n      var displayVal = column.visible === true ? '' : 'none';\n\n      if (idx !== -1 && testRow && idx < testRow.cells.length) {\n        setStyleAttribute(this.getColGroup().childNodes[idx], {\n          'display': displayVal\n        });\n      }\n\n      this.setDisplayNone(gObj.getDataRows(), colIdx, displayVal, contentrows, idx);\n\n      if (!this.parent.invokedFromMedia && column.hideAtMedia) {\n        this.parent.updateMediaColumns(column);\n      }\n\n      this.parent.invokedFromMedia = false;\n    }\n  };\n  /**\n   * Function to set display.\n   *\n   * @param {Object} tr - specifies the row object\n   * @param {number} idx - specifies the index\n   * @param {string} displayVal - specifies the display value\n   * @param {Row<Column>[]} rows - specifies the array of rows\n   * @param {number} oriIdx - specifies the index\n   * @returns {void}\n   * @hidden\n   */\n\n\n  GroupLazyLoadRenderer.prototype.setDisplayNone = function (tr, idx, displayVal, rows, oriIdx) {\n    if (!this.parent.groupSettings.columns.length) {\n      setDisplayValue(tr, idx, displayVal, rows);\n    } else {\n      var keys = Object.keys(this.groupCache);\n\n      for (var j = 0; j < keys.length; j++) {\n        var uids = this.rowsByUid[keys[j]];\n        var idxs = Object.keys(uids);\n\n        for (var i = 0; i < idxs.length; i++) {\n          var tr_1 = this.parent.getContent().querySelector('tr[data-uid=' + idxs[i] + ']');\n          var row = uids[idxs[i]];\n\n          if (row.isCaptionRow) {\n            if (!this.captionModelGen.isEmpty()) {\n              this.changeCaptionRow(row, tr_1, keys[j]);\n            } else {\n              row.cells[row.indent + 1].colSpan = displayVal === '' ? row.cells[row.indent + 1].colSpan + 1 : row.cells[row.indent + 1].colSpan - 1;\n\n              if (tr_1) {\n                tr_1.cells[row.indent + 1].colSpan = row.cells[row.indent + 1].colSpan;\n              }\n            }\n          }\n\n          if (row.isDataRow) {\n            this.showAndHideCells(tr_1, idx, displayVal, false);\n            row.cells[oriIdx].visible = displayVal === '' ? true : false;\n          }\n\n          if (!row.isCaptionRow && !row.isDataRow && isNullOrUndefined(row.indent)) {\n            row.cells[oriIdx].visible = displayVal === '' ? true : false;\n            row.visible = row.cells.some(function (cell) {\n              return cell.isDataCell && cell.visible;\n            });\n            this.showAndHideCells(tr_1, idx, displayVal, true, row);\n          }\n        }\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.changeCaptionRow = function (row, tr, index) {\n    var capRow = row;\n    var captionData = row.data;\n    var data = this.groupGenerator.generateCaptionRow(captionData, capRow.indent, capRow.parentGid, undefined, capRow.tIndex, capRow.parentUid);\n    data.uid = row.uid;\n    data.isExpand = row.isExpand;\n    data.lazyLoadCssClass = row.lazyLoadCssClass;\n    this.rowsByUid[index][row.uid] = data;\n    this.groupCache[index][this.objIdxByUid[index][row.uid]] = data;\n\n    if (tr) {\n      var tbody = this.parent.getContentTable().querySelector(literals.tbody);\n      tbody.replaceChild(this.rowRenderer.render(data, this.parent.getColumns()), tr);\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.showAndHideCells = function (tr, idx, displayVal, isSummary, row) {\n    if (tr) {\n      var cls = isSummary ? 'td.e-summarycell' : 'td.e-rowcell';\n      setStyleAttribute(tr.querySelectorAll(cls)[idx], {\n        'display': displayVal\n      });\n\n      if (tr.querySelectorAll(cls)[idx].classList.contains('e-hide')) {\n        removeClass([tr.querySelectorAll(cls)[idx]], ['e-hide']);\n      }\n\n      if (isSummary) {\n        if (row.visible && tr.classList.contains('e-hide')) {\n          removeClass([tr], ['e-hide']);\n        } else if (!row.visible) {\n          addClass([tr], ['e-hide']);\n        }\n      }\n    }\n  };\n\n  return GroupLazyLoadRenderer;\n}(ContentRender);\n\nexport { GroupLazyLoadRenderer };","map":{"version":3,"sources":["/Users/zhouzhou/Desktop/lightfront/node_modules/@syncfusion/ej2-grids/src/grid/renderer/group-lazy-load-renderer.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","extend","remove","isNullOrUndefined","setStyleAttribute","removeClass","addClass","ContentRender","events","isRowEnteredInGrid","parentsUntil","setDisplayValue","RowRenderer","CheckBoxFilterBase","GroupModelGenerator","GroupSummaryModelGenerator","CaptionSummaryModelGenerator","literals","GroupLazyLoadRenderer","_super","parent","locator","_this","call","childCount","scrollData","isFirstChildRow","groupCache","startIndexes","captionCounts","rowsByUid","objIdxByUid","initialGroupCaptions","requestType","cacheMode","cacheBlockSize","ignoreAccent","allowFiltering","filterSettings","allowCaseSensitive","groupGenerator","summaryModelGen","captionModelGen","rowRenderer","eventListener","addEventListener","actionBegin","bind","actionComplete","on","initialEnd","setLazyLoadPageSize","setGroupCache","setCache","lazyLoadScrollHandler","scrollHandler","columnVisibilityChanged","setVisible","groupCollapse","collapseShortcut","captionExpand","tr","page","pageSettings","currentPage","rowsObject","uid","getAttribute","oriIndex","getRowObjectIndexByUid","isRowExist","indent","data","key","getGroupKeysAndFields","e","captionRowElement","groupInfo","enableCaching","cancel","trigger","lazyLoadGroupExpand","args","keys","fields","rowIndex","makeRequest","clearCache","skip","take","pageSize","isExpand","captionRowExpand","captionCollapse","cache","rowIdx","captionIndex","lazyLoadGroupCollapse","removeRows","scrollEle","getContent","firstElementChild","blockSize","Math","floor","offsetHeight","getRowHeight","ceil","clearLazyGroupCache","uids","getInitialCaptionIndexes","length","i","capIdx","capRow","i_1","isCaptionRow","getRowElementByUID","groupModule","expandCollapseRows","querySelector","child","getNextChilds","subChild","getChildRowsByParentIndex","indexOf","start","end","splice","refreshCaches","maintainRows","push","groupSettings","columns","target","content","parentElement","tagName","collapse","row","rowObj","getRowByUid","parentUid","capEle","getRowElementByUid","cells","some","value","resetRowMaintenance","j","isEmpty","changeCaptionRow","isDataRow","from","fromIndex","to","toIndex","moveCells","action","scrollReset","arr","k","undefined","idx","trIdx","rows","trs","slice","querySelectorAll","aggUid","aggregates","agg","getAggregateByCaptionIndex","capUid","last","lazyLoadCssClass","index","rowObjects","group","childRows","lazyLoadHandler","setStartIndexes","captionRow","isScroll","setRowIndexes","refreshCaptionRowCount","count","generateCaptionRow","level","parentGid","concat","generateRows","getStartIndex","generateDataRows","nxtChild","lastRow","up","hasLastChildRow","refreshRowObjects","rowObjectIndex","render","scrollTop","prevCapRow","prevCaptionCount","indexes","captionCount","rowCount","insertAdjacentElement","getColumns","confirmRowRendering","check","cap","newRows","newRowsObject","updateCurrentViewData","deep","block","includeAgg","includeCollapseAgg","parentRow","initialGroupRows","isReorder","getRenderedRowsObject","getCacheRowsOnDownScroll","getCacheRowsOnUpScroll","str","isDestroyed","downTrs","getElementsByClassName","upTrs","endTrs","lazyLoadDown","lazyLoadUp","lazyLoadEnd","scrollDown","result","findRowElements","entered","top_1","getBoundingClientRect","top","scrollHeight","scrollDownHandler","scrollUpEndRowHandler","scrollUpHandler","childRow","parentCapRow","capRowObjIdx","captionRowEle","capRowEleIndex","childIdx","getCurrentBlockEndIndex","classList","child_1","currenBlock","removeBlock","cachedRowIndex","lastchild","query","child_2","uid1","uid2","uid3","firstIdx","add","removeTopRows","size","lastIdx","trEle","removeBottomRows","removeAttribute","scrollUp","field","generateExpandPredicates","values","filterCols","column","getColumnByField","pred","predicate","operator","type","matchCase","generateNullValuePredicates","getPredicate","getPredicates","predicateList","_i","_a","prop","lazyLoad","where","renderModule","generateQuery","isCountRequired","showSpinner","getData","then","hideSpinner","catch","dataManagerFailure","records","getRows","filter","currentViewData","getGroupCache","getRowElements","getRowByIndex","ariaRowIndex","toString","gObj","testRow","r","contentrows","isDetailRow","getNormalizedColumnIndex","colIdx","getColumnIndexByUid","displayVal","visible","getColGroup","childNodes","setDisplayNone","getDataRows","invokedFromMedia","hideAtMedia","updateMediaColumns","oriIdx","idxs","tr_1","colSpan","showAndHideCells","cell","isDataCell","captionData","tIndex","tbody","getContentTable","replaceChild","isSummary","cls","contains"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { extend, remove, isNullOrUndefined, setStyleAttribute, removeClass, addClass } from '@syncfusion/ej2-base';\nimport { ContentRender } from './content-renderer';\nimport * as events from '../base/constant';\nimport { isRowEnteredInGrid, parentsUntil, setDisplayValue } from '../base/util';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { CheckBoxFilterBase } from '../common/checkbox-filter-base';\nimport { GroupModelGenerator } from '../services/group-model-generator';\nimport { GroupSummaryModelGenerator, CaptionSummaryModelGenerator } from '../services/summary-model-generator';\nimport * as literals from '../base/string-literals';\n/**\n * GroupLazyLoadRenderer is used to perform lazy load grouping\n *\n * @hidden\n */\nvar GroupLazyLoadRenderer = /** @class */ (function (_super) {\n    __extends(GroupLazyLoadRenderer, _super);\n    function GroupLazyLoadRenderer(parent, locator) {\n        var _this = _super.call(this, parent, locator) || this;\n        _this.childCount = 0;\n        _this.scrollData = [];\n        _this.isFirstChildRow = false;\n        _this.groupCache = {};\n        _this.startIndexes = {};\n        _this.captionCounts = {};\n        _this.rowsByUid = {};\n        _this.objIdxByUid = {};\n        _this.initialGroupCaptions = {};\n        _this.requestType = ['paging', 'columnstate', 'reorder', 'cancel', 'save', 'beginEdit', 'add', 'delete'];\n        /** @hidden */\n        _this.cacheMode = false;\n        /** @hidden */\n        _this.cacheBlockSize = 5;\n        /** @hidden */\n        _this.ignoreAccent = _this.parent.allowFiltering ? _this.parent.filterSettings.ignoreAccent : false;\n        /** @hidden */\n        _this.allowCaseSensitive = false;\n        _this.locator = locator;\n        _this.groupGenerator = new GroupModelGenerator(_this.parent);\n        _this.summaryModelGen = new GroupSummaryModelGenerator(_this.parent);\n        _this.captionModelGen = new CaptionSummaryModelGenerator(_this.parent);\n        _this.rowRenderer = new RowRenderer(_this.locator, null, _this.parent);\n        _this.eventListener();\n        return _this;\n    }\n    GroupLazyLoadRenderer.prototype.eventListener = function () {\n        this.parent.addEventListener(events.actionBegin, this.actionBegin.bind(this));\n        this.parent.addEventListener(events.actionComplete, this.actionComplete.bind(this));\n        this.parent.on(events.initialEnd, this.setLazyLoadPageSize, this);\n        this.parent.on(events.setGroupCache, this.setCache, this);\n        this.parent.on(events.lazyLoadScrollHandler, this.scrollHandler, this);\n        this.parent.on(events.columnVisibilityChanged, this.setVisible, this);\n        this.parent.on(events.groupCollapse, this.collapseShortcut, this);\n    };\n    /**\n     * @param {HTMLTableRowElement} tr - specifies the table row element\n     * @returns {void}\n     * @hidden\n     */\n    GroupLazyLoadRenderer.prototype.captionExpand = function (tr) {\n        var _this = this;\n        var page = this.parent.pageSettings.currentPage;\n        var rowsObject = this.groupCache[page];\n        var uid = tr.getAttribute('data-uid');\n        var oriIndex = this.getRowObjectIndexByUid(uid);\n        var isRowExist = rowsObject[oriIndex + 1] ? rowsObject[oriIndex].indent < rowsObject[oriIndex + 1].indent : false;\n        var data = rowsObject[oriIndex];\n        var key = this.getGroupKeysAndFields(oriIndex, rowsObject);\n        var e = { captionRowElement: tr, groupInfo: data, enableCaching: true, cancel: false };\n        this.parent.trigger(events.lazyLoadGroupExpand, e, function (args) {\n            if (args.cancel) {\n                return;\n            }\n            args.keys = key.keys;\n            args.fields = key.fields;\n            args.rowIndex = tr.rowIndex;\n            args.makeRequest = !args.enableCaching || !isRowExist;\n            if (!args.enableCaching && isRowExist) {\n                _this.clearCache([uid]);\n            }\n            args.skip = 0;\n            args.take = _this.pageSize;\n            data.isExpand = _this.rowsByUid[page][data.uid].isExpand = true;\n            _this.captionRowExpand(args);\n        });\n    };\n    /**\n     * @param {HTMLTableRowElement} tr - specifies the table row element\n     * @returns {void}\n     * @hidden\n     */\n    GroupLazyLoadRenderer.prototype.captionCollapse = function (tr) {\n        var _this = this;\n        var cache = this.groupCache[this.parent.pageSettings.currentPage];\n        var rowIdx = tr.rowIndex;\n        var uid = tr.getAttribute('data-uid');\n        var captionIndex = this.getRowObjectIndexByUid(uid);\n        var e = {\n            captionRowElement: tr, groupInfo: cache[captionIndex], cancel: false\n        };\n        this.parent.trigger(events.lazyLoadGroupCollapse, e, function (args) {\n            if (args.cancel) {\n                return;\n            }\n            args.isExpand = false;\n            _this.removeRows(captionIndex, rowIdx);\n        });\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    GroupLazyLoadRenderer.prototype.setLazyLoadPageSize = function () {\n        var scrollEle = this.parent.getContent().firstElementChild;\n        var blockSize = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n        this.pageSize = this.pageSize ? this.pageSize : blockSize * 3;\n        this.blockSize = Math.ceil(this.pageSize / 2);\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    GroupLazyLoadRenderer.prototype.clearLazyGroupCache = function () {\n        this.clearCache();\n    };\n    GroupLazyLoadRenderer.prototype.clearCache = function (uids) {\n        uids = uids ? uids : this.getInitialCaptionIndexes();\n        var cache = this.groupCache[this.parent.pageSettings.currentPage];\n        if (uids.length) {\n            for (var i = 0; i < uids.length; i++) {\n                var capIdx = this.getRowObjectIndexByUid(uids[i]);\n                var capRow = cache[capIdx];\n                if (!capRow) {\n                    continue;\n                }\n                if (this.captionCounts[this.parent.pageSettings.currentPage][capRow.uid]) {\n                    for (var i_1 = capIdx + 1; i_1 < cache.length; i_1++) {\n                        if (cache[i_1].indent === capRow.indent || cache[i_1].indent < capRow.indent) {\n                            delete this.captionCounts[this.parent.pageSettings.currentPage][capRow.uid];\n                            break;\n                        }\n                        if (cache[i_1].isCaptionRow) {\n                            delete this.captionCounts[this.parent.pageSettings.currentPage][cache[i_1].uid];\n                        }\n                    }\n                }\n                if (capRow.isExpand) {\n                    var tr = this.parent.getRowElementByUID(capRow.uid);\n                    if (!tr) {\n                        return;\n                    }\n                    this.parent.groupModule.expandCollapseRows(tr.querySelector('.e-recordplusexpand'));\n                }\n                var child = this.getNextChilds(capIdx);\n                if (!child.length) {\n                    continue;\n                }\n                var subChild = [];\n                if (child[child.length - 1].isCaptionRow) {\n                    subChild = this.getChildRowsByParentIndex(cache.indexOf(child[child.length - 1]), false, false, null, true, true);\n                }\n                var start = cache.indexOf(child[0]);\n                var end = subChild.length ? cache.indexOf(subChild[subChild.length - 1]) : cache.indexOf(child[child.length - 1]);\n                cache.splice(start, end - (start - 1));\n                this.refreshCaches();\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.refreshCaches = function () {\n        var page = this.parent.pageSettings.currentPage;\n        var cache = this.groupCache[page];\n        this.rowsByUid = {};\n        this.objIdxByUid = {};\n        for (var i = 0; i < cache.length; i++) {\n            this.maintainRows(cache[i], i);\n        }\n    };\n    GroupLazyLoadRenderer.prototype.getInitialCaptionIndexes = function () {\n        var page = this.parent.pageSettings.currentPage;\n        var uids = [];\n        for (var i = 0; i < this.initialGroupCaptions[page].length; i++) {\n            uids.push(this.initialGroupCaptions[page][i].uid);\n        }\n        return uids;\n    };\n    /**\n     * @param {string} uid - specifies the uid\n     * @returns {number} returns the row object uid\n     * @hidden\n     */\n    GroupLazyLoadRenderer.prototype.getRowObjectIndexByUid = function (uid) {\n        return this.objIdxByUid[this.parent.pageSettings.currentPage][uid];\n    };\n    GroupLazyLoadRenderer.prototype.collapseShortcut = function (args) {\n        if (this.parent.groupSettings.columns.length &&\n            args.target && parentsUntil(args.target, literals.content) && args.target.parentElement.tagName === 'TR') {\n            if (!args.collapse && parentsUntil(args.target, literals.row)) {\n                return;\n            }\n            var row = args.target.parentElement;\n            var uid = row.getAttribute('data-uid');\n            if (args.collapse) {\n                var rowObj = this.getRowByUid(uid);\n                var capRow = this.getRowByUid(rowObj.parentUid);\n                if (capRow.isCaptionRow && capRow.isExpand) {\n                    var capEle = this.getRowElementByUid(rowObj.parentUid);\n                    this.parent.groupModule.expandCollapseRows(capEle.cells[rowObj.indent - 1]);\n                }\n            }\n            else {\n                var capRow = this.getRowByUid(uid);\n                if (capRow.isCaptionRow && !capRow.isExpand) {\n                    var capEle = this.getRowElementByUid(uid);\n                    this.parent.groupModule.expandCollapseRows(capEle.cells[capRow.indent]);\n                }\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.getRowByUid = function (uid) {\n        return this.rowsByUid[this.parent.pageSettings.currentPage][uid];\n    };\n    GroupLazyLoadRenderer.prototype.actionBegin = function (args) {\n        if (!args.cancel) {\n            if (!this.requestType.some(function (value) { return value === args.requestType; })) {\n                this.groupCache = {};\n                this.resetRowMaintenance();\n            }\n            if (args.requestType === 'reorder' && this.parent.groupSettings.columns.length) {\n                var keys = Object.keys(this.groupCache);\n                for (var j = 0; j < keys.length; j++) {\n                    var cache = this.groupCache[keys[j]];\n                    for (var i = 0; i < cache.length; i++) {\n                        if (cache[i].isCaptionRow && !this.captionModelGen.isEmpty()) {\n                            this.changeCaptionRow(cache[i], null, keys[j]);\n                        }\n                        if (cache[i].isDataRow) {\n                            var from = args.fromIndex + cache[i].indent;\n                            var to = args.toIndex + cache[i].indent;\n                            this.moveCells(cache[i].cells, from, to);\n                        }\n                    }\n                }\n            }\n            if (args.requestType === 'delete'\n                || (args.action === 'add' && args.requestType === 'save')) {\n                this.groupCache = {};\n                this.resetRowMaintenance();\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.actionComplete = function (args) {\n        if (!args.cancel && args.requestType !== 'columnstate' && args.requestType !== 'beginEdit'\n            && args.requestType !== 'delete' && args.requestType !== 'save' && args.requestType !== 'reorder') {\n            this.scrollReset();\n        }\n    };\n    GroupLazyLoadRenderer.prototype.resetRowMaintenance = function () {\n        this.startIndexes = {};\n        this.captionCounts = {};\n        this.rowsByUid = {};\n        this.objIdxByUid = {};\n        this.initialGroupCaptions = {};\n    };\n    GroupLazyLoadRenderer.prototype.moveCells = function (arr, from, to) {\n        if (from >= arr.length) {\n            var k = from - arr.length;\n            while ((k--) + 1) {\n                arr.push(undefined);\n            }\n        }\n        arr.splice(from, 0, arr.splice(to, 1)[0]);\n    };\n    GroupLazyLoadRenderer.prototype.removeRows = function (idx, trIdx) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n        var aggUid;\n        if (this.parent.aggregates.length) {\n            var agg = this.getAggregateByCaptionIndex(idx);\n            aggUid = agg.length ? agg[agg.length - 1].uid : undefined;\n        }\n        var indent = rows[idx].indent;\n        this.addClass(this.getNextChilds(idx));\n        rows[idx].isExpand = this.rowsByUid[page][rows[idx].uid].isExpand = false;\n        var capUid;\n        for (var i = idx + 1; i < rows.length; i++) {\n            if (rows[i].indent === indent || rows[i].indent < indent) {\n                capUid = rows[i].uid;\n                break;\n            }\n            if (rows[i].isCaptionRow && rows[i].isExpand) {\n                this.addClass(this.getNextChilds(i));\n            }\n        }\n        for (var i = trIdx + 1; i < trs.length; i++) {\n            if (trs[i].getAttribute('data-uid') === capUid) {\n                break;\n            }\n            else if (trs[i].getAttribute('data-uid') === aggUid) {\n                remove(trs[i]);\n                break;\n            }\n            else {\n                remove(trs[i]);\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.addClass = function (rows) {\n        var last = rows[this.blockSize];\n        if (last) {\n            last.lazyLoadCssClass = 'e-lazyload-middle-down';\n        }\n    };\n    GroupLazyLoadRenderer.prototype.getNextChilds = function (index, rowObjects) {\n        var group = this.groupCache[this.parent.pageSettings.currentPage];\n        var rows = rowObjects ? rowObjects : group;\n        var indent = group[index].indent + 1;\n        var childRows = [];\n        for (var i = rowObjects ? 0 : index + 1; i < rows.length; i++) {\n            if (rows[i].indent < indent) {\n                break;\n            }\n            if (rows[i].indent === indent) {\n                childRows.push(rows[i]);\n            }\n        }\n        return childRows;\n    };\n    GroupLazyLoadRenderer.prototype.lazyLoadHandler = function (args) {\n        this.setStartIndexes();\n        var tr = this.parent.getContent().querySelectorAll('tr')[args.index];\n        var uid = tr.getAttribute('data-uid');\n        var captionIndex = this.getRowObjectIndexByUid(uid);\n        var captionRow = this.groupCache[this.parent.pageSettings.currentPage][captionIndex];\n        var rows = args.isRowExist ? args.isScroll ? this.scrollData\n            : this.getChildRowsByParentIndex(captionIndex, true, true, null, true) : [];\n        this.scrollData = [];\n        if (!args.isRowExist) {\n            this.setRowIndexes(captionIndex, captionRow);\n            this.refreshCaptionRowCount(this.groupCache[this.parent.pageSettings.currentPage][captionIndex], args.count);\n            if (Object.keys(args.data).indexOf('GroupGuid') !== -1) {\n                for (var i = 0; i < args.data.length; i++) {\n                    var data = this.groupGenerator.generateCaptionRow(args.data[i], args.level, captionRow.parentGid, undefined, 0, captionRow.uid);\n                    rows.push(data);\n                    if (this.parent.aggregates.length) {\n                        rows = rows.concat((this.summaryModelGen.generateRows(args.data[i], { level: args.level + 1, parentUid: data.uid })));\n                    }\n                }\n            }\n            else {\n                this.groupGenerator.index = this.getStartIndex(captionIndex, args.isScroll);\n                rows = this.groupGenerator.generateDataRows(args.data, args.level, captionRow.parentGid, 0, captionRow.uid);\n            }\n        }\n        var trIdx = args.isScroll ? this.rowIndex : args.index;\n        var nxtChild = this.getNextChilds(captionIndex, rows);\n        var lastRow = !args.up ? this.hasLastChildRow(args.isScroll, args.count, nxtChild.length) : true;\n        if (!args.isRowExist && !lastRow) {\n            nxtChild[this.blockSize].lazyLoadCssClass = 'e-lazyload-middle-down';\n        }\n        if (!lastRow) {\n            nxtChild[nxtChild.length - 1].lazyLoadCssClass = 'e-not-lazyload-end';\n        }\n        var aggregates = !args.isScroll && !args.isRowExist ? this.getAggregateByCaptionIndex(captionIndex) : [];\n        if (!args.up) {\n            if (!args.isRowExist) {\n                this.refreshRowObjects(rows, args.isScroll ? this.rowObjectIndex : captionIndex);\n            }\n        }\n        this.render(trIdx, rows, lastRow, aggregates);\n        if (this.isFirstChildRow && !args.up) {\n            this.parent.getContent().firstElementChild.scrollTop = rows.length * this.parent.getRowHeight();\n        }\n        this.isFirstChildRow = false;\n        this.rowIndex = undefined;\n        this.rowObjectIndex = undefined;\n        this.childCount = 0;\n    };\n    GroupLazyLoadRenderer.prototype.setRowIndexes = function (capIdx, row) {\n        if (!this.captionCounts[this.parent.pageSettings.currentPage]) {\n            this.captionCounts[this.parent.pageSettings.currentPage] = {};\n        }\n        if (row.isCaptionRow) {\n            this.captionCounts[this.parent.pageSettings.currentPage][row.uid] = row.data.count;\n        }\n    };\n    GroupLazyLoadRenderer.prototype.getStartIndex = function (capIdx, isScroll) {\n        var page = this.parent.pageSettings.currentPage;\n        var cache = this.groupCache[page];\n        if (isScroll) {\n            return cache[this.rowObjectIndex].index + 1;\n        }\n        var count = 0;\n        var idx = 0;\n        var prevCapRow = this.getRowByUid(cache[capIdx].parentUid);\n        if (prevCapRow) {\n            idx = this.prevCaptionCount(prevCapRow);\n        }\n        if (cache[capIdx].indent > 0) {\n            for (var i = capIdx - 1; i >= 0; i--) {\n                if (cache[i].indent < cache[capIdx].indent) {\n                    break;\n                }\n                if (cache[i].isCaptionRow && cache[i].indent === cache[capIdx].indent) {\n                    count = count + cache[i].data.count;\n                }\n            }\n        }\n        var index = count + idx + this.startIndexes[page][cache[capIdx].parentGid];\n        return index;\n    };\n    GroupLazyLoadRenderer.prototype.prevCaptionCount = function (prevCapRow) {\n        var page = this.parent.pageSettings.currentPage;\n        var cache = this.groupCache[page];\n        var idx = 0;\n        for (var i = cache.indexOf(prevCapRow) - 1; i >= 0; i--) {\n            if (cache[i].indent === 0) {\n                break;\n            }\n            if (cache[i].indent < prevCapRow.indent) {\n                break;\n            }\n            if (cache[i].isCaptionRow && cache[i].indent === prevCapRow.indent) {\n                var count = this.captionCounts[page][cache[i].uid];\n                idx = idx + (count ? count : cache[i].data.count);\n            }\n        }\n        var capRow = this.getRowByUid(prevCapRow.parentUid);\n        if (capRow) {\n            idx = idx + this.prevCaptionCount(capRow);\n        }\n        return idx;\n    };\n    GroupLazyLoadRenderer.prototype.setStartIndexes = function () {\n        var cache = this.groupCache[this.parent.pageSettings.currentPage];\n        if (!this.startIndexes[this.parent.pageSettings.currentPage]) {\n            var indexes = [];\n            var idx = void 0;\n            for (var i = 0; i < cache.length; i++) {\n                if (cache[i].isCaptionRow) {\n                    if (!indexes.length) {\n                        indexes.push(0);\n                    }\n                    else {\n                        indexes.push(cache[idx].data.count + indexes[indexes.length - 1]);\n                    }\n                    idx = i;\n                }\n            }\n            this.startIndexes[this.parent.pageSettings.currentPage] = indexes;\n        }\n    };\n    GroupLazyLoadRenderer.prototype.hasLastChildRow = function (isScroll, captionCount, rowCount) {\n        return isScroll ? captionCount === this.childCount + rowCount : captionCount === rowCount;\n    };\n    GroupLazyLoadRenderer.prototype.refreshCaptionRowCount = function (row, count) {\n        row.data.count = count;\n    };\n    GroupLazyLoadRenderer.prototype.render = function (trIdx, rows, hasLastChildRow, aggregates) {\n        var tr = this.parent.getContent().querySelectorAll('tr')[trIdx];\n        if (tr && aggregates.length) {\n            for (var i = aggregates.length - 1; i >= 0; i--) {\n                tr.insertAdjacentElement('afterend', this.rowRenderer.render(aggregates[i], this.parent.getColumns()));\n            }\n        }\n        if (tr && rows.length) {\n            for (var i = rows.length - 1; i >= 0; i--) {\n                if (this.confirmRowRendering(rows[i])) {\n                    tr.insertAdjacentElement('afterend', this.rowRenderer.render(rows[i], this.parent.getColumns()));\n                }\n            }\n        }\n    };\n    /**\n     * @param {Row<Column>} row - specifies the row\n     * @param {number} index - specifies the index\n     * @returns {void}\n     * @hidden\n     */\n    GroupLazyLoadRenderer.prototype.maintainRows = function (row, index) {\n        var page = this.parent.pageSettings.currentPage;\n        if (!this.rowsByUid[page]) {\n            this.rowsByUid[page] = {};\n            this.objIdxByUid[page] = {};\n        }\n        if (row.uid) {\n            this.rowsByUid[page][row.uid] = row;\n        }\n        this.objIdxByUid[page][row.uid] = index;\n    };\n    GroupLazyLoadRenderer.prototype.confirmRowRendering = function (row) {\n        var check = true;\n        if (isNullOrUndefined(row.indent) && !row.isDataRow && !row.isCaptionRow) {\n            var cap = this.getRowByUid(row.parentUid);\n            if (cap.isCaptionRow && !cap.isExpand) {\n                check = false;\n            }\n        }\n        return check;\n    };\n    GroupLazyLoadRenderer.prototype.refreshRowObjects = function (newRows, index) {\n        var page = this.parent.pageSettings.currentPage;\n        var rowsObject = this.groupCache[page];\n        this.rowsByUid[page] = {};\n        this.objIdxByUid[page] = {};\n        var newRowsObject = [];\n        var k = 0;\n        for (var i = 0; i < rowsObject.length; i++) {\n            if (i === index) {\n                this.maintainRows(rowsObject[i], k);\n                newRowsObject.push(rowsObject[i]);\n                k++;\n                for (var j = 0; j < newRows.length; j++) {\n                    this.maintainRows(newRows[j], k);\n                    newRowsObject.push(newRows[j]);\n                    k++;\n                }\n            }\n            else {\n                this.maintainRows(rowsObject[i], k);\n                newRowsObject.push(rowsObject[i]);\n                k++;\n            }\n        }\n        this.groupCache[this.parent.pageSettings.currentPage] = extend([], newRowsObject);\n        this.updateCurrentViewData();\n    };\n    GroupLazyLoadRenderer.prototype.getAggregateByCaptionIndex = function (index) {\n        var cache = this.groupCache[this.parent.pageSettings.currentPage];\n        var parent = cache[index];\n        var indent = parent.indent;\n        var uid = parent.uid;\n        var agg = [];\n        for (var i = index + 1; i < cache.length; i++) {\n            if (cache[i].indent === indent) {\n                break;\n            }\n            if (isNullOrUndefined(cache[i].indent) && cache[i].parentUid === uid) {\n                agg.push(cache[i]);\n            }\n        }\n        return agg;\n    };\n    GroupLazyLoadRenderer.prototype.getChildRowsByParentIndex = function (index, deep, block, data, includeAgg, includeCollapseAgg) {\n        var cache = data ? data : this.groupCache[this.parent.pageSettings.currentPage];\n        var parentRow = cache[index];\n        var agg = [];\n        if (!parentRow.isCaptionRow || (parentRow.isCaptionRow && !parentRow.isExpand && !includeCollapseAgg)) {\n            return [];\n        }\n        if (includeAgg && this.parent.aggregates.length) {\n            agg = this.getAggregateByCaptionIndex(index);\n        }\n        var indent = parentRow.indent;\n        var uid = parentRow.uid;\n        var rows = [];\n        var count = 0;\n        for (var i = index + 1; i < cache.length; i++) {\n            if (cache[i].parentUid === uid) {\n                if (isNullOrUndefined(cache[i].indent)) {\n                    continue;\n                }\n                count++;\n                rows.push(cache[i]);\n                if (deep && cache[i].isCaptionRow) {\n                    rows = rows.concat(this.getChildRowsByParentIndex(i, deep, block, data, includeAgg));\n                }\n                if (block && count === this.pageSize) {\n                    break;\n                }\n            }\n            if (cache[i].indent === indent) {\n                break;\n            }\n        }\n        return rows.concat(agg);\n    };\n    /**\n     * @param {boolean} isReorder - specifies the isreorder\n     * @returns {Row<Column>[]} returns the row\n     * @hidden\n     */\n    GroupLazyLoadRenderer.prototype.initialGroupRows = function (isReorder) {\n        var rows = [];\n        var cache = this.groupCache[this.parent.pageSettings.currentPage];\n        if (isReorder) {\n            return this.getRenderedRowsObject();\n        }\n        for (var i = 0; i < cache.length; i++) {\n            if (cache[i].indent === 0) {\n                rows.push(cache[i]);\n                rows = rows.concat(this.getChildRowsByParentIndex(i, true, true, cache, true));\n            }\n        }\n        return rows;\n    };\n    /**\n     * @returns {Row<Column>[]} retruns the row\n     * @hidden */\n    GroupLazyLoadRenderer.prototype.getRenderedRowsObject = function () {\n        var rows = [];\n        var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n        for (var i = 0; i < trs.length; i++) {\n            rows.push(this.getRowByUid(trs[i].getAttribute('data-uid')));\n        }\n        return rows;\n    };\n    GroupLazyLoadRenderer.prototype.getCacheRowsOnDownScroll = function (index) {\n        var rows = [];\n        var rowsObject = this.groupCache[this.parent.pageSettings.currentPage];\n        var k = index;\n        for (var i = 0; i < this.pageSize; i++) {\n            if (!rowsObject[k] || rowsObject[k].indent < rowsObject[index].indent) {\n                break;\n            }\n            if (rowsObject[k].indent === rowsObject[index].indent) {\n                rows.push(rowsObject[k]);\n                if (rowsObject[k].isCaptionRow && rowsObject[k].isExpand) {\n                    rows = rows.concat(this.getChildRowsByParentIndex(k, true, true, null, true));\n                }\n            }\n            if (rowsObject[k].indent > rowsObject[index].indent || isNullOrUndefined(rowsObject[k].indent)) {\n                i--;\n            }\n            k++;\n        }\n        return rows;\n    };\n    GroupLazyLoadRenderer.prototype.getCacheRowsOnUpScroll = function (start, end, index) {\n        var rows = [];\n        var rowsObject = this.groupCache[this.parent.pageSettings.currentPage];\n        var str = false;\n        for (var i = 0; i < rowsObject.length; i++) {\n            if (str && (!rowsObject[i] || rowsObject[i].indent < rowsObject[index].indent || rowsObject[i].uid === end)) {\n                break;\n            }\n            if (!str && rowsObject[i].uid === start) {\n                str = true;\n            }\n            if (str && rowsObject[i].indent === rowsObject[index].indent) {\n                rows.push(rowsObject[i]);\n                if (rowsObject[i].isCaptionRow && rowsObject[i].isExpand) {\n                    rows = rows.concat(this.getChildRowsByParentIndex(i, true, true, null, true));\n                }\n            }\n        }\n        return rows;\n    };\n    GroupLazyLoadRenderer.prototype.scrollHandler = function (e) {\n        if (this.parent.isDestroyed || this.childCount) {\n            return;\n        }\n        var downTrs = [].slice.call(this.parent.getContent().getElementsByClassName('e-lazyload-middle-down'));\n        var upTrs = [].slice.call(this.parent.getContent().getElementsByClassName('e-lazyload-middle-up'));\n        var endTrs = [].slice.call(this.parent.getContent().getElementsByClassName('e-not-lazyload-end'));\n        var tr;\n        var lazyLoadDown = false;\n        var lazyLoadUp = false;\n        var lazyLoadEnd = false;\n        if (e.scrollDown && downTrs.length) {\n            var result = this.findRowElements(downTrs);\n            tr = result.tr;\n            lazyLoadDown = result.entered;\n        }\n        if (!e.scrollDown && endTrs) {\n            for (var i = 0; i < endTrs.length; i++) {\n                var top_1 = endTrs[i].getBoundingClientRect().top;\n                var scrollHeight = this.parent.getContent().scrollHeight;\n                if (top_1 > 0 && top_1 < scrollHeight) {\n                    tr = endTrs[i];\n                    lazyLoadEnd = true;\n                    this.rowIndex = tr.rowIndex;\n                    break;\n                }\n            }\n        }\n        if (!e.scrollDown && upTrs.length && !lazyLoadEnd) {\n            var result = this.findRowElements(upTrs);\n            tr = result.tr;\n            lazyLoadUp = result.entered;\n        }\n        if (tr) {\n            if (lazyLoadDown && e.scrollDown && lazyLoadDown && tr) {\n                this.scrollDownHandler(tr);\n            }\n            if (!e.scrollDown && lazyLoadEnd && tr) {\n                this.scrollUpEndRowHandler(tr);\n            }\n            if (this.cacheMode && !e.scrollDown && !lazyLoadEnd && lazyLoadUp && tr) {\n                this.scrollUpHandler(tr);\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.scrollUpEndRowHandler = function (tr) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        var uid = tr.getAttribute('data-uid');\n        var index = this.rowObjectIndex = this.getRowObjectIndexByUid(uid);\n        var idx = index;\n        var childRow = rows[index];\n        var parentCapRow = this.getRowByUid(childRow.parentUid);\n        var capRowObjIdx = this.getRowObjectIndexByUid(parentCapRow.uid);\n        var captionRowEle = this.parent.getContent().querySelector('tr[data-uid=' + parentCapRow.uid + ']');\n        var capRowEleIndex = captionRowEle.rowIndex;\n        var child = this.getChildRowsByParentIndex(capRowObjIdx);\n        var childIdx = child.indexOf(childRow);\n        var currentPage = Math.ceil(childIdx / this.pageSize);\n        if (currentPage === 1) {\n            return;\n        }\n        this.childCount = currentPage * this.pageSize;\n        index = this.getCurrentBlockEndIndex(childRow, index);\n        if (this.childCount < parentCapRow.data.count) {\n            tr.classList.remove('e-not-lazyload-end');\n            childRow.lazyLoadCssClass = '';\n            var isRowExist = rows[index + 1] ? childRow.indent === rows[index + 1].indent : false;\n            this.scrollData = isRowExist ? this.getCacheRowsOnDownScroll(index + 1) : [];\n            var key = this.getGroupKeysAndFields(capRowObjIdx, rows);\n            var args = {\n                rowIndex: capRowEleIndex, makeRequest: !isRowExist, groupInfo: parentCapRow, fields: key.fields,\n                keys: key.keys, skip: this.childCount, take: this.pageSize, isScroll: true\n            };\n            if (this.cacheMode && this.childCount >= (this.pageSize * this.cacheBlockSize)) {\n                var child_1 = this.getChildRowsByParentIndex(capRowObjIdx);\n                var currenBlock = Math.ceil((child_1.indexOf(rows[idx]) / this.pageSize));\n                var removeBlock = currenBlock - (this.cacheBlockSize - 1);\n                this.removeBlock(uid, isRowExist, removeBlock, child_1);\n                args.cachedRowIndex = (removeBlock * this.pageSize);\n            }\n            this.captionRowExpand(args);\n        }\n        else {\n            this.childCount = 0;\n        }\n    };\n    GroupLazyLoadRenderer.prototype.scrollDownHandler = function (tr) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        var uid = tr.getAttribute('data-uid');\n        var index = this.getRowObjectIndexByUid(uid);\n        var idx = index;\n        var childRow = rows[index];\n        var parentCapRow = this.getRowByUid(childRow.parentUid);\n        var capRowObjIdx = this.getRowObjectIndexByUid(parentCapRow.uid);\n        var captionRowEle = this.getRowElementByUid(parentCapRow.uid);\n        var capRowEleIndex = captionRowEle.rowIndex;\n        var child = this.getChildRowsByParentIndex(capRowObjIdx);\n        var childIdx = child.indexOf(childRow);\n        var currentPage = Math.ceil(childIdx / this.pageSize);\n        this.childCount = currentPage * this.pageSize;\n        index = this.rowObjectIndex = this.getRowObjectIndexByUid(child[this.childCount - 1].uid);\n        var lastchild = rows[index];\n        var lastRow = this.getRowElementByUid(lastchild.uid);\n        this.rowIndex = lastRow.rowIndex;\n        index = this.getCurrentBlockEndIndex(lastchild, index);\n        if (this.childCount < parentCapRow.data.count) {\n            var isRowExist = rows[index + 1] ? childRow.indent === rows[index + 1].indent : false;\n            if (isRowExist && !isNullOrUndefined(this.getRowElementByUid(rows[index + 1].uid))) {\n                this.childCount = 0;\n                return;\n            }\n            if (currentPage > 1 || !this.cacheMode) {\n                tr.classList.remove('e-lazyload-middle-down');\n                lastRow.classList.remove('e-not-lazyload-end');\n                lastchild.lazyLoadCssClass = '';\n            }\n            this.scrollData = isRowExist ? this.getCacheRowsOnDownScroll(this.rowObjectIndex + 1) : [];\n            var query = this.getGroupKeysAndFields(capRowObjIdx, rows);\n            var args = {\n                rowIndex: capRowEleIndex, makeRequest: !isRowExist, groupInfo: parentCapRow, fields: query.fields,\n                keys: query.keys, skip: this.childCount, take: this.pageSize, isScroll: true\n            };\n            if (this.cacheMode && (this.childCount - this.pageSize) >= (this.pageSize * this.cacheBlockSize)) {\n                var child_2 = this.getChildRowsByParentIndex(capRowObjIdx);\n                var currenBlock = Math.ceil((child_2.indexOf(rows[idx]) / this.pageSize)) - 1;\n                var removeBlock = (currenBlock - (this.cacheBlockSize - 1)) + 1;\n                this.removeBlock(uid, isRowExist, removeBlock, child_2, lastchild);\n                args.cachedRowIndex = (removeBlock * this.pageSize);\n            }\n            this.captionRowExpand(args);\n        }\n        else {\n            this.childCount = 0;\n        }\n    };\n    GroupLazyLoadRenderer.prototype.getCurrentBlockEndIndex = function (row, index) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        if (row.isCaptionRow) {\n            if (row.isExpand) {\n                var childCount = this.getChildRowsByParentIndex(index, true).length;\n                this.rowIndex = this.rowIndex + childCount;\n            }\n            var agg = this.getAggregateByCaptionIndex(index);\n            this.rowObjectIndex = this.rowObjectIndex + agg.length;\n            var idx = index;\n            for (var i = idx + 1; i < rows.length; i++) {\n                if (rows[i].indent === rows[index].indent || rows[i].indent < rows[index].indent) {\n                    index = idx;\n                    break;\n                }\n                else {\n                    idx++;\n                }\n            }\n        }\n        return index;\n    };\n    GroupLazyLoadRenderer.prototype.removeBlock = function (uid, isRowExist, removeBlock, child, lastchild) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        var uid1 = child[(((removeBlock + 1) * this.pageSize) - 1) - this.blockSize].uid;\n        var uid2 = child[(removeBlock * this.pageSize) - this.pageSize].uid;\n        var uid3 = child[(removeBlock * this.pageSize)].uid;\n        var firstIdx = this.getRowObjectIndexByUid(uid1);\n        rows[firstIdx].lazyLoadCssClass = 'e-lazyload-middle-up';\n        this.getRowElementByUid(uid1).classList.add('e-lazyload-middle-up');\n        if (lastchild) {\n            this.getRowElementByUid(uid3).classList.add('e-not-lazyload-first');\n            this.getRowByUid(uid3).lazyLoadCssClass = 'e-not-lazyload-first';\n            this.getRowByUid(uid2).lazyLoadCssClass = '';\n        }\n        if (isRowExist) {\n            this.removeTopRows(lastchild ? lastchild.uid : uid, uid2, uid3);\n        }\n        else {\n            this.uid1 = uid2;\n            this.uid2 = uid3;\n            this.uid3 = lastchild ? lastchild.uid : uid;\n        }\n    };\n    GroupLazyLoadRenderer.prototype.scrollUpHandler = function (tr) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        var uid = tr.getAttribute('data-uid');\n        var row = this.getRowByUid(uid);\n        var index = this.rowObjectIndex = this.getRowObjectIndexByUid(uid);\n        var parentCapRow = this.getRowByUid(row.parentUid);\n        var capRowObjIdx = this.rowIndex = this.getRowObjectIndexByUid(parentCapRow.uid);\n        var captionRowEle = this.parent.getRowElementByUID(parentCapRow.uid);\n        var capRowEleIndex = captionRowEle.rowIndex;\n        var child = this.getChildRowsByParentIndex(capRowObjIdx);\n        var childIdx = child.indexOf(rows[index]);\n        var currenBlock = Math.floor((childIdx / this.pageSize));\n        var idx = this.blockSize;\n        if ((this.blockSize * 2) > this.pageSize) {\n            idx = (this.blockSize * 2) - this.pageSize;\n            idx = this.blockSize - idx;\n        }\n        var start = child[(childIdx - (idx - 1)) - this.pageSize].uid;\n        var end = child[childIdx - (idx - 1)].uid;\n        this.scrollData = this.getCacheRowsOnUpScroll(start, end, index - (idx - 1));\n        this.isFirstChildRow = currenBlock > 1;\n        if (this.isFirstChildRow) {\n            this.scrollData[0].lazyLoadCssClass = 'e-not-lazyload-first';\n        }\n        this.getRowByUid(end).lazyLoadCssClass = '';\n        this.getRowElementByUid(end).classList.remove('e-not-lazyload-first');\n        var removeBlock = currenBlock + this.cacheBlockSize;\n        if (child.length !== parentCapRow.data.count && (removeBlock * this.pageSize > child.length)) {\n            this.isFirstChildRow = false;\n            this.scrollData[0].lazyLoadCssClass = '';\n            this.getRowElementByUid(end).classList.add('e-not-lazyload-first');\n            return;\n        }\n        var count = removeBlock * this.pageSize > parentCapRow.data.count\n            ? parentCapRow.data.count : removeBlock * this.pageSize;\n        var size = removeBlock * this.pageSize > parentCapRow.data.count\n            ? (this.pageSize - ((this.pageSize * removeBlock) - parentCapRow.data.count)) : this.pageSize;\n        var childRows = this.getChildRowsByParentIndex(rows.indexOf(child[count - 1]), true, false, null, true);\n        var uid1 = childRows.length ? childRows[childRows.length - 1].uid : child[(count - 1)].uid;\n        var uid2 = child[count - size].uid;\n        var uid3 = child[(count - size) - 1].uid;\n        var lastIdx = this.objIdxByUid[page][uid2] - idx;\n        if (rows[lastIdx].lazyLoadCssClass === 'e-lazyload-middle-down') {\n            var trEle = this.getRowElementByUid(rows[lastIdx].uid);\n            if (trEle) {\n                trEle.classList.add('e-lazyload-middle-down');\n            }\n        }\n        this.getRowByUid(uid1).lazyLoadCssClass = '';\n        this.getRowByUid(uid3).lazyLoadCssClass = 'e-not-lazyload-end';\n        this.getRowElementByUid(uid3).classList.add('e-not-lazyload-end');\n        this.removeBottomRows(uid1, uid2, uid3);\n        this.rowIndex = tr.rowIndex - idx;\n        if (tr.classList.length > 1) {\n            tr.classList.remove('e-lazyload-middle-up');\n        }\n        else {\n            tr.removeAttribute('class');\n        }\n        if (!isNullOrUndefined(this.getRowElementByUid(start))) {\n            this.childCount = 0;\n            this.scrollData = [];\n            return;\n        }\n        var key = this.getGroupKeysAndFields(this.getRowObjectIndexByUid(parentCapRow.uid), rows);\n        var args = {\n            rowIndex: capRowEleIndex, makeRequest: false, groupInfo: parentCapRow, fields: key.fields,\n            keys: key.keys, skip: this.childCount, take: this.pageSize, isScroll: true, scrollUp: true\n        };\n        this.captionRowExpand(args);\n    };\n    GroupLazyLoadRenderer.prototype.findRowElements = function (rows) {\n        var entered = false;\n        var tr;\n        for (var i = 0; i < rows.length; i++) {\n            var rowIdx = rows[i].rowIndex;\n            if (isRowEnteredInGrid(rowIdx, this.parent)) {\n                entered = true;\n                this.rowIndex = rowIdx;\n                tr = rows[i];\n                break;\n            }\n        }\n        return { entered: entered, tr: tr };\n    };\n    GroupLazyLoadRenderer.prototype.getRowElementByUid = function (uid) {\n        return this.parent.getContent().querySelector('tr[data-uid=' + uid + ']');\n    };\n    GroupLazyLoadRenderer.prototype.removeTopRows = function (uid1, uid2, uid3) {\n        var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n        var start = false;\n        for (var i = 0; i < trs.length; i++) {\n            if (trs[i].getAttribute('data-uid') === uid3) {\n                var tr = this.parent.getContent().querySelector('tr[data-uid=' + uid1 + ']');\n                if (tr) {\n                    this.rowIndex = tr.rowIndex;\n                }\n                break;\n            }\n            if (trs[i].getAttribute('data-uid') === uid2) {\n                start = true;\n            }\n            if (start) {\n                remove(trs[i]);\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    GroupLazyLoadRenderer.prototype.removeBottomRows = function (uid1, uid2, uid3) {\n        var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n        var trigger = false;\n        for (var i = 0; i < trs.length; i++) {\n            if (trs[i].getAttribute('data-uid') === uid2) {\n                trigger = true;\n            }\n            if (trigger) {\n                remove(trs[i]);\n                if (trs[i].getAttribute('data-uid') === uid1) {\n                    break;\n                }\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.setCache = function (e) {\n        var page = this.parent.pageSettings.currentPage;\n        this.groupCache[page] = this.initialGroupCaptions[page] = extend([], e.data);\n    };\n    GroupLazyLoadRenderer.prototype.getGroupKeysAndFields = function (index, rowsObject) {\n        var fields = [];\n        var keys = [];\n        for (var i = index; i >= 0; i--) {\n            if (rowsObject[i].isCaptionRow && fields.indexOf(rowsObject[i].data.field) === -1\n                && (rowsObject[i].indent < rowsObject[index].indent || i === index)) {\n                fields.push(rowsObject[i].data.field);\n                keys.push(rowsObject[i].data.key);\n                if (rowsObject[i].indent === 0) {\n                    break;\n                }\n            }\n        }\n        return { fields: fields, keys: keys };\n    };\n    GroupLazyLoadRenderer.prototype.generateExpandPredicates = function (fields, values) {\n        var filterCols = [];\n        for (var i = 0; i < fields.length; i++) {\n            var column = this.parent.getColumnByField(fields[i]);\n            var value = values[i] === 'null' ? null : values[i];\n            var pred = {\n                field: fields[i], predicate: 'or', uid: column.uid, operator: 'equal', type: column.type,\n                matchCase: this.allowCaseSensitive, ignoreAccent: this.ignoreAccent\n            };\n            if (value === '' || isNullOrUndefined(value)) {\n                filterCols = filterCols.concat(CheckBoxFilterBase.generateNullValuePredicates(pred));\n            }\n            else {\n                filterCols.push(extend({}, { value: value }, pred));\n            }\n        }\n        return CheckBoxFilterBase.getPredicate(filterCols);\n    };\n    GroupLazyLoadRenderer.prototype.getPredicates = function (pred) {\n        var predicateList = [];\n        for (var _i = 0, _a = Object.keys(pred); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            predicateList.push(pred[prop]);\n        }\n        return predicateList;\n    };\n    GroupLazyLoadRenderer.prototype.captionRowExpand = function (args) {\n        var _this = this;\n        var captionRow = args.groupInfo;\n        var level = this.parent.groupSettings.columns.indexOf(captionRow.data.field) + 1;\n        var pred = this.generateExpandPredicates(args.fields, args.keys);\n        var predicateList = this.getPredicates(pred);\n        var lazyLoad = { level: level, skip: args.skip, take: args.take, where: predicateList };\n        if (args.makeRequest) {\n            var query = this.parent.renderModule.data.generateQuery(true);\n            if (!query.isCountRequired) {\n                query.isCountRequired = true;\n            }\n            query.lazyLoad.push({ key: 'onDemandGroupInfo', value: lazyLoad });\n            this.parent.showSpinner();\n            this.parent.renderModule.data.getData({}, query).then(function (e) {\n                _this.parent.hideSpinner();\n                if (e.result.length === 0) {\n                    return;\n                }\n                if (_this.cacheMode && _this.uid1 && _this.uid2) {\n                    _this.removeTopRows(_this.uid3, _this.uid1, _this.uid2);\n                    _this.uid1 = _this.uid2 = _this.uid3 = undefined;\n                }\n                _this.lazyLoadHandler({\n                    data: e.result, count: e.count, level: level, index: args.rowIndex,\n                    isRowExist: false, isScroll: args.isScroll, up: false, rowIndex: args.cachedRowIndex\n                });\n            })\n                .catch(function (e) { return _this.parent.renderModule.dataManagerFailure(e, { requestType: 'grouping' }); });\n        }\n        else {\n            this.lazyLoadHandler({\n                data: null, count: args.groupInfo.data.count, level: level, index: args.rowIndex,\n                isRowExist: true, isScroll: args.isScroll, up: args.scrollUp, rowIndex: args.cachedRowIndex\n            });\n        }\n    };\n    GroupLazyLoadRenderer.prototype.scrollReset = function (top) {\n        this.parent.getContent().firstElementChild.scrollTop = top ? this.parent.getContent().firstElementChild.scrollTop + top : 0;\n    };\n    GroupLazyLoadRenderer.prototype.updateCurrentViewData = function () {\n        var records = [];\n        this.getRows().filter(function (row) {\n            if (row.isDataRow) {\n                records[row.index] = row.data;\n            }\n        });\n        this.parent.currentViewData = records.length ? records : this.parent.currentViewData;\n    };\n    /**\n     * @returns {Row<Column>[]} returns the row\n     * @hidden */\n    GroupLazyLoadRenderer.prototype.getGroupCache = function () {\n        return this.groupCache;\n    };\n    /**\n     * @returns {Row<Column>[]} returns the row\n     * @hidden */\n    GroupLazyLoadRenderer.prototype.getRows = function () {\n        return this.groupCache[this.parent.pageSettings.currentPage] || [];\n    };\n    /**\n     * @returns {Element} returns the element\n     * @hidden */\n    GroupLazyLoadRenderer.prototype.getRowElements = function () {\n        return [].slice.call(this.parent.getContent().getElementsByClassName(literals.row));\n    };\n    /**\n     * @param {number} index - specifies the index\n     * @returns {Element} returns the element\n     * @hidden\n     */\n    GroupLazyLoadRenderer.prototype.getRowByIndex = function (index) {\n        var tr = [].slice.call(this.parent.getContent().getElementsByClassName(literals.row));\n        var row;\n        for (var i = 0; !isNullOrUndefined(index) && i < tr.length; i++) {\n            if (tr[i].getAttribute(literals.ariaRowIndex) === index.toString()) {\n                row = tr[i];\n                break;\n            }\n        }\n        return row;\n    };\n    /**\n     * Tucntion to set the column visibility\n     *\n     * @param {Column[]} columns - specifies the column\n     * @returns {void}\n     * @hidden\n     */\n    GroupLazyLoadRenderer.prototype.setVisible = function (columns) {\n        var gObj = this.parent;\n        var rows = this.getRows();\n        var testRow;\n        rows.some(function (r) { if (r.isDataRow) {\n            testRow = r;\n        } return r.isDataRow; });\n        var contentrows = this.getRows().filter(function (row) { return !row.isDetailRow; });\n        for (var i = 0; i < columns.length; i++) {\n            var column = columns[i];\n            var idx = this.parent.getNormalizedColumnIndex(column.uid);\n            var colIdx = this.parent.getColumnIndexByUid(column.uid);\n            var displayVal = column.visible === true ? '' : 'none';\n            if (idx !== -1 && testRow && idx < testRow.cells.length) {\n                setStyleAttribute(this.getColGroup().childNodes[idx], { 'display': displayVal });\n            }\n            this.setDisplayNone(gObj.getDataRows(), colIdx, displayVal, contentrows, idx);\n            if (!this.parent.invokedFromMedia && column.hideAtMedia) {\n                this.parent.updateMediaColumns(column);\n            }\n            this.parent.invokedFromMedia = false;\n        }\n    };\n    /**\n     * Function to set display.\n     *\n     * @param {Object} tr - specifies the row object\n     * @param {number} idx - specifies the index\n     * @param {string} displayVal - specifies the display value\n     * @param {Row<Column>[]} rows - specifies the array of rows\n     * @param {number} oriIdx - specifies the index\n     * @returns {void}\n     * @hidden\n     */\n    GroupLazyLoadRenderer.prototype.setDisplayNone = function (tr, idx, displayVal, rows, oriIdx) {\n        if (!this.parent.groupSettings.columns.length) {\n            setDisplayValue(tr, idx, displayVal, rows);\n        }\n        else {\n            var keys = Object.keys(this.groupCache);\n            for (var j = 0; j < keys.length; j++) {\n                var uids = this.rowsByUid[keys[j]];\n                var idxs = Object.keys(uids);\n                for (var i = 0; i < idxs.length; i++) {\n                    var tr_1 = this.parent.getContent().querySelector('tr[data-uid=' + idxs[i] + ']');\n                    var row = uids[idxs[i]];\n                    if (row.isCaptionRow) {\n                        if (!this.captionModelGen.isEmpty()) {\n                            this.changeCaptionRow(row, tr_1, keys[j]);\n                        }\n                        else {\n                            row.cells[row.indent + 1].colSpan = displayVal === '' ? row.cells[row.indent + 1].colSpan + 1\n                                : row.cells[row.indent + 1].colSpan - 1;\n                            if (tr_1) {\n                                tr_1.cells[row.indent + 1].colSpan = row.cells[row.indent + 1].colSpan;\n                            }\n                        }\n                    }\n                    if (row.isDataRow) {\n                        this.showAndHideCells(tr_1, idx, displayVal, false);\n                        row.cells[oriIdx].visible = displayVal === '' ? true : false;\n                    }\n                    if (!row.isCaptionRow && !row.isDataRow && isNullOrUndefined(row.indent)) {\n                        row.cells[oriIdx].visible = displayVal === '' ? true : false;\n                        row.visible = row.cells.some(function (cell) { return cell.isDataCell && cell.visible; });\n                        this.showAndHideCells(tr_1, idx, displayVal, true, row);\n                    }\n                }\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.changeCaptionRow = function (row, tr, index) {\n        var capRow = row;\n        var captionData = row.data;\n        var data = this.groupGenerator.generateCaptionRow(captionData, capRow.indent, capRow.parentGid, undefined, capRow.tIndex, capRow.parentUid);\n        data.uid = row.uid;\n        data.isExpand = row.isExpand;\n        data.lazyLoadCssClass = row.lazyLoadCssClass;\n        this.rowsByUid[index][row.uid] = data;\n        this.groupCache[index][this.objIdxByUid[index][row.uid]] = data;\n        if (tr) {\n            var tbody = this.parent.getContentTable().querySelector(literals.tbody);\n            tbody.replaceChild(this.rowRenderer.render(data, this.parent.getColumns()), tr);\n        }\n    };\n    GroupLazyLoadRenderer.prototype.showAndHideCells = function (tr, idx, displayVal, isSummary, row) {\n        if (tr) {\n            var cls = isSummary ? 'td.e-summarycell' : 'td.e-rowcell';\n            setStyleAttribute(tr.querySelectorAll(cls)[idx], { 'display': displayVal });\n            if (tr.querySelectorAll(cls)[idx].classList.contains('e-hide')) {\n                removeClass([tr.querySelectorAll(cls)[idx]], ['e-hide']);\n            }\n            if (isSummary) {\n                if (row.visible && tr.classList.contains('e-hide')) {\n                    removeClass([tr], ['e-hide']);\n                }\n                else if (!row.visible) {\n                    addClass([tr], ['e-hide']);\n                }\n            }\n        }\n    };\n    return GroupLazyLoadRenderer;\n}(ContentRender));\nexport { GroupLazyLoadRenderer };\n"]},"metadata":{},"sourceType":"module"}