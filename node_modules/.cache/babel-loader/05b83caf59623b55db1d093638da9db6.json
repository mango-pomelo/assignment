{"ast":null,"code":"import { classList, addClass, removeClass, isNullOrUndefined, Browser } from '@syncfusion/ej2-base';\nimport { Query, DataManager } from '@syncfusion/ej2-data';\nimport { EventHandler, closest } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport { Dialog, calculateRelativeBasedPosition } from '@syncfusion/ej2-popups';\nimport { createCboxWithWrap, toogleCheckbox, parentsUntil, removeAddCboxClasses } from '../base/util';\nimport { createCheckBox } from '@syncfusion/ej2-buttons';\nimport { SearchBox } from '../services/focus-strategy';\nimport * as literals from '../base/string-literals';\n/**\n * The `ColumnChooser` module is used to show or hide columns dynamically.\n */\n\nvar ColumnChooser =\n/** @class */\nfunction () {\n  /**\n   * Constructor for the Grid ColumnChooser module\n   *\n   * @param {IGrid} parent - specifies the IGrid\n   * @param {ServiceLocator} serviceLocator - specifies the serviceLocator\n   * @hidden\n   */\n  function ColumnChooser(parent, serviceLocator) {\n    this.showColumn = [];\n    this.hideColumn = [];\n    this.changedColumns = [];\n    this.unchangedColumns = [];\n    this.isDlgOpen = false;\n    this.initialOpenDlg = true;\n    this.stateChangeColumns = [];\n    this.changedStateColumns = [];\n    this.isInitialOpen = false;\n    this.isCustomizeOpenCC = false;\n    this.searchOperator = 'startswith';\n    this.prevShowedCols = [];\n    this.parent = parent;\n    this.serviceLocator = serviceLocator;\n    this.addEventListener();\n    this.cBoxTrue = createCheckBox(this.parent.createElement, true, {\n      checked: true,\n      label: ' '\n    });\n    this.cBoxFalse = createCheckBox(this.parent.createElement, true, {\n      checked: false,\n      label: ' '\n    });\n    this.cBoxTrue.insertBefore(this.parent.createElement('input', {\n      className: 'e-chk-hidden e-cc e-cc-chbox',\n      attrs: {\n        type: 'checkbox'\n      }\n    }), this.cBoxTrue.firstChild);\n    this.cBoxFalse.insertBefore(this.parent.createElement('input', {\n      className: 'e-chk-hidden e-cc e-cc-chbox',\n      attrs: {\n        'type': 'checkbox'\n      }\n    }), this.cBoxFalse.firstChild);\n    this.cBoxFalse.querySelector('.e-frame').classList.add('e-uncheck');\n\n    if (this.parent.enableRtl) {\n      addClass([this.cBoxTrue, this.cBoxFalse], ['e-rtl']);\n    }\n  }\n\n  ColumnChooser.prototype.destroy = function () {\n    var gridElement = this.parent.element;\n\n    if (!gridElement || !gridElement.querySelector('.' + literals.gridHeader) && !gridElement.querySelector('.' + literals.gridContent)) {\n      return;\n    }\n\n    this.removeEventListener();\n    this.unWireEvents();\n\n    if (!isNullOrUndefined(this.dlgObj) && this.dlgObj.element && !this.dlgObj.isDestroyed) {\n      this.dlgObj.destroy();\n    }\n  };\n\n  ColumnChooser.prototype.rtlUpdate = function () {\n    if (this.parent.enableRtl) {\n      addClass([].slice.call(this.innerDiv.getElementsByClassName('e-checkbox-wrapper')), ['e-rtl']);\n    } else {\n      removeClass([].slice.call(this.innerDiv.getElementsByClassName('e-checkbox-wrapper')), ['e-rtl']);\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n\n\n  ColumnChooser.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    EventHandler.add(document, 'click', this.clickHandler, this);\n    this.parent.on(events.uiUpdate, this.enableAfterRenderEle, this);\n    this.parent.on(events.initialEnd, this.render, this);\n    this.parent.addEventListener(events.dataBound, this.hideDialog.bind(this));\n    this.parent.on(events.destroy, this.destroy, this);\n    this.parent.on(events.rtlUpdated, this.rtlUpdate, this);\n    this.parent.on(events.keyPressed, this.keyUpHandler, this);\n    this.parent.on(events.resetColumns, this.onResetColumns, this);\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n\n\n  ColumnChooser.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    EventHandler.remove(document, 'click', this.clickHandler);\n    this.parent.off(events.initialEnd, this.render);\n    this.parent.off(events.destroy, this.destroy);\n    this.parent.off(events.uiUpdate, this.enableAfterRenderEle);\n    this.parent.off(events.rtlUpdated, this.rtlUpdate);\n    this.parent.on(events.keyPressed, this.keyUpHandler, this);\n    this.parent.off(events.resetColumns, this.onResetColumns);\n  };\n\n  ColumnChooser.prototype.render = function () {\n    this.l10n = this.serviceLocator.getService('localization');\n    this.renderDlgContent();\n    this.getShowHideService = this.serviceLocator.getService('showHideService');\n  };\n\n  ColumnChooser.prototype.clickHandler = function (e) {\n    var targetElement = e.target;\n\n    if (!this.isCustomizeOpenCC) {\n      if (!isNullOrUndefined(closest(targetElement, '.e-cc')) || !isNullOrUndefined(closest(targetElement, '.e-cc-toolbar'))) {\n        if (targetElement.classList.contains('e-columnchooser-btn') || targetElement.classList.contains('e-cc-toolbar')) {\n          if (this.initialOpenDlg && this.dlgObj.visible || !this.isDlgOpen) {\n            this.isDlgOpen = true;\n            return;\n          }\n        } else if (targetElement.classList.contains('e-cc-cancel')) {\n          targetElement.parentElement.querySelector('.e-ccsearch').value = '';\n          this.columnChooserSearch('');\n          this.removeCancelIcon();\n          this.refreshCheckboxButton();\n        }\n      } else {\n        if (!isNullOrUndefined(this.dlgObj) && this.dlgObj.visible && !targetElement.classList.contains('e-toolbar-items')) {\n          this.dlgObj.hide();\n          this.clearActions();\n          this.refreshCheckboxState(); // this.unWireEvents();\n\n          this.isDlgOpen = false;\n        }\n      }\n\n      if (this.parent.detailTemplate || this.parent.childGrid) {\n        this.targetdlg = e.target;\n      }\n    }\n\n    if (this.isCustomizeOpenCC && e.target.classList.contains('e-cc-cancel')) {\n      this.refreshCheckboxState();\n    }\n\n    this.rtlUpdate();\n  };\n\n  ColumnChooser.prototype.hideDialog = function () {\n    if (!isNullOrUndefined(this.dlgObj) && this.dlgObj.visible) {\n      this.dlgObj.hide(); // this.unWireEvents();\n\n      this.isDlgOpen = false;\n    }\n  };\n  /**\n   * To render columnChooser when showColumnChooser enabled.\n   *\n   * @param {number} x - specifies the position x\n   * @param {number} y - specifies the position y\n   * @param {Element} target - specifies the target\n   * @returns {void}\n   * @hidden\n   */\n\n\n  ColumnChooser.prototype.renderColumnChooser = function (x, y, target) {\n    if (!this.dlgObj.visible && (this.parent.detailTemplate || this.parent.childGrid)) {\n      this.hideOpenedDialog();\n    }\n\n    if (!this.dlgObj.visible) {\n      var args = this.beforeOpenColumnChooserEvent();\n\n      if (args.cancel) {\n        return;\n      }\n\n      if (target) {\n        this.targetdlg = target;\n      }\n\n      this.refreshCheckboxState();\n      this.dlgObj.dataBind();\n      this.dlgObj.element.style.maxHeight = '430px';\n      var elementVisible = this.dlgObj.element.style.display;\n      this.dlgObj.element.style.display = 'block';\n      var newpos = calculateRelativeBasedPosition(closest(target, '.e-toolbar-item'), this.dlgObj.element);\n      this.dlgObj.element.style.display = elementVisible;\n      this.dlgObj.element.style.top = newpos.top + closest(target, '.e-cc-toolbar').getBoundingClientRect().height + 'px';\n      var dlgWidth = 250;\n\n      if (!isNullOrUndefined(closest(target, '.e-bigger'))) {\n        this.dlgObj.width = 258;\n      }\n\n      if (Browser.isDevice) {\n        this.dlgObj.target = document.body;\n        this.dlgObj.position = {\n          X: 'center',\n          Y: 'center'\n        };\n        this.dlgObj.refreshPosition();\n        this.dlgObj.open = this.mOpenDlg.bind(this);\n      } else {\n        if (this.parent.enableRtl) {\n          this.dlgObj.element.style.left = target.offsetLeft + 'px';\n        } else {\n          this.dlgObj.element.style.left = newpos.left - dlgWidth + closest(target, '.e-cc-toolbar').clientWidth + 2 + 'px';\n        }\n      }\n\n      this.removeCancelIcon();\n      this.dlgObj.show();\n      this.parent.notify(events.columnChooserOpened, {\n        dialog: this.dlgObj\n      });\n    } else {\n      // this.unWireEvents();\n      this.hideDialog();\n      this.addcancelIcon();\n      this.clearActions();\n      this.refreshCheckboxState();\n    }\n\n    this.rtlUpdate();\n  };\n  /**\n   * Column chooser can be displayed on screen by given position(X and Y axis).\n   *\n   * @param  {number} X - Defines the X axis.\n   * @param  {number} Y - Defines the Y axis.\n   * @return {void}\n   */\n\n\n  ColumnChooser.prototype.openColumnChooser = function (X, Y) {\n    this.isCustomizeOpenCC = true;\n\n    if (this.dlgObj.visible) {\n      this.hideDialog();\n      return;\n    }\n\n    var args = this.beforeOpenColumnChooserEvent();\n\n    if (args.cancel) {\n      return;\n    }\n\n    if (!this.isInitialOpen) {\n      this.dlgObj.content = this.renderChooserList();\n      this.updateIntermediateBtn();\n    } else {\n      this.refreshCheckboxState();\n    }\n\n    this.dlgObj.dataBind();\n    this.dlgObj.position = {\n      X: 'center',\n      Y: 'center'\n    };\n\n    if (isNullOrUndefined(X)) {\n      this.dlgObj.position = {\n        X: 'center',\n        Y: 'center'\n      };\n      this.dlgObj.refreshPosition();\n    } else {\n      this.dlgObj.element.style.top = '';\n      this.dlgObj.element.style.left = '';\n      this.dlgObj.element.style.top = Y + 'px';\n      this.dlgObj.element.style.left = X + 'px';\n    }\n\n    this.dlgObj.beforeOpen = this.customDialogOpen.bind(this);\n    this.dlgObj.show();\n    this.isInitialOpen = true;\n    this.dlgObj.beforeClose = this.customDialogClose.bind(this);\n  };\n\n  ColumnChooser.prototype.enableAfterRenderEle = function (e) {\n    if (e.module === this.getModuleName() && e.enable) {\n      this.render();\n    }\n  };\n\n  ColumnChooser.prototype.keyUpHandler = function (e) {\n    if (e.action === 'escape') {\n      this.hideDialog();\n    }\n  };\n\n  ColumnChooser.prototype.customDialogOpen = function () {\n    var searchElement = this.dlgObj.content.querySelector('input.e-ccsearch');\n    EventHandler.add(searchElement, 'keyup', this.columnChooserManualSearch, this);\n  };\n\n  ColumnChooser.prototype.customDialogClose = function () {\n    var searchElement = this.dlgObj.content.querySelector('input.e-ccsearch');\n    EventHandler.remove(searchElement, 'keyup', this.columnChooserManualSearch);\n  };\n\n  ColumnChooser.prototype.getColumns = function () {\n    var columns = this.parent.getColumns().filter(function (column) {\n      return column.type !== 'checkbox' && column.showInColumnChooser === true || column.type === 'checkbox' && column.field !== undefined;\n    });\n    return columns;\n  };\n\n  ColumnChooser.prototype.renderDlgContent = function () {\n    this.dlgDiv = this.parent.createElement('div', {\n      className: 'e-ccdlg e-cc',\n      id: this.parent.element.id + '_ccdlg'\n    });\n    this.dlgDiv.setAttribute('aria-label', this.l10n.getConstant('ColumnChooserDialogARIA'));\n    this.parent.element.appendChild(this.dlgDiv);\n    this.dlgObj = new Dialog({\n      header: this.l10n.getConstant('ChooseColumns'),\n      showCloseIcon: false,\n      closeOnEscape: false,\n      locale: this.parent.locale,\n      visible: false,\n      enableRtl: this.parent.enableRtl,\n      target: document.getElementById(this.parent.element.id),\n      buttons: [{\n        click: this.confirmDlgBtnClick.bind(this),\n        buttonModel: {\n          content: this.l10n.getConstant('OKButton'),\n          isPrimary: true,\n          cssClass: 'e-cc e-cc_okbtn'\n        }\n      }, {\n        click: this.clearBtnClick.bind(this),\n        buttonModel: {\n          cssClass: 'e-flat e-cc e-cc-cnbtn',\n          content: this.l10n.getConstant('CancelButton')\n        }\n      }],\n      content: this.renderChooserList(),\n      width: 250,\n      cssClass: 'e-cc',\n      animationSettings: {\n        effect: 'None'\n      }\n    });\n    var isStringTemplate = 'isStringTemplate';\n    this.dlgObj[isStringTemplate] = true;\n    this.dlgObj.appendTo(this.dlgDiv);\n    this.wireEvents();\n  };\n\n  ColumnChooser.prototype.renderChooserList = function () {\n    this.mainDiv = this.parent.createElement('div', {\n      className: 'e-main-div e-cc'\n    });\n    var searchDiv = this.parent.createElement('div', {\n      className: 'e-cc-searchdiv e-cc e-input-group'\n    });\n    var ccsearchele = this.parent.createElement('input', {\n      className: 'e-ccsearch e-cc e-input',\n      attrs: {\n        placeholder: this.l10n.getConstant('Search')\n      }\n    });\n    var ccsearchicon = this.parent.createElement('span', {\n      className: 'e-ccsearch-icon e-icons e-cc e-input-group-icon',\n      attrs: {\n        title: this.l10n.getConstant('Search')\n      }\n    });\n    var conDiv = this.parent.createElement('div', {\n      className: 'e-cc-contentdiv'\n    });\n    this.innerDiv = this.parent.createElement('div', {\n      className: 'e-innerdiv e-cc'\n    });\n    searchDiv.appendChild(ccsearchele);\n    searchDiv.appendChild(ccsearchicon);\n    this.searchBoxObj = new SearchBox(ccsearchele);\n    var innerDivContent = this.refreshCheckboxList(this.parent.getColumns());\n    this.innerDiv.appendChild(innerDivContent);\n    conDiv.appendChild(this.innerDiv);\n    this.mainDiv.appendChild(searchDiv);\n    this.mainDiv.appendChild(conDiv);\n    return this.mainDiv;\n  };\n\n  ColumnChooser.prototype.confirmDlgBtnClick = function (args) {\n    this.stateChangeColumns = [];\n    this.changedStateColumns = [];\n    this.changedColumns = this.changedColumns.length > 0 ? this.changedColumns : this.unchangedColumns;\n    this.changedColumnState(this.changedColumns);\n    var uncheckedLength = this.ulElement.querySelector('.e-uncheck') && this.ulElement.querySelectorAll('.e-uncheck:not(.e-selectall)').length;\n\n    if (!isNullOrUndefined(args)) {\n      if (uncheckedLength < this.parent.getColumns().length) {\n        if (this.hideColumn.length) {\n          this.columnStateChange(this.hideColumn, false);\n        }\n\n        if (this.showColumn.length) {\n          this.columnStateChange(this.showColumn, true);\n        }\n\n        this.getShowHideService.setVisible(this.stateChangeColumns, this.changedStateColumns);\n        this.clearActions();\n        this.parent.notify(events.tooltipDestroy, {\n          module: 'edit'\n        });\n\n        if (this.parent.getCurrentViewRecords().length === 0) {\n          var emptyRowCell = this.parent.element.querySelector('.e-emptyrow').querySelector('td');\n          emptyRowCell.setAttribute('colSpan', this.parent.getVisibleColumns().length.toString());\n        }\n      }\n    }\n  };\n\n  ColumnChooser.prototype.onResetColumns = function (e) {\n    if (e.requestType === 'columnstate') {\n      this.resetColumnState();\n      return;\n    }\n  };\n\n  ColumnChooser.prototype.resetColumnState = function () {\n    this.showColumn = [];\n    this.hideColumn = [];\n    this.hideDialog();\n  };\n\n  ColumnChooser.prototype.changedColumnState = function (changedColumns) {\n    for (var index = 0; index < changedColumns.length; index++) {\n      var colUid = changedColumns[index];\n      var currentCol = this.parent.getColumnByUid(colUid);\n      this.changedStateColumns.push(currentCol);\n    }\n  };\n\n  ColumnChooser.prototype.columnStateChange = function (stateColumns, state) {\n    for (var index = 0; index < stateColumns.length; index++) {\n      var colUid = stateColumns[index];\n      var currentCol = this.parent.getColumnByUid(colUid);\n\n      if (currentCol.type !== 'checkbox') {\n        currentCol.visible = state;\n      }\n\n      this.stateChangeColumns.push(currentCol);\n    }\n  };\n\n  ColumnChooser.prototype.clearActions = function () {\n    this.resetColumnState();\n    this.addcancelIcon();\n  };\n\n  ColumnChooser.prototype.clearBtnClick = function () {\n    this.clearActions();\n    this.parent.notify(events.columnChooserCancelBtnClick, {\n      dialog: this.dlgObj\n    });\n  };\n\n  ColumnChooser.prototype.checkstatecolumn = function (isChecked, coluid, selectAll) {\n    if (selectAll === void 0) {\n      selectAll = false;\n    }\n\n    if (isChecked) {\n      if (this.hideColumn.indexOf(coluid) !== -1) {\n        this.hideColumn.splice(this.hideColumn.indexOf(coluid), 1);\n      }\n\n      if (this.showColumn.indexOf(coluid) === -1) {\n        this.showColumn.push(coluid);\n      }\n    } else {\n      if (this.showColumn.indexOf(coluid) !== -1) {\n        this.showColumn.splice(this.showColumn.indexOf(coluid), 1);\n      }\n\n      if (this.hideColumn.indexOf(coluid) === -1) {\n        this.hideColumn.push(coluid);\n      }\n    }\n\n    if (selectAll) {\n      if (!isChecked) {\n        this.changedColumns.push(coluid);\n      } else {\n        this.unchangedColumns.push(coluid);\n      }\n    } else if (this.changedColumns.indexOf(coluid) !== -1) {\n      this.changedColumns.splice(this.changedColumns.indexOf(coluid), 1);\n    } else {\n      this.changedColumns.push(coluid);\n    }\n  };\n\n  ColumnChooser.prototype.columnChooserSearch = function (searchVal) {\n    var clearSearch = false;\n    var fltrCol;\n    var okButton;\n    var buttonEle = this.dlgDiv.querySelector('.e-footer-content');\n    var selectedCbox = this.ulElement.querySelector('.e-check') && this.ulElement.querySelectorAll('.e-check:not(.e-selectall)').length;\n    this.isInitialOpen = true;\n\n    if (buttonEle) {\n      okButton = buttonEle.querySelector('.e-btn').ej2_instances[0];\n    }\n\n    if (searchVal === '') {\n      this.removeCancelIcon();\n      fltrCol = this.getColumns();\n      clearSearch = true;\n    } else {\n      fltrCol = new DataManager(this.getColumns()).executeLocal(new Query().where('headerText', this.searchOperator, searchVal, true, this.parent.columnChooserSettings.ignoreAccent));\n    }\n\n    if (fltrCol.length) {\n      this.innerDiv.innerHTML = ' ';\n      this.innerDiv.classList.remove('e-ccnmdiv');\n      this.innerDiv.appendChild(this.refreshCheckboxList(fltrCol));\n\n      if (!clearSearch) {\n        this.addcancelIcon();\n        this.refreshCheckboxButton();\n      } else {\n        if (okButton && selectedCbox) {\n          okButton.disabled = false;\n        }\n      }\n    } else {\n      var nMatchele = this.parent.createElement('span', {\n        className: 'e-cc e-nmatch'\n      });\n      nMatchele.innerHTML = this.l10n.getConstant('Matchs');\n      this.innerDiv.innerHTML = ' ';\n      this.innerDiv.appendChild(nMatchele);\n      this.innerDiv.classList.add('e-ccnmdiv');\n\n      if (okButton) {\n        okButton.disabled = true;\n      }\n    }\n\n    this.flag = true;\n    this.stopTimer();\n  };\n\n  ColumnChooser.prototype.wireEvents = function () {\n    EventHandler.add(this.dlgObj.element, 'click', this.checkBoxClickHandler, this);\n    EventHandler.add(this.searchBoxObj.searchBox, 'keyup', this.columnChooserManualSearch, this);\n    this.searchBoxObj.wireEvent();\n  };\n\n  ColumnChooser.prototype.unWireEvents = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    if (this.dlgObj.element) {\n      EventHandler.remove(this.dlgObj.element, 'click', this.checkBoxClickHandler);\n    }\n\n    EventHandler.remove(this.searchBoxObj.searchBox, 'keyup', this.columnChooserManualSearch);\n    this.searchBoxObj.unWireEvent();\n  };\n\n  ColumnChooser.prototype.checkBoxClickHandler = function (e) {\n    var checkstate;\n    var elem = parentsUntil(e.target, 'e-checkbox-wrapper');\n\n    if (elem) {\n      var selectAll = elem.querySelector('.e-selectall');\n\n      if (selectAll) {\n        this.updateSelectAll(!elem.querySelector('.e-check'));\n      } else {\n        toogleCheckbox(elem.parentElement);\n      }\n\n      elem.querySelector('.e-chk-hidden').focus();\n\n      if (elem.querySelector('.e-check')) {\n        checkstate = true;\n      } else if (elem.querySelector('.e-uncheck')) {\n        checkstate = false;\n      } else {\n        return;\n      }\n\n      this.updateIntermediateBtn();\n      var columnUid = parentsUntil(elem, 'e-ccheck').getAttribute('uid');\n      var column = this.parent.getColumns();\n\n      if (columnUid === 'grid-selectAll') {\n        this.changedColumns = [];\n        this.unchangedColumns = [];\n\n        for (var i = 0; i < column.length; i++) {\n          if (column[i].showInColumnChooser) {\n            this.checkstatecolumn(checkstate, column[i].uid, true);\n          }\n        }\n      } else {\n        this.checkstatecolumn(checkstate, columnUid);\n      }\n\n      this.refreshCheckboxButton();\n    }\n  };\n\n  ColumnChooser.prototype.updateIntermediateBtn = function () {\n    var cnt = this.ulElement.children.length - 1;\n    var className = [];\n    var elem = this.ulElement.children[0].querySelector('.e-frame');\n    var selected = this.ulElement.querySelectorAll('.e-check:not(.e-selectall)').length;\n    var btn = this.dlgObj.btnObj[0];\n    btn.disabled = false;\n\n    if (cnt === selected) {\n      className = ['e-check'];\n    } else if (selected) {\n      className = ['e-stop'];\n    } else {\n      className = ['e-uncheck'];\n      btn.disabled = true;\n    }\n\n    btn.dataBind();\n    removeClass([elem], ['e-check', 'e-stop', 'e-uncheck']);\n    addClass([elem], className);\n  };\n\n  ColumnChooser.prototype.updateSelectAll = function (checked) {\n    var cBoxes = [].slice.call(this.ulElement.getElementsByClassName('e-frame'));\n\n    for (var _i = 0, cBoxes_1 = cBoxes; _i < cBoxes_1.length; _i++) {\n      var cBox = cBoxes_1[_i];\n      removeAddCboxClasses(cBox, checked);\n    }\n  };\n\n  ColumnChooser.prototype.refreshCheckboxButton = function () {\n    var visibleCols = this.parent.getVisibleColumns();\n\n    for (var i = 0; i < visibleCols.length; i++) {\n      var columnUID = visibleCols[i].uid;\n\n      if (this.prevShowedCols.indexOf(columnUID) === -1) {\n        this.prevShowedCols.push(columnUID);\n      }\n    }\n\n    for (var i = 0; i < this.hideColumn.length; i++) {\n      var index = this.prevShowedCols.indexOf(this.hideColumn[i]);\n\n      if (index !== -1) {\n        this.prevShowedCols.splice(index, 1);\n      }\n    }\n\n    var selected = this.showColumn.length !== 0 ? 1 : this.prevShowedCols.length;\n    var btn = this.dlgDiv.querySelector('.e-footer-content').querySelector('.e-btn').ej2_instances[0];\n    btn.disabled = false;\n    var srchShowCols = [];\n    var searchData = [].slice.call(this.parent.element.getElementsByClassName('e-cc-chbox'));\n\n    for (var i = 0, itemsLen = searchData.length; i < itemsLen; i++) {\n      var element = searchData[i];\n      var columnUID = parentsUntil(element, 'e-ccheck').getAttribute('uid');\n      srchShowCols.push(columnUID);\n    }\n\n    var hideCols = this.showColumn.filter(function (column) {\n      return srchShowCols.indexOf(column) !== -1;\n    });\n\n    if (selected === 0 && hideCols.length === 0) {\n      btn.disabled = true;\n    }\n\n    btn.dataBind();\n  };\n\n  ColumnChooser.prototype.refreshCheckboxList = function (gdCol) {\n    this.ulElement = this.parent.createElement('ul', {\n      className: 'e-ccul-ele e-cc'\n    });\n    var selectAllValue = this.l10n.getConstant('SelectAll');\n    var cclist = this.parent.createElement('li', {\n      className: 'e-cclist e-cc e-cc-selectall'\n    });\n    var selectAll = this.createCheckBox(selectAllValue, false, 'grid-selectAll');\n\n    if (gdCol.length) {\n      selectAll.querySelector('.e-checkbox-wrapper').firstElementChild.classList.add('e-selectall');\n      selectAll.querySelector('.e-frame').classList.add('e-selectall');\n      this.checkState(selectAll.querySelector('.e-icons'), true);\n      cclist.appendChild(selectAll);\n      this.ulElement.appendChild(cclist);\n    }\n\n    for (var i = 0; i < gdCol.length; i++) {\n      var columns = gdCol[i];\n      this.renderCheckbox(columns);\n    }\n\n    return this.ulElement;\n  };\n\n  ColumnChooser.prototype.refreshCheckboxState = function () {\n    this.dlgObj.element.querySelector('.e-cc.e-input').value = '';\n    this.columnChooserSearch('');\n    var gridObject = this.parent;\n    var currentCheckBoxColls = this.dlgObj.element.querySelectorAll('.e-cc-chbox:not(.e-selectall)');\n\n    for (var i = 0, itemLen = currentCheckBoxColls.length; i < itemLen; i++) {\n      var element = currentCheckBoxColls[i];\n      var columnUID = void 0;\n\n      if (this.parent.childGrid || this.parent.detailTemplate) {\n        columnUID = parentsUntil(this.dlgObj.element.querySelectorAll('.e-cc-chbox:not(.e-selectall)')[i], 'e-ccheck').getAttribute('uid');\n      } else {\n        columnUID = parentsUntil(element, 'e-ccheck').getAttribute('uid');\n      }\n\n      var column = gridObject.getColumnByUid(columnUID);\n      var uncheck = [].slice.call(element.parentElement.getElementsByClassName('e-uncheck'));\n\n      if (column.visible && !uncheck.length) {\n        element.checked = true;\n        this.checkState(element.parentElement.querySelector('.e-icons'), true);\n      } else {\n        element.checked = false;\n        this.checkState(element.parentElement.querySelector('.e-icons'), false);\n      }\n    }\n  };\n\n  ColumnChooser.prototype.checkState = function (element, state) {\n    if (state) {\n      classList(element, ['e-check'], ['e-uncheck']);\n    } else {\n      classList(element, ['e-uncheck'], ['e-check']);\n    }\n  };\n\n  ColumnChooser.prototype.createCheckBox = function (label, checked, uid) {\n    var cbox = checked ? this.cBoxTrue.cloneNode(true) : this.cBoxFalse.cloneNode(true);\n    cbox.querySelector('.e-label').innerHTML = label;\n    return createCboxWithWrap(uid, cbox, 'e-ccheck');\n  };\n\n  ColumnChooser.prototype.renderCheckbox = function (column) {\n    var cclist;\n    var hideColState;\n    var showColState;\n\n    if (column.showInColumnChooser) {\n      cclist = this.parent.createElement('li', {\n        className: 'e-cclist e-cc',\n        styles: 'list-style:None',\n        id: 'e-ccli_' + column.uid\n      });\n      hideColState = this.hideColumn.indexOf(column.uid) === -1 ? false : true;\n      showColState = this.showColumn.indexOf(column.uid) === -1 ? false : true;\n      var cccheckboxlist = this.createCheckBox(column.headerText, column.visible && !hideColState || showColState, column.uid);\n      cclist.appendChild(cccheckboxlist);\n      this.ulElement.appendChild(cclist);\n    }\n\n    if (this.isInitialOpen) {\n      this.updateIntermediateBtn();\n    }\n  };\n\n  ColumnChooser.prototype.columnChooserManualSearch = function (e) {\n    this.addcancelIcon();\n    this.searchValue = e.target.value;\n    this.stopTimer();\n    this.startTimer(e);\n  };\n\n  ColumnChooser.prototype.startTimer = function (e) {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var proxy = this;\n    var interval = !proxy.flag && e.keyCode !== 13 ? 500 : 0;\n    this.timer = window.setInterval(function () {\n      proxy.columnChooserSearch(proxy.searchValue);\n    }, interval);\n  };\n\n  ColumnChooser.prototype.stopTimer = function () {\n    window.clearInterval(this.timer);\n  };\n\n  ColumnChooser.prototype.addcancelIcon = function () {\n    this.dlgDiv.querySelector('.e-cc.e-ccsearch-icon').classList.add('e-cc-cancel');\n  };\n\n  ColumnChooser.prototype.removeCancelIcon = function () {\n    this.dlgDiv.querySelector('.e-cc.e-ccsearch-icon').classList.remove('e-cc-cancel');\n  };\n\n  ColumnChooser.prototype.mOpenDlg = function () {\n    if (Browser.isDevice) {\n      this.dlgObj.element.querySelector('.e-cc-searchdiv').classList.remove('e-input-focus');\n      this.dlgObj.element.querySelectorAll('.e-cc-chbox')[0].focus();\n    }\n  }; // internally use\n\n\n  ColumnChooser.prototype.getModuleName = function () {\n    return 'columnChooser';\n  };\n\n  ColumnChooser.prototype.hideOpenedDialog = function () {\n    var openCC = [].slice.call(document.getElementsByClassName('e-ccdlg')).filter(function (dlgEle) {\n      return dlgEle.classList.contains('e-popup-open');\n    });\n\n    for (var i = 0, dlgLen = openCC.length; i < dlgLen; i++) {\n      if (openCC[i].classList.contains('e-dialog') || this.parent.element.id + '_ccdlg' !== openCC[i].id) {\n        openCC[i].ej2_instances[0].hide();\n      }\n    }\n  };\n\n  ColumnChooser.prototype.beforeOpenColumnChooserEvent = function () {\n    var args1 = {\n      requestType: 'beforeOpenColumnChooser',\n      element: this.parent.element,\n      columns: this.getColumns(),\n      cancel: false,\n      searchOperator: this.parent.columnChooserSettings.operator\n    };\n    this.parent.trigger(events.beforeOpenColumnChooser, args1);\n    this.searchOperator = args1.searchOperator;\n    return args1;\n  };\n\n  return ColumnChooser;\n}();\n\nexport { ColumnChooser };","map":{"version":3,"sources":["/Users/zhouzhou/Desktop/lightfront/node_modules/@syncfusion/ej2-grids/src/grid/actions/column-chooser.js"],"names":["classList","addClass","removeClass","isNullOrUndefined","Browser","Query","DataManager","EventHandler","closest","events","Dialog","calculateRelativeBasedPosition","createCboxWithWrap","toogleCheckbox","parentsUntil","removeAddCboxClasses","createCheckBox","SearchBox","literals","ColumnChooser","parent","serviceLocator","showColumn","hideColumn","changedColumns","unchangedColumns","isDlgOpen","initialOpenDlg","stateChangeColumns","changedStateColumns","isInitialOpen","isCustomizeOpenCC","searchOperator","prevShowedCols","addEventListener","cBoxTrue","createElement","checked","label","cBoxFalse","insertBefore","className","attrs","type","firstChild","querySelector","add","enableRtl","prototype","destroy","gridElement","element","gridHeader","gridContent","removeEventListener","unWireEvents","dlgObj","isDestroyed","rtlUpdate","slice","call","innerDiv","getElementsByClassName","document","clickHandler","on","uiUpdate","enableAfterRenderEle","initialEnd","render","dataBound","hideDialog","bind","rtlUpdated","keyPressed","keyUpHandler","resetColumns","onResetColumns","remove","off","l10n","getService","renderDlgContent","getShowHideService","e","targetElement","target","contains","visible","parentElement","value","columnChooserSearch","removeCancelIcon","refreshCheckboxButton","hide","clearActions","refreshCheckboxState","detailTemplate","childGrid","targetdlg","renderColumnChooser","x","y","hideOpenedDialog","args","beforeOpenColumnChooserEvent","cancel","dataBind","style","maxHeight","elementVisible","display","newpos","top","getBoundingClientRect","height","dlgWidth","width","isDevice","body","position","X","Y","refreshPosition","open","mOpenDlg","left","offsetLeft","clientWidth","show","notify","columnChooserOpened","dialog","addcancelIcon","openColumnChooser","content","renderChooserList","updateIntermediateBtn","beforeOpen","customDialogOpen","beforeClose","customDialogClose","module","getModuleName","enable","action","searchElement","columnChooserManualSearch","getColumns","columns","filter","column","showInColumnChooser","field","undefined","dlgDiv","id","setAttribute","getConstant","appendChild","header","showCloseIcon","closeOnEscape","locale","getElementById","buttons","click","confirmDlgBtnClick","buttonModel","isPrimary","cssClass","clearBtnClick","animationSettings","effect","isStringTemplate","appendTo","wireEvents","mainDiv","searchDiv","ccsearchele","placeholder","ccsearchicon","title","conDiv","searchBoxObj","innerDivContent","refreshCheckboxList","length","changedColumnState","uncheckedLength","ulElement","querySelectorAll","columnStateChange","setVisible","tooltipDestroy","getCurrentViewRecords","emptyRowCell","getVisibleColumns","toString","requestType","resetColumnState","index","colUid","currentCol","getColumnByUid","push","stateColumns","state","columnChooserCancelBtnClick","checkstatecolumn","isChecked","coluid","selectAll","indexOf","splice","searchVal","clearSearch","fltrCol","okButton","buttonEle","selectedCbox","ej2_instances","executeLocal","where","columnChooserSettings","ignoreAccent","innerHTML","disabled","nMatchele","flag","stopTimer","checkBoxClickHandler","searchBox","wireEvent","unWireEvent","checkstate","elem","updateSelectAll","focus","columnUid","getAttribute","i","uid","cnt","children","selected","btn","btnObj","cBoxes","_i","cBoxes_1","cBox","visibleCols","columnUID","srchShowCols","searchData","itemsLen","hideCols","gdCol","selectAllValue","cclist","firstElementChild","checkState","renderCheckbox","gridObject","currentCheckBoxColls","itemLen","uncheck","cbox","cloneNode","hideColState","showColState","styles","cccheckboxlist","headerText","searchValue","startTimer","proxy","interval","keyCode","timer","window","setInterval","clearInterval","openCC","dlgEle","dlgLen","args1","operator","trigger","beforeOpenColumnChooser"],"mappings":"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","sourcesContent":["import { classList, addClass, removeClass, isNullOrUndefined, Browser } from '@syncfusion/ej2-base';\nimport { Query, DataManager } from '@syncfusion/ej2-data';\nimport { EventHandler, closest } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport { Dialog, calculateRelativeBasedPosition } from '@syncfusion/ej2-popups';\nimport { createCboxWithWrap, toogleCheckbox, parentsUntil, removeAddCboxClasses } from '../base/util';\nimport { createCheckBox } from '@syncfusion/ej2-buttons';\nimport { SearchBox } from '../services/focus-strategy';\nimport * as literals from '../base/string-literals';\n/**\n * The `ColumnChooser` module is used to show or hide columns dynamically.\n */\nvar ColumnChooser = /** @class */ (function () {\n    /**\n     * Constructor for the Grid ColumnChooser module\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @param {ServiceLocator} serviceLocator - specifies the serviceLocator\n     * @hidden\n     */\n    function ColumnChooser(parent, serviceLocator) {\n        this.showColumn = [];\n        this.hideColumn = [];\n        this.changedColumns = [];\n        this.unchangedColumns = [];\n        this.isDlgOpen = false;\n        this.initialOpenDlg = true;\n        this.stateChangeColumns = [];\n        this.changedStateColumns = [];\n        this.isInitialOpen = false;\n        this.isCustomizeOpenCC = false;\n        this.searchOperator = 'startswith';\n        this.prevShowedCols = [];\n        this.parent = parent;\n        this.serviceLocator = serviceLocator;\n        this.addEventListener();\n        this.cBoxTrue = createCheckBox(this.parent.createElement, true, { checked: true, label: ' ' });\n        this.cBoxFalse = createCheckBox(this.parent.createElement, true, { checked: false, label: ' ' });\n        this.cBoxTrue.insertBefore(this.parent.createElement('input', {\n            className: 'e-chk-hidden e-cc e-cc-chbox', attrs: { type: 'checkbox' }\n        }), this.cBoxTrue.firstChild);\n        this.cBoxFalse.insertBefore(this.parent.createElement('input', {\n            className: 'e-chk-hidden e-cc e-cc-chbox', attrs: { 'type': 'checkbox' }\n        }), this.cBoxFalse.firstChild);\n        this.cBoxFalse.querySelector('.e-frame').classList.add('e-uncheck');\n        if (this.parent.enableRtl) {\n            addClass([this.cBoxTrue, this.cBoxFalse], ['e-rtl']);\n        }\n    }\n    ColumnChooser.prototype.destroy = function () {\n        var gridElement = this.parent.element;\n        if (!gridElement || (!gridElement.querySelector('.' + literals.gridHeader) && !gridElement.querySelector('.' + literals.gridContent))) {\n            return;\n        }\n        this.removeEventListener();\n        this.unWireEvents();\n        if (!isNullOrUndefined(this.dlgObj) && this.dlgObj.element && !this.dlgObj.isDestroyed) {\n            this.dlgObj.destroy();\n        }\n    };\n    ColumnChooser.prototype.rtlUpdate = function () {\n        if (this.parent.enableRtl) {\n            addClass([].slice.call(this.innerDiv.getElementsByClassName('e-checkbox-wrapper')), ['e-rtl']);\n        }\n        else {\n            removeClass([].slice.call(this.innerDiv.getElementsByClassName('e-checkbox-wrapper')), ['e-rtl']);\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    ColumnChooser.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        EventHandler.add(document, 'click', this.clickHandler, this);\n        this.parent.on(events.uiUpdate, this.enableAfterRenderEle, this);\n        this.parent.on(events.initialEnd, this.render, this);\n        this.parent.addEventListener(events.dataBound, this.hideDialog.bind(this));\n        this.parent.on(events.destroy, this.destroy, this);\n        this.parent.on(events.rtlUpdated, this.rtlUpdate, this);\n        this.parent.on(events.keyPressed, this.keyUpHandler, this);\n        this.parent.on(events.resetColumns, this.onResetColumns, this);\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    ColumnChooser.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        EventHandler.remove(document, 'click', this.clickHandler);\n        this.parent.off(events.initialEnd, this.render);\n        this.parent.off(events.destroy, this.destroy);\n        this.parent.off(events.uiUpdate, this.enableAfterRenderEle);\n        this.parent.off(events.rtlUpdated, this.rtlUpdate);\n        this.parent.on(events.keyPressed, this.keyUpHandler, this);\n        this.parent.off(events.resetColumns, this.onResetColumns);\n    };\n    ColumnChooser.prototype.render = function () {\n        this.l10n = this.serviceLocator.getService('localization');\n        this.renderDlgContent();\n        this.getShowHideService = this.serviceLocator.getService('showHideService');\n    };\n    ColumnChooser.prototype.clickHandler = function (e) {\n        var targetElement = e.target;\n        if (!this.isCustomizeOpenCC) {\n            if (!isNullOrUndefined(closest(targetElement, '.e-cc')) || !isNullOrUndefined(closest(targetElement, '.e-cc-toolbar'))) {\n                if (targetElement.classList.contains('e-columnchooser-btn') || targetElement.classList.contains('e-cc-toolbar')) {\n                    if ((this.initialOpenDlg && this.dlgObj.visible) || !this.isDlgOpen) {\n                        this.isDlgOpen = true;\n                        return;\n                    }\n                }\n                else if (targetElement.classList.contains('e-cc-cancel')) {\n                    targetElement.parentElement.querySelector('.e-ccsearch').value = '';\n                    this.columnChooserSearch('');\n                    this.removeCancelIcon();\n                    this.refreshCheckboxButton();\n                }\n            }\n            else {\n                if (!isNullOrUndefined(this.dlgObj) && this.dlgObj.visible && !targetElement.classList.contains('e-toolbar-items')) {\n                    this.dlgObj.hide();\n                    this.clearActions();\n                    this.refreshCheckboxState();\n                    // this.unWireEvents();\n                    this.isDlgOpen = false;\n                }\n            }\n            if (this.parent.detailTemplate || this.parent.childGrid) {\n                this.targetdlg = e.target;\n            }\n        }\n        if (this.isCustomizeOpenCC && e.target.classList.contains('e-cc-cancel')) {\n            this.refreshCheckboxState();\n        }\n        this.rtlUpdate();\n    };\n    ColumnChooser.prototype.hideDialog = function () {\n        if (!isNullOrUndefined(this.dlgObj) && this.dlgObj.visible) {\n            this.dlgObj.hide();\n            // this.unWireEvents();\n            this.isDlgOpen = false;\n        }\n    };\n    /**\n     * To render columnChooser when showColumnChooser enabled.\n     *\n     * @param {number} x - specifies the position x\n     * @param {number} y - specifies the position y\n     * @param {Element} target - specifies the target\n     * @returns {void}\n     * @hidden\n     */\n    ColumnChooser.prototype.renderColumnChooser = function (x, y, target) {\n        if (!this.dlgObj.visible && (this.parent.detailTemplate || this.parent.childGrid)) {\n            this.hideOpenedDialog();\n        }\n        if (!this.dlgObj.visible) {\n            var args = this.beforeOpenColumnChooserEvent();\n            if (args.cancel) {\n                return;\n            }\n            if (target) {\n                this.targetdlg = target;\n            }\n            this.refreshCheckboxState();\n            this.dlgObj.dataBind();\n            this.dlgObj.element.style.maxHeight = '430px';\n            var elementVisible = this.dlgObj.element.style.display;\n            this.dlgObj.element.style.display = 'block';\n            var newpos = calculateRelativeBasedPosition(closest(target, '.e-toolbar-item'), this.dlgObj.element);\n            this.dlgObj.element.style.display = elementVisible;\n            this.dlgObj.element.style.top = newpos.top + closest(target, '.e-cc-toolbar').getBoundingClientRect().height + 'px';\n            var dlgWidth = 250;\n            if (!isNullOrUndefined(closest(target, '.e-bigger'))) {\n                this.dlgObj.width = 258;\n            }\n            if (Browser.isDevice) {\n                this.dlgObj.target = document.body;\n                this.dlgObj.position = { X: 'center', Y: 'center' };\n                this.dlgObj.refreshPosition();\n                this.dlgObj.open = this.mOpenDlg.bind(this);\n            }\n            else {\n                if (this.parent.enableRtl) {\n                    this.dlgObj.element.style.left = target.offsetLeft + 'px';\n                }\n                else {\n                    this.dlgObj.element.style.left = ((newpos.left - dlgWidth) + closest(target, '.e-cc-toolbar').clientWidth) + 2 + 'px';\n                }\n            }\n            this.removeCancelIcon();\n            this.dlgObj.show();\n            this.parent.notify(events.columnChooserOpened, { dialog: this.dlgObj });\n        }\n        else {\n            // this.unWireEvents();\n            this.hideDialog();\n            this.addcancelIcon();\n            this.clearActions();\n            this.refreshCheckboxState();\n        }\n        this.rtlUpdate();\n    };\n    /**\n     * Column chooser can be displayed on screen by given position(X and Y axis).\n     *\n     * @param  {number} X - Defines the X axis.\n     * @param  {number} Y - Defines the Y axis.\n     * @return {void}\n     */\n    ColumnChooser.prototype.openColumnChooser = function (X, Y) {\n        this.isCustomizeOpenCC = true;\n        if (this.dlgObj.visible) {\n            this.hideDialog();\n            return;\n        }\n        var args = this.beforeOpenColumnChooserEvent();\n        if (args.cancel) {\n            return;\n        }\n        if (!this.isInitialOpen) {\n            this.dlgObj.content = this.renderChooserList();\n            this.updateIntermediateBtn();\n        }\n        else {\n            this.refreshCheckboxState();\n        }\n        this.dlgObj.dataBind();\n        this.dlgObj.position = { X: 'center', Y: 'center' };\n        if (isNullOrUndefined(X)) {\n            this.dlgObj.position = { X: 'center', Y: 'center' };\n            this.dlgObj.refreshPosition();\n        }\n        else {\n            this.dlgObj.element.style.top = '';\n            this.dlgObj.element.style.left = '';\n            this.dlgObj.element.style.top = Y + 'px';\n            this.dlgObj.element.style.left = X + 'px';\n        }\n        this.dlgObj.beforeOpen = this.customDialogOpen.bind(this);\n        this.dlgObj.show();\n        this.isInitialOpen = true;\n        this.dlgObj.beforeClose = this.customDialogClose.bind(this);\n    };\n    ColumnChooser.prototype.enableAfterRenderEle = function (e) {\n        if (e.module === this.getModuleName() && e.enable) {\n            this.render();\n        }\n    };\n    ColumnChooser.prototype.keyUpHandler = function (e) {\n        if (e.action === 'escape') {\n            this.hideDialog();\n        }\n    };\n    ColumnChooser.prototype.customDialogOpen = function () {\n        var searchElement = this.dlgObj.content.querySelector('input.e-ccsearch');\n        EventHandler.add(searchElement, 'keyup', this.columnChooserManualSearch, this);\n    };\n    ColumnChooser.prototype.customDialogClose = function () {\n        var searchElement = this.dlgObj.content.querySelector('input.e-ccsearch');\n        EventHandler.remove(searchElement, 'keyup', this.columnChooserManualSearch);\n    };\n    ColumnChooser.prototype.getColumns = function () {\n        var columns = this.parent.getColumns().filter(function (column) { return (column.type !== 'checkbox'\n            && column.showInColumnChooser === true) || (column.type === 'checkbox' && column.field !== undefined); });\n        return columns;\n    };\n    ColumnChooser.prototype.renderDlgContent = function () {\n        this.dlgDiv = this.parent.createElement('div', { className: 'e-ccdlg e-cc', id: this.parent.element.id + '_ccdlg' });\n        this.dlgDiv.setAttribute('aria-label', this.l10n.getConstant('ColumnChooserDialogARIA'));\n        this.parent.element.appendChild(this.dlgDiv);\n        this.dlgObj = new Dialog({\n            header: this.l10n.getConstant('ChooseColumns'),\n            showCloseIcon: false,\n            closeOnEscape: false,\n            locale: this.parent.locale,\n            visible: false,\n            enableRtl: this.parent.enableRtl,\n            target: document.getElementById(this.parent.element.id),\n            buttons: [{\n                    click: this.confirmDlgBtnClick.bind(this),\n                    buttonModel: {\n                        content: this.l10n.getConstant('OKButton'), isPrimary: true,\n                        cssClass: 'e-cc e-cc_okbtn'\n                    }\n                },\n                {\n                    click: this.clearBtnClick.bind(this),\n                    buttonModel: { cssClass: 'e-flat e-cc e-cc-cnbtn', content: this.l10n.getConstant('CancelButton') }\n                }],\n            content: this.renderChooserList(),\n            width: 250,\n            cssClass: 'e-cc',\n            animationSettings: { effect: 'None' }\n        });\n        var isStringTemplate = 'isStringTemplate';\n        this.dlgObj[isStringTemplate] = true;\n        this.dlgObj.appendTo(this.dlgDiv);\n        this.wireEvents();\n    };\n    ColumnChooser.prototype.renderChooserList = function () {\n        this.mainDiv = this.parent.createElement('div', { className: 'e-main-div e-cc' });\n        var searchDiv = this.parent.createElement('div', { className: 'e-cc-searchdiv e-cc e-input-group' });\n        var ccsearchele = this.parent.createElement('input', {\n            className: 'e-ccsearch e-cc e-input',\n            attrs: { placeholder: this.l10n.getConstant('Search') }\n        });\n        var ccsearchicon = this.parent.createElement('span', {\n            className: 'e-ccsearch-icon e-icons e-cc e-input-group-icon',\n            attrs: { title: this.l10n.getConstant('Search') }\n        });\n        var conDiv = this.parent.createElement('div', { className: 'e-cc-contentdiv' });\n        this.innerDiv = this.parent.createElement('div', { className: 'e-innerdiv e-cc' });\n        searchDiv.appendChild(ccsearchele);\n        searchDiv.appendChild(ccsearchicon);\n        this.searchBoxObj = new SearchBox(ccsearchele);\n        var innerDivContent = this.refreshCheckboxList(this.parent.getColumns());\n        this.innerDiv.appendChild(innerDivContent);\n        conDiv.appendChild(this.innerDiv);\n        this.mainDiv.appendChild(searchDiv);\n        this.mainDiv.appendChild(conDiv);\n        return this.mainDiv;\n    };\n    ColumnChooser.prototype.confirmDlgBtnClick = function (args) {\n        this.stateChangeColumns = [];\n        this.changedStateColumns = [];\n        this.changedColumns = (this.changedColumns.length > 0) ? this.changedColumns : this.unchangedColumns;\n        this.changedColumnState(this.changedColumns);\n        var uncheckedLength = this.ulElement.querySelector('.e-uncheck') &&\n            this.ulElement.querySelectorAll('.e-uncheck:not(.e-selectall)').length;\n        if (!isNullOrUndefined(args)) {\n            if (uncheckedLength < this.parent.getColumns().length) {\n                if (this.hideColumn.length) {\n                    this.columnStateChange(this.hideColumn, false);\n                }\n                if (this.showColumn.length) {\n                    this.columnStateChange(this.showColumn, true);\n                }\n                this.getShowHideService.setVisible(this.stateChangeColumns, this.changedStateColumns);\n                this.clearActions();\n                this.parent.notify(events.tooltipDestroy, { module: 'edit' });\n                if (this.parent.getCurrentViewRecords().length === 0) {\n                    var emptyRowCell = this.parent.element.querySelector('.e-emptyrow').querySelector('td');\n                    emptyRowCell.setAttribute('colSpan', this.parent.getVisibleColumns().length.toString());\n                }\n            }\n        }\n    };\n    ColumnChooser.prototype.onResetColumns = function (e) {\n        if (e.requestType === 'columnstate') {\n            this.resetColumnState();\n            return;\n        }\n    };\n    ColumnChooser.prototype.resetColumnState = function () {\n        this.showColumn = [];\n        this.hideColumn = [];\n        this.hideDialog();\n    };\n    ColumnChooser.prototype.changedColumnState = function (changedColumns) {\n        for (var index = 0; index < changedColumns.length; index++) {\n            var colUid = changedColumns[index];\n            var currentCol = this.parent.getColumnByUid(colUid);\n            this.changedStateColumns.push(currentCol);\n        }\n    };\n    ColumnChooser.prototype.columnStateChange = function (stateColumns, state) {\n        for (var index = 0; index < stateColumns.length; index++) {\n            var colUid = stateColumns[index];\n            var currentCol = this.parent.getColumnByUid(colUid);\n            if (currentCol.type !== 'checkbox') {\n                currentCol.visible = state;\n            }\n            this.stateChangeColumns.push(currentCol);\n        }\n    };\n    ColumnChooser.prototype.clearActions = function () {\n        this.resetColumnState();\n        this.addcancelIcon();\n    };\n    ColumnChooser.prototype.clearBtnClick = function () {\n        this.clearActions();\n        this.parent.notify(events.columnChooserCancelBtnClick, { dialog: this.dlgObj });\n    };\n    ColumnChooser.prototype.checkstatecolumn = function (isChecked, coluid, selectAll) {\n        if (selectAll === void 0) { selectAll = false; }\n        if (isChecked) {\n            if (this.hideColumn.indexOf(coluid) !== -1) {\n                this.hideColumn.splice(this.hideColumn.indexOf(coluid), 1);\n            }\n            if (this.showColumn.indexOf(coluid) === -1) {\n                this.showColumn.push(coluid);\n            }\n        }\n        else {\n            if (this.showColumn.indexOf(coluid) !== -1) {\n                this.showColumn.splice(this.showColumn.indexOf(coluid), 1);\n            }\n            if (this.hideColumn.indexOf(coluid) === -1) {\n                this.hideColumn.push(coluid);\n            }\n        }\n        if (selectAll) {\n            if (!isChecked) {\n                this.changedColumns.push(coluid);\n            }\n            else {\n                this.unchangedColumns.push(coluid);\n            }\n        }\n        else if (this.changedColumns.indexOf(coluid) !== -1) {\n            this.changedColumns.splice(this.changedColumns.indexOf(coluid), 1);\n        }\n        else {\n            this.changedColumns.push(coluid);\n        }\n    };\n    ColumnChooser.prototype.columnChooserSearch = function (searchVal) {\n        var clearSearch = false;\n        var fltrCol;\n        var okButton;\n        var buttonEle = this.dlgDiv.querySelector('.e-footer-content');\n        var selectedCbox = this.ulElement.querySelector('.e-check') &&\n            this.ulElement.querySelectorAll('.e-check:not(.e-selectall)').length;\n        this.isInitialOpen = true;\n        if (buttonEle) {\n            okButton = buttonEle.querySelector('.e-btn').ej2_instances[0];\n        }\n        if (searchVal === '') {\n            this.removeCancelIcon();\n            fltrCol = this.getColumns();\n            clearSearch = true;\n        }\n        else {\n            fltrCol = new DataManager(this.getColumns()).executeLocal(new Query()\n                .where('headerText', this.searchOperator, searchVal, true, this.parent.columnChooserSettings.ignoreAccent));\n        }\n        if (fltrCol.length) {\n            this.innerDiv.innerHTML = ' ';\n            this.innerDiv.classList.remove('e-ccnmdiv');\n            this.innerDiv.appendChild(this.refreshCheckboxList(fltrCol));\n            if (!clearSearch) {\n                this.addcancelIcon();\n                this.refreshCheckboxButton();\n            }\n            else {\n                if (okButton && selectedCbox) {\n                    okButton.disabled = false;\n                }\n            }\n        }\n        else {\n            var nMatchele = this.parent.createElement('span', { className: 'e-cc e-nmatch' });\n            nMatchele.innerHTML = this.l10n.getConstant('Matchs');\n            this.innerDiv.innerHTML = ' ';\n            this.innerDiv.appendChild(nMatchele);\n            this.innerDiv.classList.add('e-ccnmdiv');\n            if (okButton) {\n                okButton.disabled = true;\n            }\n        }\n        this.flag = true;\n        this.stopTimer();\n    };\n    ColumnChooser.prototype.wireEvents = function () {\n        EventHandler.add(this.dlgObj.element, 'click', this.checkBoxClickHandler, this);\n        EventHandler.add(this.searchBoxObj.searchBox, 'keyup', this.columnChooserManualSearch, this);\n        this.searchBoxObj.wireEvent();\n    };\n    ColumnChooser.prototype.unWireEvents = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        if (this.dlgObj.element) {\n            EventHandler.remove(this.dlgObj.element, 'click', this.checkBoxClickHandler);\n        }\n        EventHandler.remove(this.searchBoxObj.searchBox, 'keyup', this.columnChooserManualSearch);\n        this.searchBoxObj.unWireEvent();\n    };\n    ColumnChooser.prototype.checkBoxClickHandler = function (e) {\n        var checkstate;\n        var elem = parentsUntil(e.target, 'e-checkbox-wrapper');\n        if (elem) {\n            var selectAll = elem.querySelector('.e-selectall');\n            if (selectAll) {\n                this.updateSelectAll(!elem.querySelector('.e-check'));\n            }\n            else {\n                toogleCheckbox(elem.parentElement);\n            }\n            elem.querySelector('.e-chk-hidden').focus();\n            if (elem.querySelector('.e-check')) {\n                checkstate = true;\n            }\n            else if (elem.querySelector('.e-uncheck')) {\n                checkstate = false;\n            }\n            else {\n                return;\n            }\n            this.updateIntermediateBtn();\n            var columnUid = parentsUntil(elem, 'e-ccheck').getAttribute('uid');\n            var column = this.parent.getColumns();\n            if (columnUid === 'grid-selectAll') {\n                this.changedColumns = [];\n                this.unchangedColumns = [];\n                for (var i = 0; i < column.length; i++) {\n                    if (column[i].showInColumnChooser) {\n                        this.checkstatecolumn(checkstate, column[i].uid, true);\n                    }\n                }\n            }\n            else {\n                this.checkstatecolumn(checkstate, columnUid);\n            }\n            this.refreshCheckboxButton();\n        }\n    };\n    ColumnChooser.prototype.updateIntermediateBtn = function () {\n        var cnt = this.ulElement.children.length - 1;\n        var className = [];\n        var elem = this.ulElement.children[0].querySelector('.e-frame');\n        var selected = this.ulElement.querySelectorAll('.e-check:not(.e-selectall)').length;\n        var btn = this.dlgObj.btnObj[0];\n        btn.disabled = false;\n        if (cnt === selected) {\n            className = ['e-check'];\n        }\n        else if (selected) {\n            className = ['e-stop'];\n        }\n        else {\n            className = ['e-uncheck'];\n            btn.disabled = true;\n        }\n        btn.dataBind();\n        removeClass([elem], ['e-check', 'e-stop', 'e-uncheck']);\n        addClass([elem], className);\n    };\n    ColumnChooser.prototype.updateSelectAll = function (checked) {\n        var cBoxes = [].slice.call(this.ulElement.getElementsByClassName('e-frame'));\n        for (var _i = 0, cBoxes_1 = cBoxes; _i < cBoxes_1.length; _i++) {\n            var cBox = cBoxes_1[_i];\n            removeAddCboxClasses(cBox, checked);\n        }\n    };\n    ColumnChooser.prototype.refreshCheckboxButton = function () {\n        var visibleCols = this.parent.getVisibleColumns();\n        for (var i = 0; i < visibleCols.length; i++) {\n            var columnUID = visibleCols[i].uid;\n            if (this.prevShowedCols.indexOf(columnUID) === -1) {\n                this.prevShowedCols.push(columnUID);\n            }\n        }\n        for (var i = 0; i < this.hideColumn.length; i++) {\n            var index = this.prevShowedCols.indexOf(this.hideColumn[i]);\n            if (index !== -1) {\n                this.prevShowedCols.splice(index, 1);\n            }\n        }\n        var selected = this.showColumn.length !== 0 ? 1 : this.prevShowedCols.length;\n        var btn = this.dlgDiv.querySelector('.e-footer-content').querySelector('.e-btn').ej2_instances[0];\n        btn.disabled = false;\n        var srchShowCols = [];\n        var searchData = [].slice.call(this.parent.element.getElementsByClassName('e-cc-chbox'));\n        for (var i = 0, itemsLen = searchData.length; i < itemsLen; i++) {\n            var element = searchData[i];\n            var columnUID = parentsUntil(element, 'e-ccheck').getAttribute('uid');\n            srchShowCols.push(columnUID);\n        }\n        var hideCols = this.showColumn.filter(function (column) { return srchShowCols.indexOf(column) !== -1; });\n        if (selected === 0 && hideCols.length === 0) {\n            btn.disabled = true;\n        }\n        btn.dataBind();\n    };\n    ColumnChooser.prototype.refreshCheckboxList = function (gdCol) {\n        this.ulElement = this.parent.createElement('ul', { className: 'e-ccul-ele e-cc' });\n        var selectAllValue = this.l10n.getConstant('SelectAll');\n        var cclist = this.parent.createElement('li', { className: 'e-cclist e-cc e-cc-selectall' });\n        var selectAll = this.createCheckBox(selectAllValue, false, 'grid-selectAll');\n        if (gdCol.length) {\n            selectAll.querySelector('.e-checkbox-wrapper').firstElementChild.classList.add('e-selectall');\n            selectAll.querySelector('.e-frame').classList.add('e-selectall');\n            this.checkState(selectAll.querySelector('.e-icons'), true);\n            cclist.appendChild(selectAll);\n            this.ulElement.appendChild(cclist);\n        }\n        for (var i = 0; i < gdCol.length; i++) {\n            var columns = gdCol[i];\n            this.renderCheckbox(columns);\n        }\n        return this.ulElement;\n    };\n    ColumnChooser.prototype.refreshCheckboxState = function () {\n        this.dlgObj.element.querySelector('.e-cc.e-input').value = '';\n        this.columnChooserSearch('');\n        var gridObject = this.parent;\n        var currentCheckBoxColls = this.dlgObj.element.querySelectorAll('.e-cc-chbox:not(.e-selectall)');\n        for (var i = 0, itemLen = currentCheckBoxColls.length; i < itemLen; i++) {\n            var element = currentCheckBoxColls[i];\n            var columnUID = void 0;\n            if (this.parent.childGrid || this.parent.detailTemplate) {\n                columnUID = parentsUntil(this.dlgObj.element.querySelectorAll('.e-cc-chbox:not(.e-selectall)')[i], 'e-ccheck').getAttribute('uid');\n            }\n            else {\n                columnUID = parentsUntil(element, 'e-ccheck').getAttribute('uid');\n            }\n            var column = gridObject.getColumnByUid(columnUID);\n            var uncheck = [].slice.call(element.parentElement.getElementsByClassName('e-uncheck'));\n            if (column.visible && !uncheck.length) {\n                element.checked = true;\n                this.checkState(element.parentElement.querySelector('.e-icons'), true);\n            }\n            else {\n                element.checked = false;\n                this.checkState(element.parentElement.querySelector('.e-icons'), false);\n            }\n        }\n    };\n    ColumnChooser.prototype.checkState = function (element, state) {\n        if (state) {\n            classList(element, ['e-check'], ['e-uncheck']);\n        }\n        else {\n            classList(element, ['e-uncheck'], ['e-check']);\n        }\n    };\n    ColumnChooser.prototype.createCheckBox = function (label, checked, uid) {\n        var cbox = checked ? this.cBoxTrue.cloneNode(true) : this.cBoxFalse.cloneNode(true);\n        cbox.querySelector('.e-label').innerHTML = label;\n        return createCboxWithWrap(uid, cbox, 'e-ccheck');\n    };\n    ColumnChooser.prototype.renderCheckbox = function (column) {\n        var cclist;\n        var hideColState;\n        var showColState;\n        if (column.showInColumnChooser) {\n            cclist = this.parent.createElement('li', { className: 'e-cclist e-cc', styles: 'list-style:None', id: 'e-ccli_' + column.uid });\n            hideColState = this.hideColumn.indexOf(column.uid) === -1 ? false : true;\n            showColState = this.showColumn.indexOf(column.uid) === -1 ? false : true;\n            var cccheckboxlist = this.createCheckBox(column.headerText, (column.visible && !hideColState) || showColState, column.uid);\n            cclist.appendChild(cccheckboxlist);\n            this.ulElement.appendChild(cclist);\n        }\n        if (this.isInitialOpen) {\n            this.updateIntermediateBtn();\n        }\n    };\n    ColumnChooser.prototype.columnChooserManualSearch = function (e) {\n        this.addcancelIcon();\n        this.searchValue = e.target.value;\n        this.stopTimer();\n        this.startTimer(e);\n    };\n    ColumnChooser.prototype.startTimer = function (e) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var interval = !proxy.flag && e.keyCode !== 13 ? 500 : 0;\n        this.timer = window.setInterval(function () { proxy.columnChooserSearch(proxy.searchValue); }, interval);\n    };\n    ColumnChooser.prototype.stopTimer = function () {\n        window.clearInterval(this.timer);\n    };\n    ColumnChooser.prototype.addcancelIcon = function () {\n        this.dlgDiv.querySelector('.e-cc.e-ccsearch-icon').classList.add('e-cc-cancel');\n    };\n    ColumnChooser.prototype.removeCancelIcon = function () {\n        this.dlgDiv.querySelector('.e-cc.e-ccsearch-icon').classList.remove('e-cc-cancel');\n    };\n    ColumnChooser.prototype.mOpenDlg = function () {\n        if (Browser.isDevice) {\n            this.dlgObj.element.querySelector('.e-cc-searchdiv').classList.remove('e-input-focus');\n            this.dlgObj.element.querySelectorAll('.e-cc-chbox')[0].focus();\n        }\n    };\n    // internally use\n    ColumnChooser.prototype.getModuleName = function () {\n        return 'columnChooser';\n    };\n    ColumnChooser.prototype.hideOpenedDialog = function () {\n        var openCC = [].slice.call(document.getElementsByClassName('e-ccdlg')).filter(function (dlgEle) {\n            return dlgEle.classList.contains('e-popup-open');\n        });\n        for (var i = 0, dlgLen = openCC.length; i < dlgLen; i++) {\n            if (openCC[i].classList.contains('e-dialog') || this.parent.element.id + '_ccdlg' !== openCC[i].id) {\n                openCC[i].ej2_instances[0].hide();\n            }\n        }\n    };\n    ColumnChooser.prototype.beforeOpenColumnChooserEvent = function () {\n        var args1 = {\n            requestType: 'beforeOpenColumnChooser', element: this.parent.element,\n            columns: this.getColumns(), cancel: false,\n            searchOperator: this.parent.columnChooserSettings.operator\n        };\n        this.parent.trigger(events.beforeOpenColumnChooser, args1);\n        this.searchOperator = args1.searchOperator;\n        return args1;\n    };\n    return ColumnChooser;\n}());\nexport { ColumnChooser };\n"]},"metadata":{},"sourceType":"module"}