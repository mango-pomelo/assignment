{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { remove, createElement, closest, formatUnit, Browser, extend } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, removeClass } from '@syncfusion/ej2-base';\nimport { DataManager } from '@syncfusion/ej2-data';\nimport { dataReady, modelChanged, refreshVirtualBlock, contentReady } from '../base/constant';\nimport * as events from '../base/constant';\nimport { RenderType } from '../base/enum';\nimport { ContentRender } from './content-renderer';\nimport { HeaderRender } from './header-renderer';\nimport { InterSectionObserver } from '../services/intersection-observer';\nimport { VirtualRowModelGenerator } from '../services/virtual-row-model-generator';\nimport { isGroupAdaptive, ensureLastRow, ensureFirstRow, getEditedDataIndex, getTransformValues, resetRowObjectIndex } from '../base/util';\nimport { setStyleAttribute } from '@syncfusion/ej2-base';\nimport * as literals from '../base/string-literals';\n/**\n * VirtualContentRenderer\n *\n * @hidden\n */\n\nvar VirtualContentRenderer =\n/** @class */\nfunction (_super) {\n  __extends(VirtualContentRenderer, _super);\n\n  function VirtualContentRenderer(parent, locator) {\n    var _this = _super.call(this, parent, locator) || this;\n\n    _this.prevHeight = 0;\n    /** @hidden */\n\n    _this.startIndex = 0;\n    _this.preStartIndex = 0;\n    _this.preventEvent = false;\n    _this.actions = ['filtering', 'searching', 'grouping', 'ungrouping'];\n    /** @hidden */\n\n    _this.offsets = {};\n    _this.tmpOffsets = {};\n    /** @hidden */\n\n    _this.virtualEle = new VirtualElementHandler();\n    _this.offsetKeys = [];\n    _this.isFocused = false;\n    _this.isSelection = false;\n    _this.isBottom = false;\n    _this.rndrCount = 0;\n    _this.empty = undefined;\n    _this.isCancel = false;\n    _this.requestTypes = ['beginEdit', 'cancel', 'delete', 'add', 'save'];\n    _this.isNormaledit = _this.parent.editSettings.mode === 'Normal';\n    /** @hidden */\n\n    _this.virtualData = {};\n    _this.emptyRowData = {};\n    _this.vfColIndex = [];\n    _this.frzIdx = 1;\n    _this.orderRowObj = [];\n    _this.mvbOrderRowObj = [];\n    _this.frOrderRowObj = [];\n    _this.isContextMenuOpen = false;\n    _this.isSelectionScroll = false;\n    _this.validationCheck = false;\n    _this.locator = locator;\n\n    _this.eventListener('on');\n\n    _this.parent.on(events.columnVisibilityChanged, _this.setVisible, _this);\n\n    _this.vgenerator = _this.generator;\n    return _this;\n  }\n\n  VirtualContentRenderer.prototype.renderTable = function () {\n    this.header = this.locator.getService('rendererFactory').getRenderer(RenderType.Header);\n\n    _super.prototype.renderTable.call(this);\n\n    this.virtualEle.table = this.getTable();\n    this.virtualEle.content = this.content = this.getPanel().querySelector('.' + literals.content);\n    this.virtualEle.renderWrapper(this.parent.height);\n    this.virtualEle.renderPlaceHolder();\n    this.virtualEle.wrapper.style.position = 'absolute';\n    var debounceEvent = this.parent.dataSource instanceof DataManager && !this.parent.dataSource.dataSource.offline;\n    var opt = {\n      container: this.content,\n      pageHeight: this.getBlockHeight() * 2,\n      debounceEvent: debounceEvent,\n      axes: this.parent.enableColumnVirtualization ? ['X', 'Y'] : ['Y']\n    };\n    this.observer = new InterSectionObserver(this.virtualEle.wrapper, opt);\n  };\n\n  VirtualContentRenderer.prototype.renderEmpty = function (tbody) {\n    this.getTable().appendChild(tbody);\n    this.virtualEle.adjustTable(0, 0);\n  };\n\n  VirtualContentRenderer.prototype.getReorderedFrozenRows = function (args) {\n    var blockIndex = args.virtualInfo.blockIndexes;\n    var colsIndex = args.virtualInfo.columnIndexes;\n    var page = args.virtualInfo.page;\n    args.virtualInfo.blockIndexes = [1, 2];\n    args.virtualInfo.page = 1;\n\n    if (!args.renderMovableContent) {\n      args.virtualInfo.columnIndexes = [];\n    }\n\n    var recordslength = this.parent.getCurrentViewRecords().length;\n    var firstRecords = this.parent.renderModule.data.dataManager.dataSource.json.slice(0, recordslength);\n    var virtualRows = this.vgenerator.generateRows(firstRecords, args);\n    args.virtualInfo.blockIndexes = blockIndex;\n    args.virtualInfo.columnIndexes = colsIndex;\n    args.virtualInfo.page = page;\n    return virtualRows.splice(0, this.parent.frozenRows);\n  };\n\n  VirtualContentRenderer.prototype.scrollListener = function (scrollArgs) {\n    this.scrollAfterEdit();\n\n    if (this.parent.enablePersistence) {\n      this.parent.scrollPosition = scrollArgs.offset;\n    }\n\n    if (this.preventEvent || this.parent.isDestroyed) {\n      this.preventEvent = false;\n      return;\n    }\n\n    if (isNullOrUndefined(document.activeElement)) {\n      this.isFocused = false;\n    } else {\n      this.isFocused = this.content === closest(document.activeElement, '.' + literals.content) || this.content === document.activeElement;\n    }\n\n    var info = scrollArgs.sentinel;\n    var viewInfo = this.currentInfo = this.getInfoFromView(scrollArgs.direction, info, scrollArgs.offset);\n\n    if (isGroupAdaptive(this.parent)) {\n      if (info.axis === 'Y' && viewInfo.blockIndexes && this.prevInfo.blockIndexes.toString() === viewInfo.blockIndexes.toString() && scrollArgs.direction === 'up' && viewInfo.blockIndexes[viewInfo.blockIndexes.length - 1] !== 2) {\n        return;\n      } else {\n        viewInfo.event = 'refresh-virtual-block';\n\n        if (!isNullOrUndefined(viewInfo.offsets)) {\n          viewInfo.offsets.top = this.content.scrollTop;\n        }\n\n        this.parent.notify(viewInfo.event, {\n          requestType: 'virtualscroll',\n          virtualInfo: viewInfo,\n          focusElement: scrollArgs.focusElement\n        });\n        return;\n      }\n    }\n\n    if (this.prevInfo && (info.axis === 'Y' && this.prevInfo.blockIndexes.toString() === viewInfo.blockIndexes.toString() || info.axis === 'X' && this.prevInfo.columnIndexes.toString() === viewInfo.columnIndexes.toString())) {\n      if (Browser.isIE) {\n        this.parent.hideSpinner();\n      }\n\n      this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n\n      if (info.axis === 'Y') {\n        this.restoreEdit();\n      }\n\n      return;\n    }\n\n    this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization ? viewInfo.columnIndexes : []);\n    this.parent.pageSettings.currentPage = viewInfo.loadNext && !viewInfo.loadSelf ? viewInfo.nextInfo.page : viewInfo.page;\n    this.requestType = 'virtualscroll';\n    this.parent.notify(viewInfo.event, {\n      requestType: 'virtualscroll',\n      virtualInfo: viewInfo,\n      focusElement: scrollArgs.focusElement\n    });\n  };\n\n  VirtualContentRenderer.prototype.block = function (blk) {\n    return this.vgenerator.isBlockAvailable(blk);\n  };\n\n  VirtualContentRenderer.prototype.getInfoFromView = function (direction, info, e) {\n    var isBlockAdded = false;\n    var tempBlocks = [];\n    var infoType = {\n      direction: direction,\n      sentinelInfo: info,\n      offsets: e,\n      startIndex: this.preStartIndex,\n      endIndex: this.preEndIndex\n    };\n    infoType.page = this.getPageFromTop(e.top, infoType);\n    infoType.blockIndexes = tempBlocks = this.vgenerator.getBlockIndexes(infoType.page);\n    infoType.loadSelf = !this.vgenerator.isBlockAvailable(tempBlocks[infoType.block]);\n    var blocks = this.ensureBlocks(infoType);\n\n    if (this.activeKey === 'upArrow' && infoType.blockIndexes.toString() !== blocks.toString()) {\n      // To avoid dupilcate row index problem in key focus support\n      var newBlock = blocks[blocks.length - 1];\n\n      if (infoType.blockIndexes.indexOf(newBlock) === -1) {\n        isBlockAdded = true;\n      }\n    }\n\n    infoType.blockIndexes = blocks;\n    infoType.loadNext = !blocks.filter(function (val) {\n      return tempBlocks.indexOf(val) === -1;\n    }).every(this.block.bind(this));\n    infoType.event = infoType.loadNext || infoType.loadSelf ? modelChanged : refreshVirtualBlock;\n    infoType.nextInfo = infoType.loadNext ? {\n      page: Math.max(1, infoType.page + (direction === 'down' ? 1 : -1))\n    } : {};\n\n    if (isBlockAdded) {\n      infoType.blockIndexes = [infoType.blockIndexes[0] - 1, infoType.blockIndexes[0], infoType.blockIndexes[0] + 1];\n    }\n\n    if (this.activeKey === 'downArrow') {\n      var firstBlock = Math.ceil(this.rowIndex / this.getBlockSize());\n\n      if (firstBlock !== 1 && (infoType.blockIndexes[1] !== firstBlock || infoType.blockIndexes.length < 3)) {\n        infoType.blockIndexes = [firstBlock - 1, firstBlock, firstBlock + 1];\n      }\n    }\n\n    infoType.columnIndexes = info.axis === 'X' ? this.vgenerator.getColumnIndexes() : this.parent.getColumnIndexesInView();\n\n    if (this.parent.enableColumnVirtualization && info.axis === 'X') {\n      infoType.event = refreshVirtualBlock;\n    }\n\n    return infoType;\n  };\n\n  VirtualContentRenderer.prototype.setKeyboardNavIndex = function () {\n    this.blazorDataLoad = true;\n\n    if (this.activeKey === 'downArrow' || this.activeKey === 'upArrow') {\n      this.blzRowIndex = this.activeKey === 'downArrow' ? this.rowIndex + 1 : this.rowIndex - 1;\n      document.activeElement.blur();\n    }\n  };\n\n  VirtualContentRenderer.prototype.ensureBlocks = function (info) {\n    var _this = this;\n\n    var index = info.blockIndexes[info.block];\n    var mIdx;\n    var old = index;\n    var max = Math.max;\n    var indexes = info.direction === 'down' ? [max(index, 1), ++index, ++index] : [max(index - 1, 1), index, index + 1];\n\n    if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid()) {\n      // To avoid frozen content white space issue\n      if (info.sentinelInfo.axis === 'X' || info.sentinelInfo.axis === 'Y' && info.page === this.prevInfo.page) {\n        indexes = this.prevInfo.blockIndexes;\n      }\n    }\n\n    indexes = indexes.filter(function (val, ind) {\n      return indexes.indexOf(val) === ind;\n    });\n\n    if (this.prevInfo.blockIndexes.toString() === indexes.toString()) {\n      return indexes;\n    }\n\n    if (info.loadSelf || info.direction === 'down' && this.isEndBlock(old)) {\n      indexes = this.vgenerator.getBlockIndexes(info.page);\n    }\n\n    indexes.some(function (val, ind) {\n      var result = val === (isGroupAdaptive(_this.parent) ? _this.getGroupedTotalBlocks() : _this.getTotalBlocks());\n\n      if (result) {\n        mIdx = ind;\n      }\n\n      return result;\n    });\n\n    if (mIdx !== undefined) {\n      indexes = indexes.slice(0, mIdx + 1);\n\n      if (info.block === 0 && indexes.length === 1 && this.vgenerator.isBlockAvailable(indexes[0] - 1)) {\n        indexes = [indexes[0] - 1, indexes[0]];\n      }\n    }\n\n    return indexes;\n  }; // tslint:disable-next-line:max-func-body-length\n\n\n  VirtualContentRenderer.prototype.appendContent = function (target, newChild, e) {\n    var _this = this; // currentInfo value will be used if there are multiple dom updates happened due to mousewheel\n\n\n    var isFrozen = this.parent.isFrozenGrid();\n    var frzCols = this.parent.getFrozenColumns() || this.parent.getFrozenLeftColumnsCount();\n    var colVFtable = this.parent.enableColumnVirtualization && isFrozen;\n    this.checkFirstBlockColIndexes(e);\n    var info = e.virtualInfo.sentinelInfo && e.virtualInfo.sentinelInfo.axis === 'Y' && this.currentInfo.page && this.currentInfo.page !== e.virtualInfo.page ? this.currentInfo : e.virtualInfo;\n    this.prevInfo = this.prevInfo || e.virtualInfo;\n    var cBlock = info.columnIndexes[0] - 1;\n\n    if (colVFtable && info.columnIndexes[0] === frzCols) {\n      cBlock = info.columnIndexes[0] - frzCols - 1;\n    }\n\n    var cOffset = this.getColumnOffset(cBlock);\n    var width;\n    var blocks = info.blockIndexes;\n\n    if (this.parent.groupSettings.columns.length) {\n      this.refreshOffsets();\n    }\n\n    if (this.parent.height === '100%') {\n      this.parent.element.style.height = '100%';\n    }\n\n    var vHeight = this.parent.height.toString().indexOf('%') < 0 ? this.content.getBoundingClientRect().height : this.parent.element.getBoundingClientRect().height;\n\n    if (!this.requestTypes.some(function (value) {\n      return value === _this.requestType;\n    })) {\n      var translate = this.getTranslateY(this.content.scrollTop, vHeight, info);\n      this.virtualEle.adjustTable(colVFtable ? 0 : cOffset, translate);\n\n      if (colVFtable) {\n        this.virtualEle.adjustMovableTable(cOffset, 0);\n      }\n    }\n\n    if (this.parent.enableColumnVirtualization) {\n      this.header.virtualEle.adjustTable(colVFtable ? 0 : cOffset, 0);\n\n      if (colVFtable) {\n        this.header.virtualEle.adjustMovableTable(cOffset, 0);\n      }\n    }\n\n    if (this.parent.enableColumnVirtualization) {\n      var cIndex = info.columnIndexes;\n      width = this.getColumnOffset(cIndex[cIndex.length - 1]) - this.getColumnOffset(cIndex[0] - 1) + '';\n\n      if (colVFtable) {\n        this.header.virtualEle.setMovableWrapperWidth(width);\n      } else {\n        this.header.virtualEle.setWrapperWidth(width);\n      }\n    }\n\n    if (colVFtable) {\n      this.virtualEle.setMovableWrapperWidth(width, Browser.isIE || Browser.info.name === 'edge');\n    } else {\n      this.virtualEle.setWrapperWidth(width, Browser.isIE || Browser.info.name === 'edge');\n    }\n\n    if (!isNullOrUndefined(target.parentNode)) {\n      remove(target);\n    }\n\n    var tbody;\n\n    if (isFrozen) {\n      if (e.renderFrozenRightContent) {\n        tbody = this.parent.getContent().querySelector('.e-frozen-right-content').querySelector(literals.tbody);\n      } else if (!e.renderMovableContent) {\n        tbody = this.parent.getFrozenVirtualContent().querySelector(literals.tbody);\n      } else if (e.renderMovableContent) {\n        tbody = this.parent.getMovableVirtualContent().querySelector(literals.tbody);\n      }\n    } else {\n      tbody = this.parent.element.querySelector('.' + literals.content).querySelector(literals.tbody);\n    }\n\n    if (tbody) {\n      remove(tbody);\n      target = null;\n    }\n\n    var isReact = this.parent.isReact && !isNullOrUndefined(this.parent.rowTemplate);\n\n    if (!isReact) {\n      target = this.parent.createElement(literals.tbody);\n      target.appendChild(newChild);\n    } else {\n      target = newChild;\n    }\n\n    if (this.parent.frozenRows && e.requestType === 'virtualscroll' && this.parent.pageSettings.currentPage === 1) {\n      for (var i = 0; i < this.parent.frozenRows; i++) {\n        target.children[0].remove();\n      }\n    }\n\n    if (isFrozen) {\n      if (e.renderFrozenRightContent) {\n        this.parent.getContent().querySelector('.e-frozen-right-content').querySelector('.' + literals.table).appendChild(target);\n        this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n      } else if (!e.renderMovableContent) {\n        this.parent.getFrozenVirtualContent().querySelector('.' + literals.table).appendChild(target);\n      } else if (e.renderMovableContent) {\n        this.parent.getMovableVirtualContent().querySelector('.' + literals.table).appendChild(target);\n\n        if (this.parent.getFrozenMode() !== literals.leftRight) {\n          this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n        }\n      }\n\n      if (this.vfColIndex.length) {\n        e.virtualInfo.columnIndexes = info.columnIndexes = extend([], this.vfColIndex);\n        this.vfColIndex = e.renderMovableContent ? [] : this.vfColIndex;\n      }\n    } else {\n      this.getTable().appendChild(target);\n      this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n    }\n\n    if (this.parent.groupSettings.columns.length) {\n      if (!isGroupAdaptive(this.parent) && info.direction === 'up') {\n        var blk = this.offsets[this.getTotalBlocks()] - this.prevHeight;\n        this.preventEvent = true;\n        var sTop = this.content.scrollTop;\n        this.content.scrollTop = sTop + blk;\n      }\n\n      this.setVirtualHeight();\n      this.observer.setPageHeight(this.getOffset(blocks[blocks.length - 1]) - this.getOffset(blocks[0] - 1));\n    }\n\n    this.prevInfo = info;\n\n    if (this.isFocused && this.activeKey !== 'downArrow' && this.activeKey !== 'upArrow') {\n      this.content.focus();\n    }\n\n    var lastPage = Math.ceil(this.getTotalBlocks() / 2);\n\n    if (this.isBottom) {\n      this.isBottom = false;\n      this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 1];\n    }\n\n    if (this.parent.pageSettings.currentPage === lastPage && blocks.length === 1) {\n      this.isBottom = true;\n      this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 2];\n    }\n\n    if (e.requestType === 'virtualscroll' && e.virtualInfo.sentinelInfo.axis === 'X') {\n      this.parent.notify(events.autoCol, {});\n    }\n\n    this.focusCell(e);\n    this.restoreEdit(e);\n    this.restoreAdd(e);\n    this.ensureSelectedRowPosition();\n    this.validationScrollLeft(e, isFrozen);\n\n    if (!this.initialRowTop) {\n      var gridTop = this.parent.element.getBoundingClientRect().top;\n      this.initialRowTop = this.parent.getRowByIndex(0).getBoundingClientRect().top - gridTop;\n    }\n  };\n\n  VirtualContentRenderer.prototype.validationScrollLeft = function (e, isFrozen) {\n    var left = this.parent.getFrozenColumns();\n    var table = this.parent.getFrozenMode();\n    var trigger = !isFrozen || e && (left || table === 'Left' || table === 'Right' ? e.renderMovableContent : e.renderFrozenRightContent);\n\n    if (this.validationCheck && trigger) {\n      if (this.validationCol) {\n        var offset = this.vgenerator.cOffsets[this.validationCol.index - this.parent.getVisibleFrozenColumns() - 1];\n        this.validationCol = null;\n\n        if (this.parent.isFrozenGrid()) {\n          this.movableContent.scrollLeft = offset;\n        } else {\n          this.content.scrollLeft = offset;\n        }\n      } else {\n        this.validationCheck = false;\n        this.parent.editModule.editFormValidate();\n      }\n    }\n  };\n\n  VirtualContentRenderer.prototype.ensureSelectedRowPosition = function () {\n    if (!this.isSelection && this.isSelectionScroll && !isNullOrUndefined(this.selectRowIndex)) {\n      this.isSelectionScroll = false;\n      var row = this.parent.getRowByIndex(this.selectRowIndex);\n\n      if (row && !this.isRowInView(row)) {\n        this.rowSelected({\n          rowIndex: this.selectRowIndex,\n          row: row\n        }, true);\n      }\n    }\n  };\n\n  VirtualContentRenderer.prototype.checkFirstBlockColIndexes = function (e) {\n    if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid() && e.virtualInfo.columnIndexes[0] === 0) {\n      var indexes = [];\n      var frozenCols = this.parent.getFrozenColumns() || this.parent.getFrozenLeftColumnsCount();\n\n      if (!e.renderMovableContent && e.virtualInfo.columnIndexes.length > frozenCols) {\n        this.vfColIndex = e.virtualInfo.columnIndexes;\n\n        for (var i = 0; i < frozenCols; i++) {\n          indexes.push(i);\n        }\n\n        e.virtualInfo.columnIndexes = indexes;\n      } else if (e.renderMovableContent) {\n        if (!this.vfColIndex.length) {\n          this.vfColIndex = extend([], e.virtualInfo.columnIndexes);\n        }\n\n        e.virtualInfo.columnIndexes = extend([], this.vfColIndex);\n        e.virtualInfo.columnIndexes.splice(0, frozenCols);\n      }\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  VirtualContentRenderer.prototype.focusCell = function (e) {\n    if (this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow') {\n      return;\n    }\n\n    var row = this.parent.getRowByIndex(this.rowIndex); // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n    var cell = row.cells[this.cellIndex];\n    cell.focus({\n      preventScroll: true\n    });\n    this.parent.selectRow(parseInt(row.getAttribute(literals.ariaRowIndex), 10));\n    this.activeKey = this.empty;\n  };\n\n  VirtualContentRenderer.prototype.restoreEdit = function (e) {\n    if (this.isNormaledit) {\n      var left = this.parent.getFrozenColumns();\n      var isFrozen = e && this.parent.isFrozenGrid();\n      var table = this.parent.getFrozenMode();\n      var trigger = e && (left || table === 'Left' || table === 'Right' ? e.renderMovableContent : e.renderFrozenRightContent);\n\n      if ((!isFrozen || isFrozen && trigger) && this.parent.editSettings.allowEditing && this.parent.editModule && !isNullOrUndefined(this.editedRowIndex)) {\n        var row = this.getRowByIndex(this.editedRowIndex);\n        var content = this.content;\n        var keys = Object.keys(this.virtualData);\n        var isXaxis = e && e.virtualInfo && e.virtualInfo.sentinelInfo.axis === 'X';\n\n        if (isFrozen && isXaxis) {\n          row = this.parent.getMovableRowByIndex(this.editedRowIndex);\n          content = this.movableContent;\n        }\n\n        if (keys.length && row && !content.querySelector('.' + literals.editedRow)) {\n          var top_1 = row.getBoundingClientRect().top;\n\n          if (isXaxis || top_1 < this.content.offsetHeight && top_1 > this.parent.getRowHeight()) {\n            this.parent.isEdit = false;\n            this.parent.editModule.startEdit(row);\n          }\n        }\n\n        if (row && this.content.querySelector('.' + literals.editedRow) && !keys.length) {\n          var rowData = extend({}, this.getRowObjectByIndex(this.editedRowIndex));\n          this.virtualData = this.getVirtualEditedData(rowData);\n        }\n      }\n\n      this.restoreAdd(e);\n    }\n  };\n\n  VirtualContentRenderer.prototype.getVirtualEditedData = function (rowData) {\n    var editForms = [].slice.call(this.parent.element.getElementsByClassName('e-gridform'));\n    var isFormDestroyed = this.parent.editModule && this.parent.editModule.formObj && this.parent.editModule.formObj.isDestroyed;\n\n    if (!isFormDestroyed) {\n      for (var i = 0; i < editForms.length; i++) {\n        rowData = this.parent.editModule.getCurrentEditedData(editForms[i], rowData);\n      }\n    }\n\n    return rowData;\n  };\n\n  VirtualContentRenderer.prototype.restoreAdd = function (e) {\n    var left = this.parent.getFrozenColumns();\n    var isFrozen = e && this.parent.isFrozenGrid();\n    var table = this.parent.getFrozenMode();\n    var isXaxis = e && e.virtualInfo && e.virtualInfo.sentinelInfo && e.virtualInfo.sentinelInfo.axis === 'X';\n    var startAdd = isXaxis && isFrozen ? !(this.parent.getMovableVirtualHeader().querySelector('.' + literals.addedRow) || this.parent.getMovableVirtualContent().querySelector('.' + literals.addedRow)) : !this.parent.element.querySelector('.' + literals.addedRow);\n    var trigger = e && (left || table === 'Left' || table === 'Right' ? e.renderMovableContent : e.renderFrozenRightContent);\n\n    if ((!isFrozen || isFrozen && trigger) && this.isNormaledit && this.isAdd && startAdd) {\n      var isTop = this.parent.editSettings.newRowPosition === 'Top' && this.content.scrollTop < this.parent.getRowHeight();\n      var isBottom = this.parent.editSettings.newRowPosition === 'Bottom' && this.parent.pageSettings.currentPage === this.maxPage;\n\n      if (isTop || isBottom) {\n        this.parent.isEdit = false;\n        this.parent.addRecord();\n      }\n    }\n  };\n\n  VirtualContentRenderer.prototype.onDataReady = function (e) {\n    if (!isNullOrUndefined(e.count)) {\n      this.count = e.count;\n      this.maxPage = Math.ceil(e.count / this.parent.pageSettings.pageSize);\n    }\n\n    this.vgenerator.checkAndResetCache(e.requestType);\n\n    if (['refresh', 'filtering', 'searching', 'grouping', 'ungrouping', 'reorder', undefined].some(function (value) {\n      return e.requestType === value;\n    })) {\n      this.refreshOffsets();\n    }\n\n    this.setVirtualHeight();\n    this.resetScrollPosition(e.requestType);\n  };\n  /**\n   * @param {number} height - specifies the height\n   * @returns {void}\n   * @hidden\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  VirtualContentRenderer.prototype.setVirtualHeight = function (height) {\n    var width = this.parent.enableColumnVirtualization ? this.getColumnOffset(this.parent.columns.length + this.parent.groupSettings.columns.length - 1) + 'px' : '100%';\n\n    if (this.parent.isFrozenGrid()) {\n      var virtualHeightTemp = this.parent.pageSettings.currentPage === 1 && Object.keys(this.offsets).length <= 2 ? this.offsets[1] : this.offsets[this.getTotalBlocks() - 2];\n      var scrollableElementHeight = this.content.clientHeight;\n      virtualHeightTemp = virtualHeightTemp > scrollableElementHeight ? virtualHeightTemp : 0; // To overcome the white space issue in last page (instead of position absolute)\n\n      this.virtualEle.setVirtualHeight(virtualHeightTemp, width);\n    } else {\n      var virtualHeight = this.offsets[isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks()];\n      this.virtualEle.setVirtualHeight(virtualHeight, width);\n    }\n\n    if (this.parent.enableColumnVirtualization) {\n      this.header.virtualEle.setVirtualHeight(1, width);\n\n      if (this.parent.isFrozenGrid()) {\n        this.virtualEle.setMovableVirtualHeight(1, width);\n        this.header.virtualEle.setMovableVirtualHeight(1, width);\n      }\n    }\n  };\n\n  VirtualContentRenderer.prototype.getPageFromTop = function (sTop, info) {\n    var _this = this;\n\n    var total = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n    var page = 0;\n    this.offsetKeys.some(function (offset) {\n      var iOffset = Number(offset);\n      var border = sTop <= _this.offsets[offset] || iOffset === total && sTop > _this.offsets[offset];\n\n      if (border) {\n        if (_this.offsetKeys.length % 2 !== 0 && iOffset.toString() === _this.offsetKeys[_this.offsetKeys.length - 2] && sTop <= _this.offsets[_this.offsetKeys.length - 1]) {\n          iOffset = iOffset + 1;\n        }\n\n        info.block = iOffset % 2 === 0 ? 1 : 0;\n        page = Math.max(1, Math.min(_this.vgenerator.getPage(iOffset), _this.maxPage));\n      }\n\n      return border;\n    });\n    return page;\n  };\n\n  VirtualContentRenderer.prototype.getTranslateY = function (sTop, cHeight, info, isOnenter) {\n    if (info === undefined) {\n      info = {\n        page: this.getPageFromTop(sTop, {})\n      };\n      info.blockIndexes = this.vgenerator.getBlockIndexes(info.page);\n    }\n\n    var block = (info.blockIndexes[0] || 1) - 1;\n    var translate = this.getOffset(block);\n    var endTranslate = this.getOffset(info.blockIndexes[info.blockIndexes.length - 1]);\n\n    if (isOnenter) {\n      info = this.prevInfo;\n    }\n\n    var result = translate > sTop ? this.getOffset(block - 1) : endTranslate < sTop + cHeight ? this.getOffset(block + 1) : translate;\n    var blockHeight = this.offsets[info.blockIndexes[info.blockIndexes.length - 1]] - this.tmpOffsets[info.blockIndexes[0]];\n    var totalBlocks = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n\n    if (result + blockHeight > this.offsets[totalBlocks]) {\n      result -= result + blockHeight - this.offsets[totalBlocks];\n    }\n\n    return result;\n  };\n\n  VirtualContentRenderer.prototype.getOffset = function (block) {\n    return Math.min(this.offsets[block] | 0, this.offsets[this.maxBlock] | 0);\n  };\n\n  VirtualContentRenderer.prototype.onEntered = function () {\n    var _this = this;\n\n    return function (element, current, direction, e, isWheel, check) {\n      if (Browser.isIE && !isWheel && check && !_this.preventEvent) {\n        _this.parent.showSpinner();\n      }\n\n      var colVFtable = _this.parent.enableColumnVirtualization && _this.parent.isFrozenGrid();\n\n      var xAxis = current.axis === 'X';\n      var top = _this.prevInfo.offsets ? _this.prevInfo.offsets.top : null;\n\n      var height = _this.content.getBoundingClientRect().height;\n\n      var x = _this.getColumnOffset(xAxis ? _this.vgenerator.getColumnIndexes()[0] - 1 : _this.prevInfo.columnIndexes[0] - 1);\n\n      if (xAxis && !colVFtable) {\n        var idx = Object.keys(_this.vgenerator.cOffsets).length - _this.prevInfo.columnIndexes.length;\n\n        var maxLeft = _this.vgenerator.cOffsets[idx - 1];\n        x = x > maxLeft ? maxLeft : x; //TODO: This fix horizontal scrollbar jumping issue in column virtualization.\n      }\n\n      var y = _this.getTranslateY(e.top, height, xAxis && top === e.top ? _this.prevInfo : undefined, true);\n\n      _this.virtualEle.adjustTable(colVFtable ? 0 : x, Math.min(y, _this.offsets[_this.maxBlock]));\n\n      if (colVFtable) {\n        _this.virtualEle.adjustMovableTable(x, 0);\n      }\n\n      if (_this.parent.enableColumnVirtualization) {\n        _this.header.virtualEle.adjustTable(colVFtable ? 0 : x, 0);\n\n        if (colVFtable) {\n          _this.header.virtualEle.adjustMovableTable(x, 0);\n        }\n      }\n    };\n  };\n\n  VirtualContentRenderer.prototype.dataBound = function () {\n    this.parent.notify(events.refreshVirtualFrozenHeight, {});\n\n    if (this.isSelection && this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow') {\n      this.parent.selectRow(this.selectedRowIndex);\n    } else {\n      this.activeKey = this.empty;\n    }\n  };\n\n  VirtualContentRenderer.prototype.rowSelected = function (args, isSelection) {\n    if ((this.isSelection || isSelection) && !this.isLastBlockRow(args.rowIndex)) {\n      var transform = getTransformValues(this.content.firstElementChild);\n      var gridTop = this.parent.element.getBoundingClientRect().top;\n      var rowTop = args.row.getBoundingClientRect().top - gridTop;\n      var height = this.content.getBoundingClientRect().height;\n      var isBottom = height < rowTop;\n      var remainHeight = isBottom ? rowTop - height : this.initialRowTop - rowTop;\n      var translateY = isBottom ? transform.height - remainHeight : transform.height + remainHeight;\n      this.virtualEle.adjustTable(transform.width, translateY);\n      var lastRowTop = this.content.querySelector('tbody').lastElementChild.getBoundingClientRect().top - gridTop;\n\n      if (lastRowTop < height) {\n        translateY = translateY + (height - (args.row.getBoundingClientRect().top - gridTop));\n        this.virtualEle.adjustTable(transform.width, translateY - this.parent.getRowHeight() / 2);\n      }\n    }\n\n    this.isSelection = false;\n  };\n\n  VirtualContentRenderer.prototype.isLastBlockRow = function (index) {\n    var scrollEle = this.parent.getContent().firstElementChild;\n    var visibleRowCount = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n    var startIdx = this.maxPage * this.parent.pageSettings.pageSize - visibleRowCount;\n    return index >= startIdx;\n  };\n\n  VirtualContentRenderer.prototype.refreshVirtualCacheOnRowDD = function (args) {\n    var blockSize = this.getBlockSize();\n    var currentblk = Math.ceil((args.objIndex + 1) / blockSize);\n    var secondBlock = args.objIndex - args.startIndex >= blockSize ? blockSize : 0;\n    var thirdBlock = args.objIndex - args.startIndex >= blockSize + blockSize ? blockSize : 0;\n    this.orderRowObj.push(this.vgenerator.cache[currentblk][args.objIndex - args.startIndex - secondBlock - thirdBlock]);\n\n    if (this.parent.isFrozenGrid()) {\n      this.mvbOrderRowObj.push(this.vgenerator.movableCache[currentblk][args.objIndex - args.startIndex - secondBlock - thirdBlock]);\n\n      if (this.parent.getFrozenMode() === literals.leftRight) {\n        // eslint-disable-next-line\n        this.frOrderRowObj.push(this.vgenerator.frozenRightCache[currentblk][args.objIndex - args.startIndex - secondBlock - thirdBlock]);\n      }\n    }\n\n    if (args.end === true) {\n      var currentBlocks = this.currentInfo.blockIndexes;\n\n      if (!currentBlocks) {\n        currentBlocks = [1, 2];\n      }\n\n      resetRowObjectIndex(this.parent, this.orderRowObj, args.startIndex);\n\n      if (this.parent.isFrozenGrid()) {\n        resetRowObjectIndex(this.parent, this.mvbOrderRowObj, args.startIndex);\n\n        if (this.parent.getFrozenMode() === literals.leftRight) {\n          resetRowObjectIndex(this.parent, this.frOrderRowObj, args.startIndex);\n        }\n      }\n\n      for (var i = 0; i < currentBlocks.length; i++) {\n        this.vgenerator.cache[currentBlocks[i]] = this.orderRowObj.splice(0, blockSize);\n\n        if (this.parent.isFrozenGrid()) {\n          this.vgenerator.movableCache[currentBlocks[i]] = this.mvbOrderRowObj.splice(0, blockSize);\n\n          if (this.parent.getFrozenMode() === literals.leftRight) {\n            this.vgenerator.frozenRightCache[currentBlocks[i]] = this.frOrderRowObj.splice(0, blockSize);\n          }\n        }\n      }\n\n      this.orderRowObj = [];\n      this.orderRowObj = [];\n      this.mvbOrderRowObj = [];\n    }\n  };\n\n  VirtualContentRenderer.prototype.refreshMaxPage = function () {\n    if (this.parent.groupSettings.columns.length && this.parent.vcRows.length) {\n      this.maxPage = Math.ceil(this.parent.vcRows.length / this.parent.pageSettings.pageSize);\n    }\n  };\n\n  VirtualContentRenderer.prototype.eventListener = function (action) {\n    var _this = this;\n\n    this.parent[action](dataReady, this.onDataReady, this);\n    this.parent.addEventListener(events.dataBound, this.dataBound.bind(this));\n    this.parent.addEventListener(events.actionBegin, this.actionBegin.bind(this));\n    this.parent.addEventListener(events.actionComplete, this.actionComplete.bind(this));\n    this.parent.addEventListener(events.rowSelected, this.rowSelected.bind(this));\n    this.parent[action](refreshVirtualBlock, this.refreshContentRows, this);\n    this.parent[action](events.selectVirtualRow, this.selectVirtualRow, this);\n    this.parent[action](events.virtaulCellFocus, this.virtualCellFocus, this);\n    this.parent[action](events.virtualScrollEditActionBegin, this.editActionBegin, this);\n    this.parent[action](events.virtualScrollAddActionBegin, this.addActionBegin, this);\n    this.parent[action](events.virtualScrollEdit, this.restoreEdit, this);\n    this.parent[action](events.virtualScrollEditSuccess, this.editSuccess, this);\n    this.parent[action](events.refreshVirtualCache, this.refreshCache, this);\n    this.parent[action](events.editReset, this.resetIsedit, this);\n    this.parent[action](events.getVirtualData, this.getVirtualData, this);\n    this.parent[action](events.virtualScrollEditCancel, this.editCancel, this);\n    this.parent[action](events.refreshVirtualCacheOnRowDD, this.refreshVirtualCacheOnRowDD, this);\n    this.parent[action](events.refreshVirtualMaxPage, this.refreshMaxPage, this);\n    this.parent[action](events.selectRowOnContextOpen, this.selectRowOnContextOpen, this);\n    this.parent[action](events.resetVirtualFocus, this.resetVirtualFocus, this);\n    this.parent[action](events.refreshVirtualEditFormCells, this.refreshCells, this);\n    this.parent[action](events.scrollToEdit, this.scrollToEdit, this);\n    var event = this.actions;\n\n    for (var i = 0; i < event.length; i++) {\n      this.parent[action](event[i] + \"-begin\", this.onActionBegin, this);\n    }\n\n    var fn = function () {\n      _this.observer.observe(function (scrollArgs) {\n        return _this.scrollListener(scrollArgs);\n      }, _this.onEntered());\n\n      var gObj = _this.parent;\n\n      if (gObj.enablePersistence && gObj.scrollPosition) {\n        _this.content.scrollTop = gObj.scrollPosition.top;\n        var scrollValues = {\n          direction: 'down',\n          sentinel: _this.observer.sentinelInfo.down,\n          offset: gObj.scrollPosition,\n          focusElement: gObj.element\n        };\n\n        _this.scrollListener(scrollValues);\n\n        if (gObj.enableColumnVirtualization) {\n          _this.content.scrollLeft = gObj.scrollPosition.left;\n        }\n      }\n\n      _this.parent.off(contentReady, fn);\n    };\n\n    this.parent.on(contentReady, fn, this);\n  };\n\n  VirtualContentRenderer.prototype.scrollToEdit = function (col) {\n    var isFrozen = this.parent.isFrozenGrid();\n    var allowScroll = true;\n    this.validationCheck = true;\n\n    if (this.isAdd && this.content.scrollTop > 0) {\n      allowScroll = false;\n      var keys = Object.keys(this.offsets);\n      this.content.scrollTop = this.parent.editSettings.newRowPosition === 'Top' ? 0 : this.offsets[keys.length - 1];\n    }\n\n    var row = this.parent.getRowByIndex(this.editedRowIndex);\n\n    if (!row && !isNullOrUndefined(this.editedRowIndex)) {\n      if (!row || !this.isRowInView(row)) {\n        var rowIndex = this.parent.getRowHeight();\n        var scrollTop = this.editedRowIndex * rowIndex;\n\n        if (!isNullOrUndefined(scrollTop)) {\n          allowScroll = false;\n          this.content.scrollTop = scrollTop;\n        }\n      }\n    }\n\n    if (col && allowScroll) {\n      var offset = this.vgenerator.cOffsets[col.index - this.parent.getVisibleFrozenColumns() - 1];\n\n      if (!this.parent.enableColumnVirtualization) {\n        var header = this.parent.getHeaderContent().querySelector('.e-headercelldiv[e-mappinguid=\"' + col.uid + '\"]');\n        offset = isFrozen ? header.parentElement.offsetLeft - this.parent.getFrozenVirtualHeader().offsetWidth : header.parentElement.offsetLeft;\n      }\n\n      if (isFrozen) {\n        this.parent.getMovableVirtualContent().scrollLeft = this.parent.enableRtl ? -Math.abs(offset) : offset;\n      } else {\n        this.content.scrollLeft = this.parent.enableRtl ? -Math.abs(offset) : offset;\n      }\n    }\n\n    if (col && !allowScroll) {\n      this.validationCol = col;\n    }\n  };\n\n  VirtualContentRenderer.prototype.refreshCells = function (rowObj) {\n    rowObj.cells = this.vgenerator.generateCells();\n  };\n\n  VirtualContentRenderer.prototype.resetVirtualFocus = function (e) {\n    this.isCancel = e.isCancel;\n  };\n  /**\n   * @param {Object} data - specifies the data\n   * @param {Object} data.virtualData -specifies the data\n   * @param {boolean} data.isAdd - specifies isAdd\n   * @param {boolean} data.isCancel - specifies boolean in cancel\n   * @param {boolean} data.isScroll - specifies boolean for scroll\n   * @returns {void}\n   * @hidden\n   */\n\n\n  VirtualContentRenderer.prototype.getVirtualData = function (data) {\n    if (this.isNormaledit) {\n      var error = this.parent.element.querySelector('.e-griderror:not([style*=\"display: none\"])');\n      var keys = Object.keys(this.virtualData);\n      data.isScroll = keys.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';\n\n      if (error) {\n        return;\n      }\n\n      this.virtualData = keys.length ? this.virtualData : data.virtualData;\n      this.getVirtualEditedData(this.virtualData);\n      data.virtualData = this.virtualData;\n      data.isAdd = this.isAdd;\n      data.isCancel = this.isCancel;\n    }\n  };\n\n  VirtualContentRenderer.prototype.selectRowOnContextOpen = function (args) {\n    this.isContextMenuOpen = args.isOpen;\n  };\n\n  VirtualContentRenderer.prototype.editCancel = function (args) {\n    var dataIndex = getEditedDataIndex(this.parent, args.data);\n\n    if (!isNullOrUndefined(dataIndex)) {\n      args.data = this.parent.getCurrentViewRecords()[dataIndex];\n    }\n  };\n\n  VirtualContentRenderer.prototype.editSuccess = function (args) {\n    if (this.isNormaledit) {\n      if (!this.isAdd && args.data) {\n        this.updateCurrentViewData(args.data);\n      }\n\n      this.isAdd = false;\n    }\n  };\n\n  VirtualContentRenderer.prototype.updateCurrentViewData = function (data) {\n    var dataIndex = getEditedDataIndex(this.parent, data);\n\n    if (!isNullOrUndefined(dataIndex)) {\n      this.parent.getCurrentViewRecords()[dataIndex] = data;\n    }\n  };\n\n  VirtualContentRenderer.prototype.actionBegin = function (args) {\n    if (args.requestType !== 'virtualscroll') {\n      this.requestType = args.requestType;\n    }\n\n    if (!args.cancel) {\n      this.parent.notify(events.refreshVirtualFrozenRows, args);\n    }\n  };\n\n  VirtualContentRenderer.prototype.virtualCellFocus = function (e) {\n    // To decide the action (select or scroll), when using arrow keys for cell focus\n    var ele = document.activeElement;\n\n    if (ele.classList.contains(literals.rowCell) && e && (e.action === 'upArrow' || e.action === 'downArrow')) {\n      var rowIndex = parseInt(ele.parentElement.getAttribute(literals.ariaRowIndex), 10);\n\n      if (e && (e.action === 'downArrow' || e.action === 'upArrow')) {\n        var scrollEle = this.parent.getContent().firstElementChild;\n\n        if (e.action === 'downArrow') {\n          rowIndex += 1;\n        } else {\n          rowIndex -= 1;\n        }\n\n        this.rowIndex = rowIndex;\n        this.cellIndex = parseInt(ele.getAttribute(literals.ariaColIndex), 10);\n        var row = this.parent.getRowByIndex(rowIndex);\n        var page = this.parent.pageSettings.currentPage;\n        var visibleRowCount = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n        var emptyRow = false;\n\n        if (isNullOrUndefined(row)) {\n          emptyRow = true;\n\n          if (e.action === 'downArrow' && page === this.maxPage - 1 || e.action === 'upArrow' && page === 1) {\n            emptyRow = false;\n          }\n        }\n\n        if (emptyRow || ensureLastRow(row, this.parent) && e.action === 'downArrow' || ensureFirstRow(row, this.parent.getRowHeight() * 2) && e.action === 'upArrow') {\n          this.activeKey = e.action;\n          scrollEle.scrollTop = e.action === 'downArrow' ? (rowIndex - visibleRowCount) * this.parent.getRowHeight() : rowIndex * this.parent.getRowHeight();\n        } else {\n          this.activeKey = this.empty;\n        }\n\n        this.parent.selectRow(rowIndex);\n      }\n    }\n  };\n\n  VirtualContentRenderer.prototype.editActionBegin = function (e) {\n    this.editedRowIndex = e.index;\n    var rowData = extend({}, this.getRowObjectByIndex(e.index));\n    var keys = Object.keys(this.virtualData);\n    e.data = keys.length ? this.virtualData : rowData;\n    e.isScroll = keys.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';\n  };\n\n  VirtualContentRenderer.prototype.refreshCache = function (data) {\n    var block = Math.ceil((this.editedRowIndex + 1) / this.getBlockSize());\n    var index = this.editedRowIndex - (block - 1) * this.getBlockSize();\n    this.vgenerator.cache[block][index].data = data;\n\n    if (this.vgenerator.movableCache[block]) {\n      this.vgenerator.movableCache[block][index].data = data;\n    }\n\n    if (this.vgenerator.frozenRightCache[block]) {\n      this.vgenerator.frozenRightCache[block][index].data = data;\n    }\n  };\n\n  VirtualContentRenderer.prototype.actionComplete = function (args) {\n    var editRequestTypes = ['delete', 'save', 'cancel'];\n    var dataActionRequestTypes = ['sorting', 'filtering', 'grouping', 'refresh', 'searching', 'ungrouping', 'reorder'];\n\n    if (editRequestTypes.some(function (value) {\n      return value === args.requestType;\n    })) {\n      this.refreshOffsets();\n\n      if (this.parent.isFrozenGrid()) {\n        this.vgenerator.refreshColOffsets();\n        this.parent.contentModule.virtualRenderer.virtualEle.setVirtualHeight();\n      } else {\n        this.refreshVirtualElement();\n      }\n    }\n\n    if (this.isNormaledit && (dataActionRequestTypes.some(function (value) {\n      return value === args.requestType;\n    }) || editRequestTypes.some(function (value) {\n      return value === args.requestType;\n    }))) {\n      this.isCancel = true;\n      this.isAdd = false;\n      this.editedRowIndex = this.empty;\n      this.virtualData = {};\n\n      if (this.parent.editModule) {\n        this.parent.editModule.editModule.previousData = undefined;\n      }\n    }\n\n    if (this.parent.enableColumnVirtualization && args.requestType === 'filterafteropen' && this.currentInfo.columnIndexes && this.currentInfo.columnIndexes[0] > 0) {\n      this.parent.resetFilterDlgPosition(args.columnName);\n    }\n  };\n\n  VirtualContentRenderer.prototype.resetIsedit = function () {\n    if (this.parent.enableVirtualization && this.isNormaledit) {\n      if (this.parent.editSettings.allowEditing && Object.keys(this.virtualData).length || this.parent.editSettings.allowAdding && this.isAdd) {\n        this.parent.isEdit = true;\n      }\n    }\n  };\n\n  VirtualContentRenderer.prototype.scrollAfterEdit = function () {\n    if (this.parent.editModule && this.parent.editSettings.allowEditing && this.isNormaledit) {\n      if (this.parent.element.querySelector('.e-gridform')) {\n        var editForm = this.parent.element.querySelector('.' + literals.editedRow);\n        var addForm = this.parent.element.querySelector('.' + literals.addedRow);\n\n        if (editForm || addForm) {\n          var rowData = editForm ? extend({}, this.getRowObjectByIndex(this.editedRowIndex)) : extend({}, this.emptyRowData);\n          var keys = Object.keys(this.virtualData);\n          this.virtualData = keys.length ? this.getVirtualEditedData(this.virtualData) : this.getVirtualEditedData(rowData);\n        }\n      }\n    }\n  };\n\n  VirtualContentRenderer.prototype.createEmptyRowdata = function () {\n    var _this = this;\n\n    this.parent.columnModel.filter(function (e) {\n      _this.emptyRowData[e.field] = _this.empty;\n    });\n  };\n\n  VirtualContentRenderer.prototype.addActionBegin = function (args) {\n    if (this.isNormaledit) {\n      if (!Object.keys(this.emptyRowData).length) {\n        this.createEmptyRowdata();\n      }\n\n      this.isAdd = true;\n      var page = this.parent.pageSettings.currentPage;\n\n      if (!this.parent.frozenRows && this.content.scrollTop > 0 && this.parent.editSettings.newRowPosition === 'Top') {\n        this.isAdd = true;\n        this.onActionBegin();\n        args.startEdit = false;\n        this.content.scrollTop = 0;\n      }\n\n      if (page < this.maxPage - 1 && this.parent.editSettings.newRowPosition === 'Bottom') {\n        this.isAdd = true;\n        this.parent.setProperties({\n          pageSettings: {\n            currentPage: this.maxPage - 1\n          }\n        }, true);\n        args.startEdit = false;\n        this.content.scrollTop = this.offsets[this.offsetKeys.length];\n      }\n    }\n  };\n  /**\n   * @param {number} index - specifies the index\n   * @returns {Object} returns the object\n   * @hidden\n   */\n\n\n  VirtualContentRenderer.prototype.getRowObjectByIndex = function (index) {\n    var data = this.getRowCollection(index, false, true);\n    return data;\n  };\n\n  VirtualContentRenderer.prototype.getBlockSize = function () {\n    return this.parent.pageSettings.pageSize >> 1;\n  };\n\n  VirtualContentRenderer.prototype.getBlockHeight = function () {\n    return this.getBlockSize() * this.parent.getRowHeight();\n  };\n\n  VirtualContentRenderer.prototype.isEndBlock = function (index) {\n    var totalBlocks = this.getTotalBlocks();\n    return index >= totalBlocks || index === totalBlocks - 1;\n  };\n\n  VirtualContentRenderer.prototype.getGroupedTotalBlocks = function () {\n    var rows = this.parent.vcRows;\n    return Math.floor(rows.length / this.getBlockSize() < 1 ? 1 : rows.length / this.getBlockSize());\n  };\n\n  VirtualContentRenderer.prototype.getTotalBlocks = function () {\n    return Math.ceil(this.count / this.getBlockSize());\n  };\n\n  VirtualContentRenderer.prototype.getColumnOffset = function (block) {\n    return this.vgenerator.cOffsets[block] | 0;\n  };\n\n  VirtualContentRenderer.prototype.getModelGenerator = function () {\n    return new VirtualRowModelGenerator(this.parent);\n  };\n\n  VirtualContentRenderer.prototype.resetScrollPosition = function (action) {\n    if (this.actions.some(function (value) {\n      return value === action;\n    })) {\n      this.preventEvent = this.content.scrollTop !== 0;\n      this.content.scrollTop = 0;\n    }\n\n    if (action !== 'virtualscroll') {\n      this.isAdd = false;\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  VirtualContentRenderer.prototype.onActionBegin = function (e) {\n    //Update property silently..\n    this.parent.setProperties({\n      pageSettings: {\n        currentPage: 1\n      }\n    }, true);\n  };\n\n  VirtualContentRenderer.prototype.getRows = function () {\n    return this.vgenerator.getRows();\n  };\n\n  VirtualContentRenderer.prototype.getRowByIndex = function (index) {\n    var row;\n\n    if (isGroupAdaptive(this.parent)) {\n      row = this.parent.getDataRows()[index];\n    }\n\n    if (this.prevInfo) {\n      row = this.getRowCollection(index, false);\n    }\n\n    return row;\n  };\n\n  VirtualContentRenderer.prototype.getMovableVirtualRowByIndex = function (index) {\n    return this.getRowCollection(index, true);\n  };\n\n  VirtualContentRenderer.prototype.getFrozenRightVirtualRowByIndex = function (index) {\n    return this.getRowCollection(index, false, false, true);\n  };\n\n  VirtualContentRenderer.prototype.getRowCollection = function (index, isMovable, isRowObject, isFrozenRight) {\n    var prev = this.prevInfo.blockIndexes;\n    var startIdx = (prev[0] - 1) * this.getBlockSize();\n    var rowCollection = isMovable ? this.parent.getMovableDataRows() : this.parent.getDataRows();\n    rowCollection = isFrozenRight ? this.parent.getFrozenRightDataRows() : rowCollection;\n    var collection = isRowObject ? this.parent.getCurrentViewRecords() : rowCollection;\n    var selectedRow = collection[index - startIdx];\n\n    if (this.parent.frozenRows && this.parent.pageSettings.currentPage > 1) {\n      if (!isRowObject) {\n        selectedRow = index <= this.parent.frozenRows ? rowCollection[index] : rowCollection[index - startIdx + this.parent.frozenRows];\n      } else {\n        selectedRow = index <= this.parent.frozenRows ? this.parent.getRowsObject()[index].data : selectedRow;\n      }\n    }\n\n    return selectedRow;\n  };\n\n  VirtualContentRenderer.prototype.getVirtualRowIndex = function (index) {\n    var prev = this.prevInfo.blockIndexes;\n    var startIdx = (prev[0] - 1) * this.getBlockSize();\n    return startIdx + index;\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n\n\n  VirtualContentRenderer.prototype.refreshOffsets = function () {\n    var gObj = this.parent;\n    var row = 0;\n    var bSize = this.getBlockSize();\n    var total = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n    this.prevHeight = this.offsets[total];\n    this.maxBlock = total % 2 === 0 ? total - 2 : total - 1;\n    this.offsets = {}; //Row offset update\n    // eslint-disable-next-line prefer-spread\n\n    var blocks = Array.apply(null, Array(total)).map(function () {\n      return ++row;\n    });\n\n    for (var i = 0; i < blocks.length; i++) {\n      var tmp = (this.vgenerator.cache[blocks[i]] || []).length;\n      var rem = !isGroupAdaptive(this.parent) ? this.count % bSize : gObj.vcRows.length % bSize;\n      var size = !isGroupAdaptive(this.parent) && blocks[i] in this.vgenerator.cache ? tmp * this.parent.getRowHeight() : rem && blocks[i] === total ? rem * this.parent.getRowHeight() : this.getBlockHeight(); // let size: number = this.parent.groupSettings.columns.length && block in this.vgenerator.cache ?\n      // tmp * getRowHeight() : this.getBlockHeight();\n\n      this.offsets[blocks[i]] = (this.offsets[blocks[i] - 1] | 0) + size;\n      this.tmpOffsets[blocks[i]] = this.offsets[blocks[i] - 1] | 0;\n    }\n\n    this.offsetKeys = Object.keys(this.offsets);\n\n    if (isGroupAdaptive(this.parent)) {\n      this.parent.vGroupOffsets = this.offsets;\n    } //Column offset update\n\n\n    if (this.parent.enableColumnVirtualization) {\n      this.vgenerator.refreshColOffsets();\n    }\n  };\n\n  VirtualContentRenderer.prototype.refreshVirtualElement = function () {\n    this.vgenerator.refreshColOffsets();\n    this.setVirtualHeight();\n  };\n\n  VirtualContentRenderer.prototype.setVisible = function (columns) {\n    var gObj = this.parent;\n    var frozenCols = this.parent.getFrozenColumns();\n    var fcntColGrp;\n    var mcntColGrp;\n\n    if (frozenCols) {\n      fcntColGrp = [].slice.call(this.parent.getFrozenVirtualContent().querySelectorAll('col'));\n      mcntColGrp = [].slice.call(this.parent.getMovableVirtualContent().querySelectorAll('col'));\n    }\n\n    var rows = [];\n    rows = this.getRows();\n    var testRow;\n    rows.some(function (r) {\n      if (r.isDataRow) {\n        testRow = r;\n      }\n\n      return r.isDataRow;\n    });\n    var isRefresh = true;\n\n    if (!gObj.groupSettings.columns.length && testRow) {\n      isRefresh = false;\n    }\n\n    var tr = gObj.getDataRows();\n\n    for (var c = 0, clen = columns.length; c < clen; c++) {\n      var column = columns[c];\n      var idx = gObj.getNormalizedColumnIndex(column.uid);\n      var displayVal = column.visible === true ? '' : 'none';\n      var colGrp = void 0;\n\n      if (fcntColGrp && mcntColGrp) {\n        if (idx >= frozenCols) {\n          colGrp = mcntColGrp;\n          tr = this.parent.getMovableRows();\n          idx = idx - frozenCols;\n        } else {\n          colGrp = fcntColGrp;\n        }\n      } else {\n        colGrp = this.getColGroup().children;\n      }\n\n      if (idx !== -1 && testRow && idx < testRow.cells.length) {\n        setStyleAttribute(colGrp[idx], {\n          'display': displayVal\n        });\n      }\n\n      if (!isRefresh) {\n        var width = void 0;\n\n        if (column.visible) {\n          width = this.virtualEle.wrapper.offsetWidth + parseInt(column.width.toString(), 10);\n        } else {\n          width = this.virtualEle.wrapper.offsetWidth - parseInt(column.width.toString(), 10);\n        }\n\n        if (width > gObj.width) {\n          this.setDisplayNone(tr, idx, displayVal, rows);\n\n          if (this.parent.enableColumnVirtualization) {\n            this.virtualEle.setWrapperWidth(width + '');\n          }\n\n          this.refreshVirtualElement();\n        } else {\n          isRefresh = true;\n        }\n      }\n\n      if (!this.parent.invokedFromMedia && column.hideAtMedia) {\n        this.parent.updateMediaColumns(column);\n      }\n\n      this.parent.invokedFromMedia = false;\n    }\n\n    if (isRefresh || frozenCols) {\n      this.refreshContentRows({\n        requestType: 'refresh'\n      });\n    } else {\n      this.parent.notify(events.partialRefresh, {\n        rows: rows,\n        args: {\n          isFrozen: false,\n          rows: rows\n        }\n      });\n    }\n  };\n\n  VirtualContentRenderer.prototype.selectVirtualRow = function (args) {\n    var _this = this;\n\n    args.isAvailable = args.selectedIndex < this.count;\n\n    if (args.isAvailable && !this.isContextMenuOpen && this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow' && !this.isSelection && !this.requestTypes.some(function (value) {\n      return value === _this.requestType;\n    }) && !this.parent.selectionModule.isInteracted) {\n      var selectedRow = this.parent.getRowByIndex(args.selectedIndex);\n      var rowHeight = this.parent.getRowHeight();\n\n      if (!selectedRow || !this.isRowInView(selectedRow)) {\n        this.isSelection = true;\n        this.selectedRowIndex = args.selectedIndex;\n        var scrollTop = (args.selectedIndex + 1) * rowHeight;\n\n        if (!isNullOrUndefined(scrollTop)) {\n          var direction = this.content.scrollTop < scrollTop ? 'down' : 'up';\n          this.selectRowIndex = args.selectedIndex;\n          this.content.scrollTop = scrollTop;\n          this.isSelectionScroll = this.observer.check(direction);\n        }\n      }\n    }\n\n    if (this.parent.isFrozenGrid() && this.requestType) {\n      if (this.parent.getTablesCount() === this.frzIdx) {\n        this.requestType = this.empty;\n        this.frzIdx = 1;\n      } else {\n        this.frzIdx++;\n      }\n    } else {\n      this.requestType = this.empty;\n    }\n  };\n\n  VirtualContentRenderer.prototype.isRowInView = function (row) {\n    var top = row.getBoundingClientRect().top - this.parent.element.getBoundingClientRect().top;\n    return top >= this.initialRowTop && top <= this.content.offsetHeight;\n  };\n\n  return VirtualContentRenderer;\n}(ContentRender);\n\nexport { VirtualContentRenderer };\n/**\n * @hidden\n */\n\nvar VirtualHeaderRenderer =\n/** @class */\nfunction (_super) {\n  __extends(VirtualHeaderRenderer, _super);\n\n  function VirtualHeaderRenderer(parent, locator) {\n    var _this = _super.call(this, parent, locator) || this;\n\n    _this.virtualEle = new VirtualElementHandler();\n    _this.isMovable = false;\n    _this.gen = new VirtualRowModelGenerator(_this.parent);\n\n    _this.parent.on(events.columnVisibilityChanged, _this.setVisible, _this);\n\n    _this.parent.on(refreshVirtualBlock, function (e) {\n      return e.virtualInfo.sentinelInfo.axis === 'X' ? _this.refreshUI() : null;\n    }, _this);\n\n    return _this;\n  }\n\n  VirtualHeaderRenderer.prototype.renderTable = function () {\n    this.gen.refreshColOffsets();\n    this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + literals.headerContent)));\n\n    _super.prototype.renderTable.call(this);\n\n    this.virtualEle.table = this.getTable();\n    this.virtualEle.content = this.getPanel().querySelector('.' + literals.headerContent);\n    this.virtualEle.content.style.position = 'relative';\n    this.virtualEle.renderWrapper();\n    this.virtualEle.renderPlaceHolder('absolute');\n  };\n\n  VirtualHeaderRenderer.prototype.appendContent = function (table) {\n    if (!this.isMovable) {\n      this.virtualEle.wrapper.appendChild(table);\n    } else {\n      this.virtualEle.movableWrapper.appendChild(table);\n      this.isMovable = false;\n    }\n  };\n\n  VirtualHeaderRenderer.prototype.refreshUI = function () {\n    this.isMovable = this.parent.isFrozenGrid();\n    this.setFrozenTable(this.parent.getMovableVirtualContent());\n    this.gen.refreshColOffsets();\n    this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + literals.headerContent)));\n\n    _super.prototype.refreshUI.call(this);\n\n    this.setFrozenTable(this.parent.getFrozenVirtualContent());\n  };\n\n  VirtualHeaderRenderer.prototype.setVisible = function (columns) {\n    var gObj = this.parent;\n    var displayVal;\n    var idx;\n    var needFullRefresh;\n    var frozenCols = this.parent.getFrozenColumns();\n    var fhdrColGrp;\n    var mhdrColGrp;\n\n    if (frozenCols) {\n      fhdrColGrp = [].slice.call(this.parent.getFrozenVirtualHeader().querySelectorAll('col'));\n      mhdrColGrp = [].slice.call(this.parent.getMovableVirtualHeader().querySelectorAll('col'));\n    }\n\n    for (var c = 0, clen = columns.length; c < clen; c++) {\n      var column = columns[c];\n      idx = gObj.getNormalizedColumnIndex(column.uid);\n      displayVal = column.visible ? '' : 'none';\n      var colGrp = void 0;\n\n      if (fhdrColGrp && mhdrColGrp) {\n        if (idx >= frozenCols) {\n          colGrp = mhdrColGrp;\n          idx = idx - frozenCols;\n        } else {\n          colGrp = fhdrColGrp;\n        }\n      } else {\n        colGrp = this.getColGroup().children;\n      }\n\n      setStyleAttribute(colGrp[idx], {\n        'display': displayVal\n      });\n\n      if (gObj.enableColumnVirtualization && !gObj.groupSettings.columns.length) {\n        var tablewidth = void 0;\n\n        if (column.visible) {\n          tablewidth = this.virtualEle.wrapper.offsetWidth + parseInt(column.width.toString(), 10);\n        } else {\n          tablewidth = this.virtualEle.wrapper.offsetWidth - parseInt(column.width.toString(), 10);\n        }\n\n        if (tablewidth > gObj.width) {\n          this.setDisplayNone(column, displayVal);\n          this.virtualEle.setWrapperWidth(tablewidth + '');\n          this.gen.refreshColOffsets();\n        } else {\n          needFullRefresh = true;\n        }\n      } else {\n        needFullRefresh = true;\n      }\n\n      if (needFullRefresh && !frozenCols) {\n        this.refreshUI();\n      }\n    }\n\n    if (frozenCols) {\n      this.parent.notify(events.columnPositionChanged, {});\n    }\n  };\n\n  VirtualHeaderRenderer.prototype.setFrozenTable = function (content) {\n    if (this.parent.isFrozenGrid() && this.parent.enableColumnVirtualization && this.parent.contentModule.isXaxis()) {\n      this.parent.contentModule.setTable(content.querySelector('.' + literals.table));\n    }\n  };\n\n  VirtualHeaderRenderer.prototype.setDisplayNone = function (col, displayVal) {\n    var frozenCols = this.parent.isFrozenGrid();\n    var table = this.getTable();\n\n    if (frozenCols && col.getFreezeTableName() === 'movable') {\n      table = this.parent.getMovableVirtualHeader().querySelector('.' + literals.table);\n    }\n\n    for (var _i = 0, _a = [].slice.apply(table.querySelectorAll('th.e-headercell')); _i < _a.length; _i++) {\n      var ele = _a[_i];\n\n      if (ele.querySelector('[e-mappinguid]') && ele.querySelector('[e-mappinguid]').getAttribute('e-mappinguid') === col.uid) {\n        setStyleAttribute(ele, {\n          'display': displayVal\n        });\n\n        if (displayVal === '') {\n          removeClass([ele], 'e-hide');\n        }\n\n        break;\n      }\n    }\n  };\n\n  return VirtualHeaderRenderer;\n}(HeaderRender);\n\nexport { VirtualHeaderRenderer };\n/**\n * @hidden\n */\n\nvar VirtualElementHandler =\n/** @class */\nfunction () {\n  function VirtualElementHandler() {}\n\n  VirtualElementHandler.prototype.renderWrapper = function (height) {\n    this.wrapper = createElement('div', {\n      className: 'e-virtualtable',\n      styles: \"min-height:\" + formatUnit(height)\n    });\n    this.wrapper.appendChild(this.table);\n    this.content.appendChild(this.wrapper);\n  };\n\n  VirtualElementHandler.prototype.renderPlaceHolder = function (position) {\n    if (position === void 0) {\n      position = 'relative';\n    }\n\n    this.placeholder = createElement('div', {\n      className: 'e-virtualtrack',\n      styles: \"position:\" + position\n    });\n    this.content.appendChild(this.placeholder);\n  };\n\n  VirtualElementHandler.prototype.renderFrozenWrapper = function (height) {\n    this.wrapper = createElement('div', {\n      className: 'e-virtualtable',\n      styles: \"min-height:\" + formatUnit(height) + \"; display: flex\"\n    });\n    this.content.appendChild(this.wrapper);\n  };\n\n  VirtualElementHandler.prototype.renderFrozenPlaceHolder = function () {\n    this.placeholder = createElement('div', {\n      className: 'e-virtualtrack'\n    });\n    this.content.appendChild(this.placeholder);\n  };\n\n  VirtualElementHandler.prototype.renderMovableWrapper = function (height) {\n    this.movableWrapper = createElement('div', {\n      className: 'e-virtualtable',\n      styles: \"min-height:\" + formatUnit(height)\n    });\n    this.movableContent.appendChild(this.movableWrapper);\n  };\n\n  VirtualElementHandler.prototype.renderMovablePlaceHolder = function () {\n    this.movablePlaceholder = createElement('div', {\n      className: 'e-virtualtrack'\n    });\n    this.movableContent.appendChild(this.movablePlaceholder);\n  };\n\n  VirtualElementHandler.prototype.adjustTable = function (xValue, yValue) {\n    this.wrapper.style.transform = \"translate(\" + xValue + \"px, \" + yValue + \"px)\";\n  };\n\n  VirtualElementHandler.prototype.adjustMovableTable = function (xValue, yValue) {\n    this.movableWrapper.style.transform = \"translate(\" + xValue + \"px, \" + yValue + \"px)\";\n  };\n\n  VirtualElementHandler.prototype.setMovableWrapperWidth = function (width, full) {\n    this.movableWrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n  };\n\n  VirtualElementHandler.prototype.setMovableVirtualHeight = function (height, width) {\n    this.movablePlaceholder.style.height = height + \"px\";\n    this.movablePlaceholder.style.width = width;\n  };\n\n  VirtualElementHandler.prototype.setWrapperWidth = function (width, full) {\n    this.wrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n  };\n\n  VirtualElementHandler.prototype.setVirtualHeight = function (height, width) {\n    this.placeholder.style.height = height + \"px\";\n    this.placeholder.style.width = width;\n  };\n\n  VirtualElementHandler.prototype.setFreezeWrapperWidth = function (wrapper, width, full) {\n    wrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n  };\n\n  return VirtualElementHandler;\n}();\n\nexport { VirtualElementHandler };","map":{"version":3,"sources":["/Users/zhouzhou/Desktop/lightfront/node_modules/@syncfusion/ej2-grids/src/grid/renderer/virtual-content-renderer.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","remove","createElement","closest","formatUnit","Browser","extend","isNullOrUndefined","removeClass","DataManager","dataReady","modelChanged","refreshVirtualBlock","contentReady","events","RenderType","ContentRender","HeaderRender","InterSectionObserver","VirtualRowModelGenerator","isGroupAdaptive","ensureLastRow","ensureFirstRow","getEditedDataIndex","getTransformValues","resetRowObjectIndex","setStyleAttribute","literals","VirtualContentRenderer","_super","parent","locator","_this","call","prevHeight","startIndex","preStartIndex","preventEvent","actions","offsets","tmpOffsets","virtualEle","VirtualElementHandler","offsetKeys","isFocused","isSelection","isBottom","rndrCount","empty","undefined","isCancel","requestTypes","isNormaledit","editSettings","mode","virtualData","emptyRowData","vfColIndex","frzIdx","orderRowObj","mvbOrderRowObj","frOrderRowObj","isContextMenuOpen","isSelectionScroll","validationCheck","eventListener","on","columnVisibilityChanged","setVisible","vgenerator","generator","renderTable","header","getService","getRenderer","Header","table","getTable","content","getPanel","querySelector","renderWrapper","height","renderPlaceHolder","wrapper","style","position","debounceEvent","dataSource","offline","opt","container","pageHeight","getBlockHeight","axes","enableColumnVirtualization","observer","renderEmpty","tbody","appendChild","adjustTable","getReorderedFrozenRows","args","blockIndex","virtualInfo","blockIndexes","colsIndex","columnIndexes","page","renderMovableContent","recordslength","getCurrentViewRecords","length","firstRecords","renderModule","data","dataManager","json","slice","virtualRows","generateRows","splice","frozenRows","scrollListener","scrollArgs","scrollAfterEdit","enablePersistence","scrollPosition","offset","isDestroyed","document","activeElement","info","sentinel","viewInfo","currentInfo","getInfoFromView","direction","axis","prevInfo","toString","event","top","scrollTop","notify","requestType","focusElement","isIE","hideSpinner","restoreEdit","setColumnIndexesInView","pageSettings","currentPage","loadNext","loadSelf","nextInfo","block","blk","isBlockAvailable","e","isBlockAdded","tempBlocks","infoType","sentinelInfo","endIndex","preEndIndex","getPageFromTop","getBlockIndexes","blocks","ensureBlocks","activeKey","newBlock","indexOf","filter","val","every","bind","Math","max","firstBlock","ceil","rowIndex","getBlockSize","getColumnIndexes","getColumnIndexesInView","setKeyboardNavIndex","blazorDataLoad","blzRowIndex","blur","index","mIdx","old","indexes","isFrozenGrid","ind","isEndBlock","some","result","getGroupedTotalBlocks","getTotalBlocks","appendContent","target","newChild","isFrozen","frzCols","getFrozenColumns","getFrozenLeftColumnsCount","colVFtable","checkFirstBlockColIndexes","cBlock","cOffset","getColumnOffset","width","groupSettings","columns","refreshOffsets","element","vHeight","getBoundingClientRect","value","translate","getTranslateY","adjustMovableTable","cIndex","setMovableWrapperWidth","setWrapperWidth","name","parentNode","renderFrozenRightContent","getContent","getFrozenVirtualContent","getMovableVirtualContent","isReact","rowTemplate","i","children","getFrozenMode","leftRight","sTop","setVirtualHeight","setPageHeight","getOffset","focus","lastPage","firstElementChild","autoCol","focusCell","restoreAdd","ensureSelectedRowPosition","validationScrollLeft","initialRowTop","gridTop","getRowByIndex","left","trigger","validationCol","cOffsets","getVisibleFrozenColumns","movableContent","scrollLeft","editModule","editFormValidate","selectRowIndex","row","isRowInView","rowSelected","frozenCols","push","cell","cells","cellIndex","preventScroll","selectRow","parseInt","getAttribute","ariaRowIndex","allowEditing","editedRowIndex","keys","isXaxis","getMovableRowByIndex","editedRow","top_1","offsetHeight","getRowHeight","isEdit","startEdit","rowData","getRowObjectByIndex","getVirtualEditedData","editForms","getElementsByClassName","isFormDestroyed","formObj","getCurrentEditedData","startAdd","getMovableVirtualHeader","addedRow","isAdd","isTop","newRowPosition","maxPage","addRecord","onDataReady","count","pageSize","checkAndResetCache","resetScrollPosition","virtualHeightTemp","scrollableElementHeight","clientHeight","virtualHeight","setMovableVirtualHeight","total","iOffset","Number","border","min","getPage","cHeight","isOnenter","endTranslate","blockHeight","totalBlocks","maxBlock","onEntered","current","isWheel","check","showSpinner","xAxis","x","idx","maxLeft","y","dataBound","refreshVirtualFrozenHeight","selectedRowIndex","isLastBlockRow","transform","rowTop","remainHeight","translateY","lastRowTop","lastElementChild","scrollEle","visibleRowCount","floor","startIdx","refreshVirtualCacheOnRowDD","blockSize","currentblk","objIndex","secondBlock","thirdBlock","cache","movableCache","frozenRightCache","end","currentBlocks","refreshMaxPage","vcRows","action","addEventListener","actionBegin","actionComplete","refreshContentRows","selectVirtualRow","virtaulCellFocus","virtualCellFocus","virtualScrollEditActionBegin","editActionBegin","virtualScrollAddActionBegin","addActionBegin","virtualScrollEdit","virtualScrollEditSuccess","editSuccess","refreshVirtualCache","refreshCache","editReset","resetIsedit","getVirtualData","virtualScrollEditCancel","editCancel","refreshVirtualMaxPage","selectRowOnContextOpen","resetVirtualFocus","refreshVirtualEditFormCells","refreshCells","scrollToEdit","onActionBegin","fn","observe","gObj","scrollValues","down","off","col","allowScroll","getHeaderContent","uid","parentElement","offsetLeft","getFrozenVirtualHeader","offsetWidth","enableRtl","abs","rowObj","generateCells","error","isScroll","isOpen","dataIndex","updateCurrentViewData","cancel","refreshVirtualFrozenRows","ele","classList","contains","rowCell","ariaColIndex","emptyRow","editRequestTypes","dataActionRequestTypes","refreshColOffsets","contentModule","virtualRenderer","refreshVirtualElement","previousData","resetFilterDlgPosition","columnName","enableVirtualization","allowAdding","editForm","addForm","createEmptyRowdata","columnModel","field","setProperties","getRowCollection","rows","getModelGenerator","getRows","getDataRows","getMovableVirtualRowByIndex","getFrozenRightVirtualRowByIndex","isMovable","isRowObject","isFrozenRight","prev","rowCollection","getMovableDataRows","getFrozenRightDataRows","collection","selectedRow","getRowsObject","getVirtualRowIndex","bSize","apply","map","tmp","rem","size","vGroupOffsets","fcntColGrp","mcntColGrp","querySelectorAll","testRow","r","isDataRow","isRefresh","tr","c","clen","column","getNormalizedColumnIndex","displayVal","visible","colGrp","getMovableRows","getColGroup","setDisplayNone","invokedFromMedia","hideAtMedia","updateMediaColumns","partialRefresh","isAvailable","selectedIndex","selectionModule","isInteracted","rowHeight","getTablesCount","VirtualHeaderRenderer","gen","refreshUI","headerContent","movableWrapper","setFrozenTable","needFullRefresh","fhdrColGrp","mhdrColGrp","tablewidth","columnPositionChanged","setTable","getFreezeTableName","_i","_a","className","styles","placeholder","renderFrozenWrapper","renderFrozenPlaceHolder","renderMovableWrapper","renderMovablePlaceHolder","movablePlaceholder","xValue","yValue","full","setFreezeWrapperWidth"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { remove, createElement, closest, formatUnit, Browser, extend } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, removeClass } from '@syncfusion/ej2-base';\nimport { DataManager } from '@syncfusion/ej2-data';\nimport { dataReady, modelChanged, refreshVirtualBlock, contentReady } from '../base/constant';\nimport * as events from '../base/constant';\nimport { RenderType } from '../base/enum';\nimport { ContentRender } from './content-renderer';\nimport { HeaderRender } from './header-renderer';\nimport { InterSectionObserver } from '../services/intersection-observer';\nimport { VirtualRowModelGenerator } from '../services/virtual-row-model-generator';\nimport { isGroupAdaptive, ensureLastRow, ensureFirstRow, getEditedDataIndex, getTransformValues, resetRowObjectIndex } from '../base/util';\nimport { setStyleAttribute } from '@syncfusion/ej2-base';\nimport * as literals from '../base/string-literals';\n/**\n * VirtualContentRenderer\n *\n * @hidden\n */\nvar VirtualContentRenderer = /** @class */ (function (_super) {\n    __extends(VirtualContentRenderer, _super);\n    function VirtualContentRenderer(parent, locator) {\n        var _this = _super.call(this, parent, locator) || this;\n        _this.prevHeight = 0;\n        /** @hidden */\n        _this.startIndex = 0;\n        _this.preStartIndex = 0;\n        _this.preventEvent = false;\n        _this.actions = ['filtering', 'searching', 'grouping', 'ungrouping'];\n        /** @hidden */\n        _this.offsets = {};\n        _this.tmpOffsets = {};\n        /** @hidden */\n        _this.virtualEle = new VirtualElementHandler();\n        _this.offsetKeys = [];\n        _this.isFocused = false;\n        _this.isSelection = false;\n        _this.isBottom = false;\n        _this.rndrCount = 0;\n        _this.empty = undefined;\n        _this.isCancel = false;\n        _this.requestTypes = ['beginEdit', 'cancel', 'delete', 'add', 'save'];\n        _this.isNormaledit = _this.parent.editSettings.mode === 'Normal';\n        /** @hidden */\n        _this.virtualData = {};\n        _this.emptyRowData = {};\n        _this.vfColIndex = [];\n        _this.frzIdx = 1;\n        _this.orderRowObj = [];\n        _this.mvbOrderRowObj = [];\n        _this.frOrderRowObj = [];\n        _this.isContextMenuOpen = false;\n        _this.isSelectionScroll = false;\n        _this.validationCheck = false;\n        _this.locator = locator;\n        _this.eventListener('on');\n        _this.parent.on(events.columnVisibilityChanged, _this.setVisible, _this);\n        _this.vgenerator = _this.generator;\n        return _this;\n    }\n    VirtualContentRenderer.prototype.renderTable = function () {\n        this.header = this.locator.getService('rendererFactory').getRenderer(RenderType.Header);\n        _super.prototype.renderTable.call(this);\n        this.virtualEle.table = this.getTable();\n        this.virtualEle.content = this.content = this.getPanel().querySelector('.' + literals.content);\n        this.virtualEle.renderWrapper(this.parent.height);\n        this.virtualEle.renderPlaceHolder();\n        this.virtualEle.wrapper.style.position = 'absolute';\n        var debounceEvent = (this.parent.dataSource instanceof DataManager && !this.parent.dataSource.dataSource.offline);\n        var opt = {\n            container: this.content, pageHeight: this.getBlockHeight() * 2, debounceEvent: debounceEvent,\n            axes: this.parent.enableColumnVirtualization ? ['X', 'Y'] : ['Y']\n        };\n        this.observer = new InterSectionObserver(this.virtualEle.wrapper, opt);\n    };\n    VirtualContentRenderer.prototype.renderEmpty = function (tbody) {\n        this.getTable().appendChild(tbody);\n        this.virtualEle.adjustTable(0, 0);\n    };\n    VirtualContentRenderer.prototype.getReorderedFrozenRows = function (args) {\n        var blockIndex = args.virtualInfo.blockIndexes;\n        var colsIndex = args.virtualInfo.columnIndexes;\n        var page = args.virtualInfo.page;\n        args.virtualInfo.blockIndexes = [1, 2];\n        args.virtualInfo.page = 1;\n        if (!args.renderMovableContent) {\n            args.virtualInfo.columnIndexes = [];\n        }\n        var recordslength = this.parent.getCurrentViewRecords().length;\n        var firstRecords = this.parent.renderModule.data.dataManager.dataSource.json.slice(0, recordslength);\n        var virtualRows = this.vgenerator.generateRows(firstRecords, args);\n        args.virtualInfo.blockIndexes = blockIndex;\n        args.virtualInfo.columnIndexes = colsIndex;\n        args.virtualInfo.page = page;\n        return virtualRows.splice(0, this.parent.frozenRows);\n    };\n    VirtualContentRenderer.prototype.scrollListener = function (scrollArgs) {\n        this.scrollAfterEdit();\n        if (this.parent.enablePersistence) {\n            this.parent.scrollPosition = scrollArgs.offset;\n        }\n        if (this.preventEvent || this.parent.isDestroyed) {\n            this.preventEvent = false;\n            return;\n        }\n        if (isNullOrUndefined(document.activeElement)) {\n            this.isFocused = false;\n        }\n        else {\n            this.isFocused = this.content === closest(document.activeElement, '.' + literals.content) || this.content === document.activeElement;\n        }\n        var info = scrollArgs.sentinel;\n        var viewInfo = this.currentInfo = this.getInfoFromView(scrollArgs.direction, info, scrollArgs.offset);\n        if (isGroupAdaptive(this.parent)) {\n            if ((info.axis === 'Y' && viewInfo.blockIndexes && this.prevInfo.blockIndexes.toString() === viewInfo.blockIndexes.toString())\n                && scrollArgs.direction === 'up' && viewInfo.blockIndexes[viewInfo.blockIndexes.length - 1] !== 2) {\n                return;\n            }\n            else {\n                viewInfo.event = 'refresh-virtual-block';\n                if (!isNullOrUndefined(viewInfo.offsets)) {\n                    viewInfo.offsets.top = this.content.scrollTop;\n                }\n                this.parent.notify(viewInfo.event, { requestType: 'virtualscroll', virtualInfo: viewInfo, focusElement: scrollArgs.focusElement });\n                return;\n            }\n        }\n        if (this.prevInfo && ((info.axis === 'Y' && this.prevInfo.blockIndexes.toString() === viewInfo.blockIndexes.toString())\n            || (info.axis === 'X' && this.prevInfo.columnIndexes.toString() === viewInfo.columnIndexes.toString()))) {\n            if (Browser.isIE) {\n                this.parent.hideSpinner();\n            }\n            this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n            if (info.axis === 'Y') {\n                this.restoreEdit();\n            }\n            return;\n        }\n        this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization ? viewInfo.columnIndexes : []);\n        this.parent.pageSettings.currentPage = viewInfo.loadNext && !viewInfo.loadSelf ? viewInfo.nextInfo.page : viewInfo.page;\n        this.requestType = 'virtualscroll';\n        this.parent.notify(viewInfo.event, {\n            requestType: 'virtualscroll', virtualInfo: viewInfo,\n            focusElement: scrollArgs.focusElement\n        });\n    };\n    VirtualContentRenderer.prototype.block = function (blk) {\n        return this.vgenerator.isBlockAvailable(blk);\n    };\n    VirtualContentRenderer.prototype.getInfoFromView = function (direction, info, e) {\n        var isBlockAdded = false;\n        var tempBlocks = [];\n        var infoType = { direction: direction, sentinelInfo: info, offsets: e,\n            startIndex: this.preStartIndex, endIndex: this.preEndIndex };\n        infoType.page = this.getPageFromTop(e.top, infoType);\n        infoType.blockIndexes = tempBlocks = this.vgenerator.getBlockIndexes(infoType.page);\n        infoType.loadSelf = !this.vgenerator.isBlockAvailable(tempBlocks[infoType.block]);\n        var blocks = this.ensureBlocks(infoType);\n        if (this.activeKey === 'upArrow' && infoType.blockIndexes.toString() !== blocks.toString()) {\n            // To avoid dupilcate row index problem in key focus support\n            var newBlock = blocks[blocks.length - 1];\n            if (infoType.blockIndexes.indexOf(newBlock) === -1) {\n                isBlockAdded = true;\n            }\n        }\n        infoType.blockIndexes = blocks;\n        infoType.loadNext = !blocks.filter(function (val) { return tempBlocks.indexOf(val) === -1; })\n            .every(this.block.bind(this));\n        infoType.event = (infoType.loadNext || infoType.loadSelf) ? modelChanged : refreshVirtualBlock;\n        infoType.nextInfo = infoType.loadNext ? { page: Math.max(1, infoType.page + (direction === 'down' ? 1 : -1)) } : {};\n        if (isBlockAdded) {\n            infoType.blockIndexes = [infoType.blockIndexes[0] - 1, infoType.blockIndexes[0], infoType.blockIndexes[0] + 1];\n        }\n        if (this.activeKey === 'downArrow') {\n            var firstBlock = Math.ceil(this.rowIndex / this.getBlockSize());\n            if (firstBlock !== 1 && (infoType.blockIndexes[1] !== firstBlock || infoType.blockIndexes.length < 3)) {\n                infoType.blockIndexes = [firstBlock - 1, firstBlock, firstBlock + 1];\n            }\n        }\n        infoType.columnIndexes = info.axis === 'X' ? this.vgenerator.getColumnIndexes() : this.parent.getColumnIndexesInView();\n        if (this.parent.enableColumnVirtualization && info.axis === 'X') {\n            infoType.event = refreshVirtualBlock;\n        }\n        return infoType;\n    };\n    VirtualContentRenderer.prototype.setKeyboardNavIndex = function () {\n        this.blazorDataLoad = true;\n        if (this.activeKey === 'downArrow' || this.activeKey === 'upArrow') {\n            this.blzRowIndex = this.activeKey === 'downArrow' ? this.rowIndex + 1 : this.rowIndex - 1;\n            document.activeElement.blur();\n        }\n    };\n    VirtualContentRenderer.prototype.ensureBlocks = function (info) {\n        var _this = this;\n        var index = info.blockIndexes[info.block];\n        var mIdx;\n        var old = index;\n        var max = Math.max;\n        var indexes = info.direction === 'down' ? [max(index, 1), ++index, ++index] : [max(index - 1, 1), index, index + 1];\n        if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid()) {\n            // To avoid frozen content white space issue\n            if (info.sentinelInfo.axis === 'X' || (info.sentinelInfo.axis === 'Y' && (info.page === this.prevInfo.page))) {\n                indexes = this.prevInfo.blockIndexes;\n            }\n        }\n        indexes = indexes.filter(function (val, ind) { return indexes.indexOf(val) === ind; });\n        if (this.prevInfo.blockIndexes.toString() === indexes.toString()) {\n            return indexes;\n        }\n        if (info.loadSelf || (info.direction === 'down' && this.isEndBlock(old))) {\n            indexes = this.vgenerator.getBlockIndexes(info.page);\n        }\n        indexes.some(function (val, ind) {\n            var result = val === (isGroupAdaptive(_this.parent) ? _this.getGroupedTotalBlocks() : _this.getTotalBlocks());\n            if (result) {\n                mIdx = ind;\n            }\n            return result;\n        });\n        if (mIdx !== undefined) {\n            indexes = indexes.slice(0, mIdx + 1);\n            if (info.block === 0 && indexes.length === 1 && this.vgenerator.isBlockAvailable(indexes[0] - 1)) {\n                indexes = [indexes[0] - 1, indexes[0]];\n            }\n        }\n        return indexes;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    VirtualContentRenderer.prototype.appendContent = function (target, newChild, e) {\n        var _this = this;\n        // currentInfo value will be used if there are multiple dom updates happened due to mousewheel\n        var isFrozen = this.parent.isFrozenGrid();\n        var frzCols = this.parent.getFrozenColumns() || this.parent.getFrozenLeftColumnsCount();\n        var colVFtable = this.parent.enableColumnVirtualization && isFrozen;\n        this.checkFirstBlockColIndexes(e);\n        var info = e.virtualInfo.sentinelInfo && e.virtualInfo.sentinelInfo.axis === 'Y' && this.currentInfo.page &&\n            this.currentInfo.page !== e.virtualInfo.page ? this.currentInfo : e.virtualInfo;\n        this.prevInfo = this.prevInfo || e.virtualInfo;\n        var cBlock = (info.columnIndexes[0]) - 1;\n        if (colVFtable && info.columnIndexes[0] === frzCols) {\n            cBlock = (info.columnIndexes[0] - frzCols) - 1;\n        }\n        var cOffset = this.getColumnOffset(cBlock);\n        var width;\n        var blocks = info.blockIndexes;\n        if (this.parent.groupSettings.columns.length) {\n            this.refreshOffsets();\n        }\n        if (this.parent.height === '100%') {\n            this.parent.element.style.height = '100%';\n        }\n        var vHeight = this.parent.height.toString().indexOf('%') < 0 ? this.content.getBoundingClientRect().height :\n            this.parent.element.getBoundingClientRect().height;\n        if (!this.requestTypes.some(function (value) { return value === _this.requestType; })) {\n            var translate = this.getTranslateY(this.content.scrollTop, vHeight, info);\n            this.virtualEle.adjustTable(colVFtable ? 0 : cOffset, translate);\n            if (colVFtable) {\n                this.virtualEle.adjustMovableTable(cOffset, 0);\n            }\n        }\n        if (this.parent.enableColumnVirtualization) {\n            this.header.virtualEle.adjustTable(colVFtable ? 0 : cOffset, 0);\n            if (colVFtable) {\n                this.header.virtualEle.adjustMovableTable(cOffset, 0);\n            }\n        }\n        if (this.parent.enableColumnVirtualization) {\n            var cIndex = info.columnIndexes;\n            width = this.getColumnOffset(cIndex[cIndex.length - 1]) - this.getColumnOffset(cIndex[0] - 1) + '';\n            if (colVFtable) {\n                this.header.virtualEle.setMovableWrapperWidth(width);\n            }\n            else {\n                this.header.virtualEle.setWrapperWidth(width);\n            }\n        }\n        if (colVFtable) {\n            this.virtualEle.setMovableWrapperWidth(width, Browser.isIE || Browser.info.name === 'edge');\n        }\n        else {\n            this.virtualEle.setWrapperWidth(width, Browser.isIE || Browser.info.name === 'edge');\n        }\n        if (!isNullOrUndefined(target.parentNode)) {\n            remove(target);\n        }\n        var tbody;\n        if (isFrozen) {\n            if (e.renderFrozenRightContent) {\n                tbody = this.parent.getContent().querySelector('.e-frozen-right-content').querySelector(literals.tbody);\n            }\n            else if (!e.renderMovableContent) {\n                tbody = this.parent.getFrozenVirtualContent().querySelector(literals.tbody);\n            }\n            else if (e.renderMovableContent) {\n                tbody = this.parent.getMovableVirtualContent().querySelector(literals.tbody);\n            }\n        }\n        else {\n            tbody = this.parent.element.querySelector('.' + literals.content).querySelector(literals.tbody);\n        }\n        if (tbody) {\n            remove(tbody);\n            target = null;\n        }\n        var isReact = this.parent.isReact && !isNullOrUndefined(this.parent.rowTemplate);\n        if (!isReact) {\n            target = this.parent.createElement(literals.tbody);\n            target.appendChild(newChild);\n        }\n        else {\n            target = newChild;\n        }\n        if (this.parent.frozenRows && e.requestType === 'virtualscroll' && this.parent.pageSettings.currentPage === 1) {\n            for (var i = 0; i < this.parent.frozenRows; i++) {\n                target.children[0].remove();\n            }\n        }\n        if (isFrozen) {\n            if (e.renderFrozenRightContent) {\n                this.parent.getContent().querySelector('.e-frozen-right-content').querySelector('.' + literals.table).appendChild(target);\n                this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n            }\n            else if (!e.renderMovableContent) {\n                this.parent.getFrozenVirtualContent().querySelector('.' + literals.table).appendChild(target);\n            }\n            else if (e.renderMovableContent) {\n                this.parent.getMovableVirtualContent().querySelector('.' + literals.table).appendChild(target);\n                if (this.parent.getFrozenMode() !== literals.leftRight) {\n                    this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n                }\n            }\n            if (this.vfColIndex.length) {\n                e.virtualInfo.columnIndexes = info.columnIndexes = extend([], this.vfColIndex);\n                this.vfColIndex = e.renderMovableContent ? [] : this.vfColIndex;\n            }\n        }\n        else {\n            this.getTable().appendChild(target);\n            this.requestType = this.requestType === 'virtualscroll' ? this.empty : this.requestType;\n        }\n        if (this.parent.groupSettings.columns.length) {\n            if (!isGroupAdaptive(this.parent) && info.direction === 'up') {\n                var blk = this.offsets[this.getTotalBlocks()] - this.prevHeight;\n                this.preventEvent = true;\n                var sTop = this.content.scrollTop;\n                this.content.scrollTop = sTop + blk;\n            }\n            this.setVirtualHeight();\n            this.observer.setPageHeight(this.getOffset(blocks[blocks.length - 1]) - this.getOffset(blocks[0] - 1));\n        }\n        this.prevInfo = info;\n        if (this.isFocused && this.activeKey !== 'downArrow' && this.activeKey !== 'upArrow') {\n            this.content.focus();\n        }\n        var lastPage = Math.ceil(this.getTotalBlocks() / 2);\n        if (this.isBottom) {\n            this.isBottom = false;\n            this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 1];\n        }\n        if ((this.parent.pageSettings.currentPage === lastPage) && blocks.length === 1) {\n            this.isBottom = true;\n            this.parent.getContent().firstElementChild.scrollTop = this.offsets[this.offsetKeys.length - 2];\n        }\n        if (e.requestType === 'virtualscroll' && e.virtualInfo.sentinelInfo.axis === 'X') {\n            this.parent.notify(events.autoCol, {});\n        }\n        this.focusCell(e);\n        this.restoreEdit(e);\n        this.restoreAdd(e);\n        this.ensureSelectedRowPosition();\n        this.validationScrollLeft(e, isFrozen);\n        if (!this.initialRowTop) {\n            var gridTop = this.parent.element.getBoundingClientRect().top;\n            this.initialRowTop = this.parent.getRowByIndex(0).getBoundingClientRect().top - gridTop;\n        }\n    };\n    VirtualContentRenderer.prototype.validationScrollLeft = function (e, isFrozen) {\n        var left = this.parent.getFrozenColumns();\n        var table = this.parent.getFrozenMode();\n        var trigger = !isFrozen || e && (left || table === 'Left' || table === 'Right' ? e.renderMovableContent\n            : e.renderFrozenRightContent);\n        if (this.validationCheck && trigger) {\n            if (this.validationCol) {\n                var offset = this.vgenerator.cOffsets[(this.validationCol.index - this.parent.getVisibleFrozenColumns()) - 1];\n                this.validationCol = null;\n                if (this.parent.isFrozenGrid()) {\n                    this.movableContent.scrollLeft = offset;\n                }\n                else {\n                    this.content.scrollLeft = offset;\n                }\n            }\n            else {\n                this.validationCheck = false;\n                this.parent.editModule.editFormValidate();\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.ensureSelectedRowPosition = function () {\n        if (!this.isSelection && this.isSelectionScroll && !isNullOrUndefined(this.selectRowIndex)) {\n            this.isSelectionScroll = false;\n            var row = this.parent.getRowByIndex(this.selectRowIndex);\n            if (row && !this.isRowInView(row)) {\n                this.rowSelected({ rowIndex: this.selectRowIndex, row: row }, true);\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.checkFirstBlockColIndexes = function (e) {\n        if (this.parent.enableColumnVirtualization && this.parent.isFrozenGrid() && e.virtualInfo.columnIndexes[0] === 0) {\n            var indexes = [];\n            var frozenCols = this.parent.getFrozenColumns() || this.parent.getFrozenLeftColumnsCount();\n            if (!e.renderMovableContent && e.virtualInfo.columnIndexes.length > frozenCols) {\n                this.vfColIndex = e.virtualInfo.columnIndexes;\n                for (var i = 0; i < frozenCols; i++) {\n                    indexes.push(i);\n                }\n                e.virtualInfo.columnIndexes = indexes;\n            }\n            else if (e.renderMovableContent) {\n                if (!this.vfColIndex.length) {\n                    this.vfColIndex = extend([], e.virtualInfo.columnIndexes);\n                }\n                e.virtualInfo.columnIndexes = extend([], this.vfColIndex);\n                e.virtualInfo.columnIndexes.splice(0, frozenCols);\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    VirtualContentRenderer.prototype.focusCell = function (e) {\n        if (this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow') {\n            return;\n        }\n        var row = this.parent.getRowByIndex(this.rowIndex);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var cell = row.cells[this.cellIndex];\n        cell.focus({ preventScroll: true });\n        this.parent.selectRow(parseInt(row.getAttribute(literals.ariaRowIndex), 10));\n        this.activeKey = this.empty;\n    };\n    VirtualContentRenderer.prototype.restoreEdit = function (e) {\n        if (this.isNormaledit) {\n            var left = this.parent.getFrozenColumns();\n            var isFrozen = e && this.parent.isFrozenGrid();\n            var table = this.parent.getFrozenMode();\n            var trigger = e && (left || table === 'Left' || table === 'Right' ? e.renderMovableContent\n                : e.renderFrozenRightContent);\n            if ((!isFrozen || (isFrozen && trigger)) && this.parent.editSettings.allowEditing\n                && this.parent.editModule && !isNullOrUndefined(this.editedRowIndex)) {\n                var row = this.getRowByIndex(this.editedRowIndex);\n                var content = this.content;\n                var keys = Object.keys(this.virtualData);\n                var isXaxis = e && e.virtualInfo && e.virtualInfo.sentinelInfo.axis === 'X';\n                if (isFrozen && isXaxis) {\n                    row = this.parent.getMovableRowByIndex(this.editedRowIndex);\n                    content = this.movableContent;\n                }\n                if (keys.length && row && !content.querySelector('.' + literals.editedRow)) {\n                    var top_1 = row.getBoundingClientRect().top;\n                    if (isXaxis || (top_1 < this.content.offsetHeight && top_1 > this.parent.getRowHeight())) {\n                        this.parent.isEdit = false;\n                        this.parent.editModule.startEdit(row);\n                    }\n                }\n                if (row && this.content.querySelector('.' + literals.editedRow) && !keys.length) {\n                    var rowData = extend({}, this.getRowObjectByIndex(this.editedRowIndex));\n                    this.virtualData = this.getVirtualEditedData(rowData);\n                }\n            }\n            this.restoreAdd(e);\n        }\n    };\n    VirtualContentRenderer.prototype.getVirtualEditedData = function (rowData) {\n        var editForms = [].slice.call(this.parent.element.getElementsByClassName('e-gridform'));\n        var isFormDestroyed = this.parent.editModule && this.parent.editModule.formObj\n            && this.parent.editModule.formObj.isDestroyed;\n        if (!isFormDestroyed) {\n            for (var i = 0; i < editForms.length; i++) {\n                rowData = this.parent.editModule.getCurrentEditedData(editForms[i], rowData);\n            }\n        }\n        return rowData;\n    };\n    VirtualContentRenderer.prototype.restoreAdd = function (e) {\n        var left = this.parent.getFrozenColumns();\n        var isFrozen = e && this.parent.isFrozenGrid();\n        var table = this.parent.getFrozenMode();\n        var isXaxis = e && e.virtualInfo && e.virtualInfo.sentinelInfo && e.virtualInfo.sentinelInfo.axis === 'X';\n        var startAdd = isXaxis && isFrozen ? !(this.parent.getMovableVirtualHeader().querySelector('.' + literals.addedRow)\n            || this.parent.getMovableVirtualContent().querySelector('.' + literals.addedRow)) : !this.parent.element.querySelector('.' + literals.addedRow);\n        var trigger = e && (left || table === 'Left' || table === 'Right' ? e.renderMovableContent : e.renderFrozenRightContent);\n        if ((!isFrozen || (isFrozen && trigger)) && this.isNormaledit && this.isAdd && startAdd) {\n            var isTop = this.parent.editSettings.newRowPosition === 'Top' && this.content.scrollTop < this.parent.getRowHeight();\n            var isBottom = this.parent.editSettings.newRowPosition === 'Bottom'\n                && this.parent.pageSettings.currentPage === this.maxPage;\n            if (isTop || isBottom) {\n                this.parent.isEdit = false;\n                this.parent.addRecord();\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.onDataReady = function (e) {\n        if (!isNullOrUndefined(e.count)) {\n            this.count = e.count;\n            this.maxPage = Math.ceil(e.count / this.parent.pageSettings.pageSize);\n        }\n        this.vgenerator.checkAndResetCache(e.requestType);\n        if (['refresh', 'filtering', 'searching', 'grouping', 'ungrouping', 'reorder', undefined]\n            .some(function (value) { return e.requestType === value; })) {\n            this.refreshOffsets();\n        }\n        this.setVirtualHeight();\n        this.resetScrollPosition(e.requestType);\n    };\n    /**\n     * @param {number} height - specifies the height\n     * @returns {void}\n     * @hidden\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    VirtualContentRenderer.prototype.setVirtualHeight = function (height) {\n        var width = this.parent.enableColumnVirtualization ?\n            this.getColumnOffset(this.parent.columns.length + this.parent.groupSettings.columns.length - 1) + 'px' : '100%';\n        if (this.parent.isFrozenGrid()) {\n            var virtualHeightTemp = (this.parent.pageSettings.currentPage === 1 && Object.keys(this.offsets).length <= 2) ?\n                this.offsets[1] : this.offsets[this.getTotalBlocks() - 2];\n            var scrollableElementHeight = this.content.clientHeight;\n            virtualHeightTemp = virtualHeightTemp > scrollableElementHeight ? virtualHeightTemp : 0;\n            // To overcome the white space issue in last page (instead of position absolute)\n            this.virtualEle.setVirtualHeight(virtualHeightTemp, width);\n        }\n        else {\n            var virtualHeight = (this.offsets[isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() :\n                this.getTotalBlocks()]);\n            this.virtualEle.setVirtualHeight(virtualHeight, width);\n        }\n        if (this.parent.enableColumnVirtualization) {\n            this.header.virtualEle.setVirtualHeight(1, width);\n            if (this.parent.isFrozenGrid()) {\n                this.virtualEle.setMovableVirtualHeight(1, width);\n                this.header.virtualEle.setMovableVirtualHeight(1, width);\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.getPageFromTop = function (sTop, info) {\n        var _this = this;\n        var total = (isGroupAdaptive(this.parent)) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n        var page = 0;\n        this.offsetKeys.some(function (offset) {\n            var iOffset = Number(offset);\n            var border = sTop <= _this.offsets[offset] || (iOffset === total && sTop > _this.offsets[offset]);\n            if (border) {\n                if (_this.offsetKeys.length % 2 !== 0 && iOffset.toString() === _this.offsetKeys[_this.offsetKeys.length - 2]\n                    && sTop <= _this.offsets[_this.offsetKeys.length - 1]) {\n                    iOffset = iOffset + 1;\n                }\n                info.block = iOffset % 2 === 0 ? 1 : 0;\n                page = Math.max(1, Math.min(_this.vgenerator.getPage(iOffset), _this.maxPage));\n            }\n            return border;\n        });\n        return page;\n    };\n    VirtualContentRenderer.prototype.getTranslateY = function (sTop, cHeight, info, isOnenter) {\n        if (info === undefined) {\n            info = { page: this.getPageFromTop(sTop, {}) };\n            info.blockIndexes = this.vgenerator.getBlockIndexes(info.page);\n        }\n        var block = (info.blockIndexes[0] || 1) - 1;\n        var translate = this.getOffset(block);\n        var endTranslate = this.getOffset(info.blockIndexes[info.blockIndexes.length - 1]);\n        if (isOnenter) {\n            info = this.prevInfo;\n        }\n        var result = translate > sTop ?\n            this.getOffset(block - 1) : endTranslate < (sTop + cHeight) ? this.getOffset(block + 1) : translate;\n        var blockHeight = this.offsets[info.blockIndexes[info.blockIndexes.length - 1]] -\n            this.tmpOffsets[info.blockIndexes[0]];\n        var totalBlocks = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n        if (result + blockHeight > this.offsets[totalBlocks]) {\n            result -= (result + blockHeight) - this.offsets[totalBlocks];\n        }\n        return result;\n    };\n    VirtualContentRenderer.prototype.getOffset = function (block) {\n        return Math.min(this.offsets[block] | 0, this.offsets[this.maxBlock] | 0);\n    };\n    VirtualContentRenderer.prototype.onEntered = function () {\n        var _this = this;\n        return function (element, current, direction, e, isWheel, check) {\n            if (Browser.isIE && !isWheel && check && !_this.preventEvent) {\n                _this.parent.showSpinner();\n            }\n            var colVFtable = _this.parent.enableColumnVirtualization && _this.parent.isFrozenGrid();\n            var xAxis = current.axis === 'X';\n            var top = _this.prevInfo.offsets ? _this.prevInfo.offsets.top : null;\n            var height = _this.content.getBoundingClientRect().height;\n            var x = _this.getColumnOffset(xAxis ? _this.vgenerator.getColumnIndexes()[0] - 1 : _this.prevInfo.columnIndexes[0] - 1);\n            if (xAxis && !colVFtable) {\n                var idx = Object.keys(_this.vgenerator.cOffsets).length - _this.prevInfo.columnIndexes.length;\n                var maxLeft = _this.vgenerator.cOffsets[idx - 1];\n                x = x > maxLeft ? maxLeft : x; //TODO: This fix horizontal scrollbar jumping issue in column virtualization.\n            }\n            var y = _this.getTranslateY(e.top, height, xAxis && top === e.top ? _this.prevInfo : undefined, true);\n            _this.virtualEle.adjustTable(colVFtable ? 0 : x, Math.min(y, _this.offsets[_this.maxBlock]));\n            if (colVFtable) {\n                _this.virtualEle.adjustMovableTable(x, 0);\n            }\n            if (_this.parent.enableColumnVirtualization) {\n                _this.header.virtualEle.adjustTable(colVFtable ? 0 : x, 0);\n                if (colVFtable) {\n                    _this.header.virtualEle.adjustMovableTable(x, 0);\n                }\n            }\n        };\n    };\n    VirtualContentRenderer.prototype.dataBound = function () {\n        this.parent.notify(events.refreshVirtualFrozenHeight, {});\n        if (this.isSelection && this.activeKey !== 'upArrow' && this.activeKey !== 'downArrow') {\n            this.parent.selectRow(this.selectedRowIndex);\n        }\n        else {\n            this.activeKey = this.empty;\n        }\n    };\n    VirtualContentRenderer.prototype.rowSelected = function (args, isSelection) {\n        if ((this.isSelection || isSelection) && !this.isLastBlockRow(args.rowIndex)) {\n            var transform = getTransformValues(this.content.firstElementChild);\n            var gridTop = this.parent.element.getBoundingClientRect().top;\n            var rowTop = args.row.getBoundingClientRect().top - gridTop;\n            var height = this.content.getBoundingClientRect().height;\n            var isBottom = height < rowTop;\n            var remainHeight = isBottom ? rowTop - height : this.initialRowTop - rowTop;\n            var translateY = isBottom ? transform.height - remainHeight : transform.height + remainHeight;\n            this.virtualEle.adjustTable(transform.width, translateY);\n            var lastRowTop = this.content.querySelector('tbody').lastElementChild.getBoundingClientRect().top - gridTop;\n            if (lastRowTop < height) {\n                translateY = translateY + (height - (args.row.getBoundingClientRect().top - gridTop));\n                this.virtualEle.adjustTable(transform.width, translateY - (this.parent.getRowHeight() / 2));\n            }\n        }\n        this.isSelection = false;\n    };\n    VirtualContentRenderer.prototype.isLastBlockRow = function (index) {\n        var scrollEle = this.parent.getContent().firstElementChild;\n        var visibleRowCount = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n        var startIdx = (this.maxPage * this.parent.pageSettings.pageSize) - visibleRowCount;\n        return index >= startIdx;\n    };\n    VirtualContentRenderer.prototype.refreshVirtualCacheOnRowDD = function (args) {\n        var blockSize = this.getBlockSize();\n        var currentblk = Math.ceil((args.objIndex + 1) / blockSize);\n        var secondBlock = args.objIndex - args.startIndex >= blockSize ? blockSize : 0;\n        var thirdBlock = args.objIndex - args.startIndex >= (blockSize + blockSize) ? blockSize : 0;\n        this.orderRowObj.push(this.vgenerator.cache[currentblk][args.objIndex - args.startIndex - secondBlock - thirdBlock]);\n        if (this.parent.isFrozenGrid()) {\n            this.mvbOrderRowObj.push(this.vgenerator.movableCache[currentblk][args.objIndex - args.startIndex - secondBlock - thirdBlock]);\n            if (this.parent.getFrozenMode() === literals.leftRight) {\n                // eslint-disable-next-line\n                this.frOrderRowObj.push(this.vgenerator.frozenRightCache[currentblk][args.objIndex - args.startIndex - secondBlock - thirdBlock]);\n            }\n        }\n        if (args.end === true) {\n            var currentBlocks = this.currentInfo.blockIndexes;\n            if (!currentBlocks) {\n                currentBlocks = [1, 2];\n            }\n            resetRowObjectIndex(this.parent, this.orderRowObj, args.startIndex);\n            if (this.parent.isFrozenGrid()) {\n                resetRowObjectIndex(this.parent, this.mvbOrderRowObj, args.startIndex);\n                if (this.parent.getFrozenMode() === literals.leftRight) {\n                    resetRowObjectIndex(this.parent, this.frOrderRowObj, args.startIndex);\n                }\n            }\n            for (var i = 0; i < currentBlocks.length; i++) {\n                this.vgenerator.cache[currentBlocks[i]] = this.orderRowObj.splice(0, blockSize);\n                if (this.parent.isFrozenGrid()) {\n                    this.vgenerator.movableCache[currentBlocks[i]] = this.mvbOrderRowObj.splice(0, blockSize);\n                    if (this.parent.getFrozenMode() === literals.leftRight) {\n                        this.vgenerator.frozenRightCache[currentBlocks[i]] = this.frOrderRowObj.splice(0, blockSize);\n                    }\n                }\n            }\n            this.orderRowObj = [];\n            this.orderRowObj = [];\n            this.mvbOrderRowObj = [];\n        }\n    };\n    VirtualContentRenderer.prototype.refreshMaxPage = function () {\n        if (this.parent.groupSettings.columns.length && this.parent.vcRows.length) {\n            this.maxPage = Math.ceil(this.parent.vcRows.length / this.parent.pageSettings.pageSize);\n        }\n    };\n    VirtualContentRenderer.prototype.eventListener = function (action) {\n        var _this = this;\n        this.parent[action](dataReady, this.onDataReady, this);\n        this.parent.addEventListener(events.dataBound, this.dataBound.bind(this));\n        this.parent.addEventListener(events.actionBegin, this.actionBegin.bind(this));\n        this.parent.addEventListener(events.actionComplete, this.actionComplete.bind(this));\n        this.parent.addEventListener(events.rowSelected, this.rowSelected.bind(this));\n        this.parent[action](refreshVirtualBlock, this.refreshContentRows, this);\n        this.parent[action](events.selectVirtualRow, this.selectVirtualRow, this);\n        this.parent[action](events.virtaulCellFocus, this.virtualCellFocus, this);\n        this.parent[action](events.virtualScrollEditActionBegin, this.editActionBegin, this);\n        this.parent[action](events.virtualScrollAddActionBegin, this.addActionBegin, this);\n        this.parent[action](events.virtualScrollEdit, this.restoreEdit, this);\n        this.parent[action](events.virtualScrollEditSuccess, this.editSuccess, this);\n        this.parent[action](events.refreshVirtualCache, this.refreshCache, this);\n        this.parent[action](events.editReset, this.resetIsedit, this);\n        this.parent[action](events.getVirtualData, this.getVirtualData, this);\n        this.parent[action](events.virtualScrollEditCancel, this.editCancel, this);\n        this.parent[action](events.refreshVirtualCacheOnRowDD, this.refreshVirtualCacheOnRowDD, this);\n        this.parent[action](events.refreshVirtualMaxPage, this.refreshMaxPage, this);\n        this.parent[action](events.selectRowOnContextOpen, this.selectRowOnContextOpen, this);\n        this.parent[action](events.resetVirtualFocus, this.resetVirtualFocus, this);\n        this.parent[action](events.refreshVirtualEditFormCells, this.refreshCells, this);\n        this.parent[action](events.scrollToEdit, this.scrollToEdit, this);\n        var event = this.actions;\n        for (var i = 0; i < event.length; i++) {\n            this.parent[action](event[i] + \"-begin\", this.onActionBegin, this);\n        }\n        var fn = function () {\n            _this.observer.observe(function (scrollArgs) { return _this.scrollListener(scrollArgs); }, _this.onEntered());\n            var gObj = _this.parent;\n            if (gObj.enablePersistence && gObj.scrollPosition) {\n                _this.content.scrollTop = gObj.scrollPosition.top;\n                var scrollValues = { direction: 'down', sentinel: _this.observer.sentinelInfo.down,\n                    offset: gObj.scrollPosition, focusElement: gObj.element };\n                _this.scrollListener(scrollValues);\n                if (gObj.enableColumnVirtualization) {\n                    _this.content.scrollLeft = gObj.scrollPosition.left;\n                }\n            }\n            _this.parent.off(contentReady, fn);\n        };\n        this.parent.on(contentReady, fn, this);\n    };\n    VirtualContentRenderer.prototype.scrollToEdit = function (col) {\n        var isFrozen = this.parent.isFrozenGrid();\n        var allowScroll = true;\n        this.validationCheck = true;\n        if (this.isAdd && this.content.scrollTop > 0) {\n            allowScroll = false;\n            var keys = Object.keys(this.offsets);\n            this.content.scrollTop = this.parent.editSettings.newRowPosition === 'Top' ? 0 : this.offsets[keys.length - 1];\n        }\n        var row = this.parent.getRowByIndex(this.editedRowIndex);\n        if (!row && !isNullOrUndefined(this.editedRowIndex)) {\n            if (!row || !this.isRowInView(row)) {\n                var rowIndex = this.parent.getRowHeight();\n                var scrollTop = this.editedRowIndex * rowIndex;\n                if (!isNullOrUndefined(scrollTop)) {\n                    allowScroll = false;\n                    this.content.scrollTop = scrollTop;\n                }\n            }\n        }\n        if (col && allowScroll) {\n            var offset = this.vgenerator.cOffsets[(col.index - this.parent.getVisibleFrozenColumns()) - 1];\n            if (!this.parent.enableColumnVirtualization) {\n                var header = this.parent.getHeaderContent().querySelector('.e-headercelldiv[e-mappinguid=\"' + col.uid + '\"]');\n                offset = isFrozen ? header.parentElement.offsetLeft\n                    - this.parent.getFrozenVirtualHeader().offsetWidth\n                    : header.parentElement.offsetLeft;\n            }\n            if (isFrozen) {\n                this.parent.getMovableVirtualContent().scrollLeft = this.parent.enableRtl ? -Math.abs(offset) : offset;\n            }\n            else {\n                this.content.scrollLeft = this.parent.enableRtl ? -Math.abs(offset) : offset;\n            }\n        }\n        if (col && !allowScroll) {\n            this.validationCol = col;\n        }\n    };\n    VirtualContentRenderer.prototype.refreshCells = function (rowObj) {\n        rowObj.cells = this.vgenerator.generateCells();\n    };\n    VirtualContentRenderer.prototype.resetVirtualFocus = function (e) {\n        this.isCancel = e.isCancel;\n    };\n    /**\n     * @param {Object} data - specifies the data\n     * @param {Object} data.virtualData -specifies the data\n     * @param {boolean} data.isAdd - specifies isAdd\n     * @param {boolean} data.isCancel - specifies boolean in cancel\n     * @param {boolean} data.isScroll - specifies boolean for scroll\n     * @returns {void}\n     * @hidden\n     */\n    VirtualContentRenderer.prototype.getVirtualData = function (data) {\n        if (this.isNormaledit) {\n            var error = this.parent.element.querySelector('.e-griderror:not([style*=\"display: none\"])');\n            var keys = Object.keys(this.virtualData);\n            data.isScroll = keys.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';\n            if (error) {\n                return;\n            }\n            this.virtualData = keys.length ? this.virtualData : data.virtualData;\n            this.getVirtualEditedData(this.virtualData);\n            data.virtualData = this.virtualData;\n            data.isAdd = this.isAdd;\n            data.isCancel = this.isCancel;\n        }\n    };\n    VirtualContentRenderer.prototype.selectRowOnContextOpen = function (args) {\n        this.isContextMenuOpen = args.isOpen;\n    };\n    VirtualContentRenderer.prototype.editCancel = function (args) {\n        var dataIndex = getEditedDataIndex(this.parent, args.data);\n        if (!isNullOrUndefined(dataIndex)) {\n            args.data = this.parent.getCurrentViewRecords()[dataIndex];\n        }\n    };\n    VirtualContentRenderer.prototype.editSuccess = function (args) {\n        if (this.isNormaledit) {\n            if (!this.isAdd && args.data) {\n                this.updateCurrentViewData(args.data);\n            }\n            this.isAdd = false;\n        }\n    };\n    VirtualContentRenderer.prototype.updateCurrentViewData = function (data) {\n        var dataIndex = getEditedDataIndex(this.parent, data);\n        if (!isNullOrUndefined(dataIndex)) {\n            this.parent.getCurrentViewRecords()[dataIndex] = data;\n        }\n    };\n    VirtualContentRenderer.prototype.actionBegin = function (args) {\n        if (args.requestType !== 'virtualscroll') {\n            this.requestType = args.requestType;\n        }\n        if (!args.cancel) {\n            this.parent.notify(events.refreshVirtualFrozenRows, args);\n        }\n    };\n    VirtualContentRenderer.prototype.virtualCellFocus = function (e) {\n        // To decide the action (select or scroll), when using arrow keys for cell focus\n        var ele = document.activeElement;\n        if (ele.classList.contains(literals.rowCell)\n            && e && (e.action === 'upArrow' || e.action === 'downArrow')) {\n            var rowIndex = parseInt(ele.parentElement.getAttribute(literals.ariaRowIndex), 10);\n            if (e && (e.action === 'downArrow' || e.action === 'upArrow')) {\n                var scrollEle = this.parent.getContent().firstElementChild;\n                if (e.action === 'downArrow') {\n                    rowIndex += 1;\n                }\n                else {\n                    rowIndex -= 1;\n                }\n                this.rowIndex = rowIndex;\n                this.cellIndex = parseInt(ele.getAttribute(literals.ariaColIndex), 10);\n                var row = this.parent.getRowByIndex(rowIndex);\n                var page = this.parent.pageSettings.currentPage;\n                var visibleRowCount = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n                var emptyRow = false;\n                if (isNullOrUndefined(row)) {\n                    emptyRow = true;\n                    if ((e.action === 'downArrow' && page === this.maxPage - 1) || (e.action === 'upArrow' && page === 1)) {\n                        emptyRow = false;\n                    }\n                }\n                if (emptyRow || (ensureLastRow(row, this.parent) && e.action === 'downArrow')\n                    || (ensureFirstRow(row, this.parent.getRowHeight() * 2) && e.action === 'upArrow')) {\n                    this.activeKey = e.action;\n                    scrollEle.scrollTop = e.action === 'downArrow' ?\n                        (rowIndex - visibleRowCount) * this.parent.getRowHeight() : rowIndex * this.parent.getRowHeight();\n                }\n                else {\n                    this.activeKey = this.empty;\n                }\n                this.parent.selectRow(rowIndex);\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.editActionBegin = function (e) {\n        this.editedRowIndex = e.index;\n        var rowData = extend({}, this.getRowObjectByIndex(e.index));\n        var keys = Object.keys(this.virtualData);\n        e.data = keys.length ? this.virtualData : rowData;\n        e.isScroll = keys.length !== 0 && this.currentInfo.sentinelInfo && this.currentInfo.sentinelInfo.axis === 'X';\n    };\n    VirtualContentRenderer.prototype.refreshCache = function (data) {\n        var block = Math.ceil((this.editedRowIndex + 1) / this.getBlockSize());\n        var index = this.editedRowIndex - ((block - 1) * this.getBlockSize());\n        this.vgenerator.cache[block][index].data = data;\n        if (this.vgenerator.movableCache[block]) {\n            this.vgenerator.movableCache[block][index].data = data;\n        }\n        if (this.vgenerator.frozenRightCache[block]) {\n            this.vgenerator.frozenRightCache[block][index].data = data;\n        }\n    };\n    VirtualContentRenderer.prototype.actionComplete = function (args) {\n        var editRequestTypes = ['delete', 'save', 'cancel'];\n        var dataActionRequestTypes = ['sorting', 'filtering', 'grouping', 'refresh', 'searching', 'ungrouping', 'reorder'];\n        if (editRequestTypes.some(function (value) { return value === args.requestType; })) {\n            this.refreshOffsets();\n            if (this.parent.isFrozenGrid()) {\n                this.vgenerator.refreshColOffsets();\n                this.parent.contentModule.virtualRenderer.virtualEle.setVirtualHeight();\n            }\n            else {\n                this.refreshVirtualElement();\n            }\n        }\n        if (this.isNormaledit && (dataActionRequestTypes.some(function (value) { return value === args.requestType; })\n            || editRequestTypes.some(function (value) { return value === args.requestType; }))) {\n            this.isCancel = true;\n            this.isAdd = false;\n            this.editedRowIndex = this.empty;\n            this.virtualData = {};\n            if (this.parent.editModule) {\n                this.parent.editModule.editModule.previousData = undefined;\n            }\n        }\n        if (this.parent.enableColumnVirtualization && args.requestType === 'filterafteropen'\n            && this.currentInfo.columnIndexes && this.currentInfo.columnIndexes[0] > 0) {\n            this.parent.resetFilterDlgPosition(args.columnName);\n        }\n    };\n    VirtualContentRenderer.prototype.resetIsedit = function () {\n        if (this.parent.enableVirtualization && this.isNormaledit) {\n            if ((this.parent.editSettings.allowEditing && Object.keys(this.virtualData).length)\n                || (this.parent.editSettings.allowAdding && this.isAdd)) {\n                this.parent.isEdit = true;\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.scrollAfterEdit = function () {\n        if (this.parent.editModule && this.parent.editSettings.allowEditing && this.isNormaledit) {\n            if (this.parent.element.querySelector('.e-gridform')) {\n                var editForm = this.parent.element.querySelector('.' + literals.editedRow);\n                var addForm = this.parent.element.querySelector('.' + literals.addedRow);\n                if (editForm || addForm) {\n                    var rowData = editForm ? extend({}, this.getRowObjectByIndex(this.editedRowIndex))\n                        : extend({}, this.emptyRowData);\n                    var keys = Object.keys(this.virtualData);\n                    this.virtualData = keys.length ? this.getVirtualEditedData(this.virtualData) : this.getVirtualEditedData(rowData);\n                }\n            }\n        }\n    };\n    VirtualContentRenderer.prototype.createEmptyRowdata = function () {\n        var _this = this;\n        this.parent.columnModel.filter(function (e) {\n            _this.emptyRowData[e.field] = _this.empty;\n        });\n    };\n    VirtualContentRenderer.prototype.addActionBegin = function (args) {\n        if (this.isNormaledit) {\n            if (!Object.keys(this.emptyRowData).length) {\n                this.createEmptyRowdata();\n            }\n            this.isAdd = true;\n            var page = this.parent.pageSettings.currentPage;\n            if (!this.parent.frozenRows && this.content.scrollTop > 0 && this.parent.editSettings.newRowPosition === 'Top') {\n                this.isAdd = true;\n                this.onActionBegin();\n                args.startEdit = false;\n                this.content.scrollTop = 0;\n            }\n            if (page < this.maxPage - 1 && this.parent.editSettings.newRowPosition === 'Bottom') {\n                this.isAdd = true;\n                this.parent.setProperties({ pageSettings: { currentPage: this.maxPage - 1 } }, true);\n                args.startEdit = false;\n                this.content.scrollTop = this.offsets[this.offsetKeys.length];\n            }\n        }\n    };\n    /**\n     * @param {number} index - specifies the index\n     * @returns {Object} returns the object\n     * @hidden\n     */\n    VirtualContentRenderer.prototype.getRowObjectByIndex = function (index) {\n        var data = this.getRowCollection(index, false, true);\n        return data;\n    };\n    VirtualContentRenderer.prototype.getBlockSize = function () {\n        return this.parent.pageSettings.pageSize >> 1;\n    };\n    VirtualContentRenderer.prototype.getBlockHeight = function () {\n        return this.getBlockSize() * this.parent.getRowHeight();\n    };\n    VirtualContentRenderer.prototype.isEndBlock = function (index) {\n        var totalBlocks = this.getTotalBlocks();\n        return index >= totalBlocks || index === totalBlocks - 1;\n    };\n    VirtualContentRenderer.prototype.getGroupedTotalBlocks = function () {\n        var rows = this.parent.vcRows;\n        return Math.floor((rows.length / this.getBlockSize()) < 1 ? 1 : rows.length / this.getBlockSize());\n    };\n    VirtualContentRenderer.prototype.getTotalBlocks = function () {\n        return Math.ceil(this.count / this.getBlockSize());\n    };\n    VirtualContentRenderer.prototype.getColumnOffset = function (block) {\n        return this.vgenerator.cOffsets[block] | 0;\n    };\n    VirtualContentRenderer.prototype.getModelGenerator = function () {\n        return new VirtualRowModelGenerator(this.parent);\n    };\n    VirtualContentRenderer.prototype.resetScrollPosition = function (action) {\n        if (this.actions.some(function (value) { return value === action; })) {\n            this.preventEvent = this.content.scrollTop !== 0;\n            this.content.scrollTop = 0;\n        }\n        if (action !== 'virtualscroll') {\n            this.isAdd = false;\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    VirtualContentRenderer.prototype.onActionBegin = function (e) {\n        //Update property silently..\n        this.parent.setProperties({ pageSettings: { currentPage: 1 } }, true);\n    };\n    VirtualContentRenderer.prototype.getRows = function () {\n        return this.vgenerator.getRows();\n    };\n    VirtualContentRenderer.prototype.getRowByIndex = function (index) {\n        var row;\n        if (isGroupAdaptive(this.parent)) {\n            row = this.parent.getDataRows()[index];\n        }\n        if (this.prevInfo) {\n            row = this.getRowCollection(index, false);\n        }\n        return row;\n    };\n    VirtualContentRenderer.prototype.getMovableVirtualRowByIndex = function (index) {\n        return this.getRowCollection(index, true);\n    };\n    VirtualContentRenderer.prototype.getFrozenRightVirtualRowByIndex = function (index) {\n        return this.getRowCollection(index, false, false, true);\n    };\n    VirtualContentRenderer.prototype.getRowCollection = function (index, isMovable, isRowObject, isFrozenRight) {\n        var prev = this.prevInfo.blockIndexes;\n        var startIdx = (prev[0] - 1) * this.getBlockSize();\n        var rowCollection = isMovable ? this.parent.getMovableDataRows() : this.parent.getDataRows();\n        rowCollection = isFrozenRight ? this.parent.getFrozenRightDataRows() : rowCollection;\n        var collection = isRowObject ? this.parent.getCurrentViewRecords() : rowCollection;\n        var selectedRow = collection[index - startIdx];\n        if (this.parent.frozenRows && this.parent.pageSettings.currentPage > 1) {\n            if (!isRowObject) {\n                selectedRow = index <= this.parent.frozenRows ? rowCollection[index]\n                    : rowCollection[(index - startIdx) + this.parent.frozenRows];\n            }\n            else {\n                selectedRow = index <= this.parent.frozenRows ? this.parent.getRowsObject()[index].data : selectedRow;\n            }\n        }\n        return selectedRow;\n    };\n    VirtualContentRenderer.prototype.getVirtualRowIndex = function (index) {\n        var prev = this.prevInfo.blockIndexes;\n        var startIdx = (prev[0] - 1) * this.getBlockSize();\n        return startIdx + index;\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    VirtualContentRenderer.prototype.refreshOffsets = function () {\n        var gObj = this.parent;\n        var row = 0;\n        var bSize = this.getBlockSize();\n        var total = isGroupAdaptive(this.parent) ? this.getGroupedTotalBlocks() : this.getTotalBlocks();\n        this.prevHeight = this.offsets[total];\n        this.maxBlock = total % 2 === 0 ? total - 2 : total - 1;\n        this.offsets = {};\n        //Row offset update\n        // eslint-disable-next-line prefer-spread\n        var blocks = Array.apply(null, Array(total)).map(function () { return ++row; });\n        for (var i = 0; i < blocks.length; i++) {\n            var tmp = (this.vgenerator.cache[blocks[i]] || []).length;\n            var rem = !isGroupAdaptive(this.parent) ? this.count % bSize : (gObj.vcRows.length % bSize);\n            var size = !isGroupAdaptive(this.parent) && blocks[i] in this.vgenerator.cache ?\n                tmp * this.parent.getRowHeight() : rem && blocks[i] === total ? rem * this.parent.getRowHeight() :\n                this.getBlockHeight();\n            // let size: number = this.parent.groupSettings.columns.length && block in this.vgenerator.cache ?\n            // tmp * getRowHeight() : this.getBlockHeight();\n            this.offsets[blocks[i]] = (this.offsets[blocks[i] - 1] | 0) + size;\n            this.tmpOffsets[blocks[i]] = this.offsets[blocks[i] - 1] | 0;\n        }\n        this.offsetKeys = Object.keys(this.offsets);\n        if (isGroupAdaptive(this.parent)) {\n            this.parent.vGroupOffsets = this.offsets;\n        }\n        //Column offset update\n        if (this.parent.enableColumnVirtualization) {\n            this.vgenerator.refreshColOffsets();\n        }\n    };\n    VirtualContentRenderer.prototype.refreshVirtualElement = function () {\n        this.vgenerator.refreshColOffsets();\n        this.setVirtualHeight();\n    };\n    VirtualContentRenderer.prototype.setVisible = function (columns) {\n        var gObj = this.parent;\n        var frozenCols = this.parent.getFrozenColumns();\n        var fcntColGrp;\n        var mcntColGrp;\n        if (frozenCols) {\n            fcntColGrp = [].slice.call(this.parent.getFrozenVirtualContent().querySelectorAll('col'));\n            mcntColGrp = [].slice.call(this.parent.getMovableVirtualContent().querySelectorAll('col'));\n        }\n        var rows = [];\n        rows = this.getRows();\n        var testRow;\n        rows.some(function (r) { if (r.isDataRow) {\n            testRow = r;\n        } return r.isDataRow; });\n        var isRefresh = true;\n        if (!gObj.groupSettings.columns.length && testRow) {\n            isRefresh = false;\n        }\n        var tr = gObj.getDataRows();\n        for (var c = 0, clen = columns.length; c < clen; c++) {\n            var column = columns[c];\n            var idx = gObj.getNormalizedColumnIndex(column.uid);\n            var displayVal = column.visible === true ? '' : 'none';\n            var colGrp = void 0;\n            if (fcntColGrp && mcntColGrp) {\n                if (idx >= frozenCols) {\n                    colGrp = mcntColGrp;\n                    tr = this.parent.getMovableRows();\n                    idx = idx - frozenCols;\n                }\n                else {\n                    colGrp = fcntColGrp;\n                }\n            }\n            else {\n                colGrp = this.getColGroup().children;\n            }\n            if (idx !== -1 && testRow && idx < testRow.cells.length) {\n                setStyleAttribute(colGrp[idx], { 'display': displayVal });\n            }\n            if (!isRefresh) {\n                var width = void 0;\n                if (column.visible) {\n                    width = this.virtualEle.wrapper.offsetWidth + parseInt(column.width.toString(), 10);\n                }\n                else {\n                    width = this.virtualEle.wrapper.offsetWidth - parseInt(column.width.toString(), 10);\n                }\n                if (width > gObj.width) {\n                    this.setDisplayNone(tr, idx, displayVal, rows);\n                    if (this.parent.enableColumnVirtualization) {\n                        this.virtualEle.setWrapperWidth(width + '');\n                    }\n                    this.refreshVirtualElement();\n                }\n                else {\n                    isRefresh = true;\n                }\n            }\n            if (!this.parent.invokedFromMedia && column.hideAtMedia) {\n                this.parent.updateMediaColumns(column);\n            }\n            this.parent.invokedFromMedia = false;\n        }\n        if (isRefresh || frozenCols) {\n            this.refreshContentRows({ requestType: 'refresh' });\n        }\n        else {\n            this.parent.notify(events.partialRefresh, { rows: rows, args: { isFrozen: false, rows: rows } });\n        }\n    };\n    VirtualContentRenderer.prototype.selectVirtualRow = function (args) {\n        var _this = this;\n        args.isAvailable = args.selectedIndex < this.count;\n        if (args.isAvailable && !this.isContextMenuOpen && this.activeKey !== 'upArrow'\n            && this.activeKey !== 'downArrow' && !this.isSelection && !this.requestTypes.some(function (value) { return value === _this.requestType; })\n            && !this.parent.selectionModule.isInteracted) {\n            var selectedRow = this.parent.getRowByIndex(args.selectedIndex);\n            var rowHeight = this.parent.getRowHeight();\n            if (!selectedRow || !this.isRowInView(selectedRow)) {\n                this.isSelection = true;\n                this.selectedRowIndex = args.selectedIndex;\n                var scrollTop = (args.selectedIndex + 1) * rowHeight;\n                if (!isNullOrUndefined(scrollTop)) {\n                    var direction = this.content.scrollTop < scrollTop ? 'down' : 'up';\n                    this.selectRowIndex = args.selectedIndex;\n                    this.content.scrollTop = scrollTop;\n                    this.isSelectionScroll = this.observer.check(direction);\n                }\n            }\n        }\n        if (this.parent.isFrozenGrid() && this.requestType) {\n            if (this.parent.getTablesCount() === this.frzIdx) {\n                this.requestType = this.empty;\n                this.frzIdx = 1;\n            }\n            else {\n                this.frzIdx++;\n            }\n        }\n        else {\n            this.requestType = this.empty;\n        }\n    };\n    VirtualContentRenderer.prototype.isRowInView = function (row) {\n        var top = row.getBoundingClientRect().top - this.parent.element.getBoundingClientRect().top;\n        return (top >= this.initialRowTop && top <= this.content.offsetHeight);\n    };\n    return VirtualContentRenderer;\n}(ContentRender));\nexport { VirtualContentRenderer };\n/**\n * @hidden\n */\nvar VirtualHeaderRenderer = /** @class */ (function (_super) {\n    __extends(VirtualHeaderRenderer, _super);\n    function VirtualHeaderRenderer(parent, locator) {\n        var _this = _super.call(this, parent, locator) || this;\n        _this.virtualEle = new VirtualElementHandler();\n        _this.isMovable = false;\n        _this.gen = new VirtualRowModelGenerator(_this.parent);\n        _this.parent.on(events.columnVisibilityChanged, _this.setVisible, _this);\n        _this.parent.on(refreshVirtualBlock, function (e) { return e.virtualInfo.sentinelInfo.axis === 'X' ? _this.refreshUI() : null; }, _this);\n        return _this;\n    }\n    VirtualHeaderRenderer.prototype.renderTable = function () {\n        this.gen.refreshColOffsets();\n        this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + literals.headerContent)));\n        _super.prototype.renderTable.call(this);\n        this.virtualEle.table = this.getTable();\n        this.virtualEle.content = this.getPanel().querySelector('.' + literals.headerContent);\n        this.virtualEle.content.style.position = 'relative';\n        this.virtualEle.renderWrapper();\n        this.virtualEle.renderPlaceHolder('absolute');\n    };\n    VirtualHeaderRenderer.prototype.appendContent = function (table) {\n        if (!this.isMovable) {\n            this.virtualEle.wrapper.appendChild(table);\n        }\n        else {\n            this.virtualEle.movableWrapper.appendChild(table);\n            this.isMovable = false;\n        }\n    };\n    VirtualHeaderRenderer.prototype.refreshUI = function () {\n        this.isMovable = this.parent.isFrozenGrid();\n        this.setFrozenTable(this.parent.getMovableVirtualContent());\n        this.gen.refreshColOffsets();\n        this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector('.' + literals.headerContent)));\n        _super.prototype.refreshUI.call(this);\n        this.setFrozenTable(this.parent.getFrozenVirtualContent());\n    };\n    VirtualHeaderRenderer.prototype.setVisible = function (columns) {\n        var gObj = this.parent;\n        var displayVal;\n        var idx;\n        var needFullRefresh;\n        var frozenCols = this.parent.getFrozenColumns();\n        var fhdrColGrp;\n        var mhdrColGrp;\n        if (frozenCols) {\n            fhdrColGrp = [].slice.call(this.parent.getFrozenVirtualHeader().querySelectorAll('col'));\n            mhdrColGrp = [].slice.call(this.parent.getMovableVirtualHeader().querySelectorAll('col'));\n        }\n        for (var c = 0, clen = columns.length; c < clen; c++) {\n            var column = columns[c];\n            idx = gObj.getNormalizedColumnIndex(column.uid);\n            displayVal = column.visible ? '' : 'none';\n            var colGrp = void 0;\n            if (fhdrColGrp && mhdrColGrp) {\n                if (idx >= frozenCols) {\n                    colGrp = mhdrColGrp;\n                    idx = idx - frozenCols;\n                }\n                else {\n                    colGrp = fhdrColGrp;\n                }\n            }\n            else {\n                colGrp = this.getColGroup().children;\n            }\n            setStyleAttribute(colGrp[idx], { 'display': displayVal });\n            if (gObj.enableColumnVirtualization && !gObj.groupSettings.columns.length) {\n                var tablewidth = void 0;\n                if (column.visible) {\n                    tablewidth = this.virtualEle.wrapper.offsetWidth + parseInt(column.width.toString(), 10);\n                }\n                else {\n                    tablewidth = this.virtualEle.wrapper.offsetWidth - parseInt(column.width.toString(), 10);\n                }\n                if (tablewidth > gObj.width) {\n                    this.setDisplayNone(column, displayVal);\n                    this.virtualEle.setWrapperWidth(tablewidth + '');\n                    this.gen.refreshColOffsets();\n                }\n                else {\n                    needFullRefresh = true;\n                }\n            }\n            else {\n                needFullRefresh = true;\n            }\n            if (needFullRefresh && !frozenCols) {\n                this.refreshUI();\n            }\n        }\n        if (frozenCols) {\n            this.parent.notify(events.columnPositionChanged, {});\n        }\n    };\n    VirtualHeaderRenderer.prototype.setFrozenTable = function (content) {\n        if (this.parent.isFrozenGrid() && this.parent.enableColumnVirtualization\n            && this.parent.contentModule.isXaxis()) {\n            this.parent.contentModule\n                .setTable(content.querySelector('.' + literals.table));\n        }\n    };\n    VirtualHeaderRenderer.prototype.setDisplayNone = function (col, displayVal) {\n        var frozenCols = this.parent.isFrozenGrid();\n        var table = this.getTable();\n        if (frozenCols && col.getFreezeTableName() === 'movable') {\n            table = this.parent.getMovableVirtualHeader().querySelector('.' + literals.table);\n        }\n        for (var _i = 0, _a = [].slice.apply(table.querySelectorAll('th.e-headercell')); _i < _a.length; _i++) {\n            var ele = _a[_i];\n            if (ele.querySelector('[e-mappinguid]') &&\n                ele.querySelector('[e-mappinguid]').getAttribute('e-mappinguid') === col.uid) {\n                setStyleAttribute(ele, { 'display': displayVal });\n                if (displayVal === '') {\n                    removeClass([ele], 'e-hide');\n                }\n                break;\n            }\n        }\n    };\n    return VirtualHeaderRenderer;\n}(HeaderRender));\nexport { VirtualHeaderRenderer };\n/**\n * @hidden\n */\nvar VirtualElementHandler = /** @class */ (function () {\n    function VirtualElementHandler() {\n    }\n    VirtualElementHandler.prototype.renderWrapper = function (height) {\n        this.wrapper = createElement('div', { className: 'e-virtualtable', styles: \"min-height:\" + formatUnit(height) });\n        this.wrapper.appendChild(this.table);\n        this.content.appendChild(this.wrapper);\n    };\n    VirtualElementHandler.prototype.renderPlaceHolder = function (position) {\n        if (position === void 0) { position = 'relative'; }\n        this.placeholder = createElement('div', { className: 'e-virtualtrack', styles: \"position:\" + position });\n        this.content.appendChild(this.placeholder);\n    };\n    VirtualElementHandler.prototype.renderFrozenWrapper = function (height) {\n        this.wrapper = createElement('div', { className: 'e-virtualtable', styles: \"min-height:\" + formatUnit(height) + \"; display: flex\" });\n        this.content.appendChild(this.wrapper);\n    };\n    VirtualElementHandler.prototype.renderFrozenPlaceHolder = function () {\n        this.placeholder = createElement('div', { className: 'e-virtualtrack' });\n        this.content.appendChild(this.placeholder);\n    };\n    VirtualElementHandler.prototype.renderMovableWrapper = function (height) {\n        this.movableWrapper = createElement('div', { className: 'e-virtualtable', styles: \"min-height:\" + formatUnit(height) });\n        this.movableContent.appendChild(this.movableWrapper);\n    };\n    VirtualElementHandler.prototype.renderMovablePlaceHolder = function () {\n        this.movablePlaceholder = createElement('div', { className: 'e-virtualtrack' });\n        this.movableContent.appendChild(this.movablePlaceholder);\n    };\n    VirtualElementHandler.prototype.adjustTable = function (xValue, yValue) {\n        this.wrapper.style.transform = \"translate(\" + xValue + \"px, \" + yValue + \"px)\";\n    };\n    VirtualElementHandler.prototype.adjustMovableTable = function (xValue, yValue) {\n        this.movableWrapper.style.transform = \"translate(\" + xValue + \"px, \" + yValue + \"px)\";\n    };\n    VirtualElementHandler.prototype.setMovableWrapperWidth = function (width, full) {\n        this.movableWrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n    };\n    VirtualElementHandler.prototype.setMovableVirtualHeight = function (height, width) {\n        this.movablePlaceholder.style.height = height + \"px\";\n        this.movablePlaceholder.style.width = width;\n    };\n    VirtualElementHandler.prototype.setWrapperWidth = function (width, full) {\n        this.wrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n    };\n    VirtualElementHandler.prototype.setVirtualHeight = function (height, width) {\n        this.placeholder.style.height = height + \"px\";\n        this.placeholder.style.width = width;\n    };\n    VirtualElementHandler.prototype.setFreezeWrapperWidth = function (wrapper, width, full) {\n        wrapper.style.width = width ? width + \"px\" : full ? '100%' : '';\n    };\n    return VirtualElementHandler;\n}());\nexport { VirtualElementHandler };\n"]},"metadata":{},"sourceType":"module"}